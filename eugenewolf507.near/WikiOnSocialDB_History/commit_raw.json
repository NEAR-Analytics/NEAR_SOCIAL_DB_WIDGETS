{"tx_hash": "fQU9CgFLj4kPEbkwG72o6NaG7sjiQj9DJygCCBFw7iU", "action_id_social": "H4Si6m2ftmbLvLetnzHJpxkKPNeSJKTRgXc4ytY55gTL-0-widget", "block_id": 86117451, "block_timestamp": "2023-02-26 21:40:05.936", "signer_id": "eugenewolf507.near", "widget_name": "WikiOnSocialDB_History", "source_code": "/*\n---props---\nprops.widgetPath?: string,\n*/\nconst authorForWidget = \"eugenewolf507.near\";\nconst addressForArticles = \"wikiTest2Article\";\nconst initWidgetPath = props.widgetPath || \"devgovgigs.near/widget/Ideas\";\n\nState.init({\n  widgetPath: initWidgetPath,\n});\n\n// === START ===\nconst handler = () => {\n  // ============ WIDGETS\n  const widgetPath = \"devgovgigs.near/widget/Ideas\";\n\n  const historyBlocksRequestKeysWidgets = Social.keys(\n    `${widgetPath}`,\n    \"final\",\n    {\n      return_type: \"History\",\n    }\n  );\n  //   const historyBlocksRequestGetWidget = Social.get(`${widgetPath}`, \"final\");\n\n  console.log(\n    \"historyBlocksRequestKeysWidgets\",\n    historyBlocksRequestKeysWidgets\n  );\n  //   console.log(\"historyBlocksRequestGetWidget\", historyBlocksRequestGetWidget);\n\n  // ============ ARTICLES\n  // ========== GET INDEX ARRAY FOR ARTICLES ==========\n  const postsIndex = Social.index(addressForArticles, \"main\", {\n    order: \"desc\",\n    accountId: undefined,\n  });\n  // ========== GET ALL ARTICLES ==========\n  const resultArticles =\n    postsIndex &&\n    postsIndex.reduce((acc, { accountId, blockHeight }) => {\n      const postData = Social.get(\n        `${accountId}/${addressForArticles}/main`,\n        blockHeight\n      );\n      const postDataWithBlockHeight = { ...JSON.parse(postData), blockHeight };\n      return [...acc, postDataWithBlockHeight];\n    }, []);\n  // ========== FIND ALL VERSIONS OF ONE ARTICLE ==========\n  const filteredArticles =\n    resultArticles.length &&\n    resultArticles.reduce((acc, article) => {\n      if (article.articleId === \"FirstNewDBTest\") {\n        return [...acc, article];\n      } else {\n        return acc;\n      }\n    }, []);\n  console.log(\"filteredArticles\", filteredArticles);\n};\n\n// === END ===\n\nreturn (\n  <div>\n    {/* === START === */}\n    <button onClick={handler}>GET DATA (delete thos button)</button>\n    {/* === END === */}\n    <h1 class=\"text-center\">Widget History</h1>\n\n    <div class=\"input-group mb-3\">\n      <input\n        class=\"form-control\"\n        placeholder={initWidgetPath}\n        defaultValue={state.widgetPath || initWidgetPath}\n        onBlur={(e) => {\n          State.update({\n            widgetPath: e.target.value,\n          });\n        }}\n      />\n    </div>\n\n    <Widget\n      src={`${authorForWidget}/widget/WikiOnSocialDB_History.History`}\n      props={{\n        widgetPath: state.widgetPath,\n      }}\n    />\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/eugenewolf507.near/widget/WikiOnSocialDB_History"}