{"tx_hash": "FDKFxMbXwfTKrcBo846oyVEUxDghPBuxn2eMbJ7ycBVS", "action_id_social": "Bi4a4sggRtFDJihko4FSW37giDedP9G8TTURtC1zufsB-0-widget", "block_id": 80712808, "block_timestamp": "2022-12-15 15:13:56.249", "signer_id": "a92d2106fd31a2d52501953961b1639745434ee343fb6303e4d0195b501b75ad", "widget_name": "SetHeightForm", "source_code": "const contractId = \"proof_of_height.lewidenmann.near\";\nconst accountId = context.accountId;\nif (!accountId) {\n  return \"Please login to use Proof of Height\";\n}\n\nState.init({\n  heightHasBeenSaved: false,\n  heightFeet: 0,\n  heightInches: 0,\n});\n\nconst userHeight = Near.view(contractId, \"get_height_inches\", {\n  account_id: accountId,\n});\n\nif (userHeight && !state.heightHasBeenSaved) {\n  console.log(userHeight);\n  State.update({\n    heightHasBeenSaved: true,\n    heightFeet: userHeight / 12,\n    heightInches: userHeight % 12,\n  });\n}\n\nconst height = {\n  feet: state.inputHeightFeet || 0,\n  inches: state.inputHeightInches || 0,\n};\n\nconst heightIsSet = height.feet > 0 || height.inches > 0;\nconst inchesAreValid = height.inches >= 0 && height.inches < 12;\nconst formIsValid = heightIsSet && inchesAreValid;\n\nfunction submitHeight() {\n  const totalInches = height.feet * 12 + height.inches;\n  Near.call(contractId, \"set_height_inches\", {\n    height: totalInches,\n  });\n  State.update({\n    heightHasBeenSaved: true,\n  });\n  console.log(`Your height in total inches: ${totalInches}`);\n}\n\nreturn (\n  <div class=\"card p-3\">\n    {state.heightHasBeenSaved ? (\n      <div class=\"alert alert-success m-0\" role=\"alert\">\n        Your height has been saved: {state.heightFeet}\u2032{state.heightInches}\u2033\n      </div>\n    ) : (\n      <div>\n        <div\n          className=\" d-flex flex-column flex-md-row align-items-stretch\"\n          style={{ gap: \"1rem\" }}\n        >\n          <div\n            className=\"d-flex align-items-center\"\n            style={{ marginRight: \"auto\" }}\n          >\n            <h5 className=\"m-0\">What&apos;s your height?</h5>\n          </div>\n\n          <div\n            className=\"d-flex flex-row\"\n            style={{ gap: \"1rem\", minWidth: \"15rem\" }}\n          >\n            <div class=\"form-floating\" style={{ width: \"50%\" }}>\n              <input\n                className=\"form-control\"\n                id=\"heightFeet\"\n                type=\"number\"\n                placeholder=\"Feet\"\n                value={state.giveBadgeAccountId}\n                min=\"0\"\n                onChange={(e) => {\n                  const value = Number(e.target.value) || 0;\n                  State.update({ inputHeightFeet: e.target.value });\n                }}\n              />\n              <label for=\"heightFeet\">Feet</label>\n            </div>\n\n            <div class=\"form-floating\" style={{ width: \"50%\" }}>\n              <input\n                className=\"form-control\"\n                id=\"heightInches\"\n                type=\"number\"\n                placeholder=\"Inches\"\n                value={state.giveBadgeAccountId}\n                min=\"0\"\n                max=\"11\"\n                onChange={(e) => {\n                  const value = Number(e.target.value) || 0;\n                  State.update({ inputHeightInches: value });\n                }}\n              />\n              <label for=\"heightInches\">Inches</label>\n            </div>\n          </div>\n\n          <button\n            type=\"button\"\n            className=\"btn btn-primary\"\n            disabled={!formIsValid}\n            onClick={submitHeight}\n          >\n            Save Height: {height.feet}\u2032{height.inches}\u2033\n          </button>\n        </div>\n\n        {!inchesAreValid && (\n          <div class=\"alert alert-danger m-0 mt-3\" role=\"alert\">\n            Inches must be between 0 and 11\n          </div>\n        )}\n      </div>\n    )}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/a92d2106fd31a2d52501953961b1639745434ee343fb6303e4d0195b501b75ad/widget/SetHeightForm"}