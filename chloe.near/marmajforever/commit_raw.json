{"tx_hash": "8K2AQY8uoDPv9HSt3soRDqQiBHtmm7G11FHyX1mJAsxF", "action_id_social": "EfYcWYchDZFPFdAgCpCrQBgw9P4vtbH7tUvAN4n8wf8z-0-widget", "block_id": 94323940, "block_timestamp": "2023-06-16T16:49:26.653Z", "signer_id": "chloe.near", "widget_name": "marmajforever", "source_code": "const GameContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100vh;\n  background: #282c34;\n  color: white;\n  font-size: calc(10px + 2vmin);\n`;\n\nconst GameButton = styled.button`\n  background: palevioletred;\n  color: white;\n  font-size: 1em;\n  margin: 1em;\n  padding: 0.25em 1em;\n  border: 2px solid palevioletred;\n  border-radius: 10px;\n  &:hover {\n    background: white;\n    color: palevioletred;\n  }\n`;\n\nconst Title = styled.h1`\n  font-weight: bold;\n`;\n\nconst Info = styled.p`\n  margin-top: 1em;\n`;\n\nState.init({\n  blockHeight: 0,\n  clickCount: 0,\n  love: 0,\n  bossHP: 100,\n  bossLevel: 1,\n  gameStarted: false,\n});\n\nfunction startGame() {\n  asyncFetch(\"https://rpc.mainnet.near.org/status\").then((res) => {\n    const data = res.body;\n    if (res.ok) {\n      let newBlockHeight = data.sync_info.latest_block_height;\n      State.update({\n        blockHeight: newBlockHeight,\n        gameStarted: true,\n      });\n    } else {\n      console.error(\"Error fetching data: \", data.error);\n    }\n  });\n}\n\nfunction fetchDataAndUpdateState() {\n  const oldBlockHeight = state.blockHeight;\n  const oldLove = state.love;\n  const oldClickCount = state.clickCount;\n  let bossHP = state.bossHP;\n  let bossLevel = state.bossLevel;\n\n  asyncFetch(\"https://rpc.mainnet.near.org/status\").then((res) => {\n    const data = res.body;\n    if (res.ok) {\n      let newBlockHeight = data.sync_info.latest_block_height;\n      let love = oldLove;\n      let clickCount = oldClickCount;\n      if (newBlockHeight > oldBlockHeight) {\n        love += newBlockHeight - oldBlockHeight;\n        clickCount++;\n      }\n\n      bossHP -= love;\n      love = 0;\n      if (bossHP <= 0) {\n        bossHP = 100;\n        bossLevel++;\n      }\n\n      State.update({\n        blockHeight: newBlockHeight,\n        clickCount: clickCount,\n        love: love,\n        bossHP: bossHP,\n        bossLevel: bossLevel,\n      });\n    } else {\n      console.error(\"Error fetching data: \", data.error);\n    }\n  });\n}\n\nreturn (\n  <GameContainer>\n    <Title>Block Battle!</Title>\n    <Info>Block Height: {state.blockHeight}</Info>\n    <Info>Times Attacked: {state.clickCount}</Info>\n    <Info>Love: {state.love}</Info>\n    <Info>Boss HP: {state.bossHP}</Info>\n    <Info>Boss Level: {state.bossLevel}</Info>\n    {!state.gameStarted && (\n      <GameButton onClick={startGame}>Start Game</GameButton>\n    )}\n    {state.gameStarted && (\n      <GameButton onClick={fetchDataAndUpdateState}>Attack!</GameButton>\n    )}\n  </GameContainer>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/chloe.near/widget/marmajforever", "__row_index": 0}