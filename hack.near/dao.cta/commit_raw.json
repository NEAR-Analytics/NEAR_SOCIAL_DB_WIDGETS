{"tx_hash": "FULfQtPvLxm62gYAfHr5rQn8Tk2GJQV4PbUbeCMGhwc2", "action_id_social": "HB44H3f3fmmwgwmA93ojMBDQE23cvdkPA2hqFRR9GyiK-0-widget", "block_id": 94246538, "block_timestamp": "2023-06-15T14:49:39.156Z", "signer_id": "hack.near", "widget_name": "dao.cta", "source_code": "const accountId = context.accountId;\nconst daoId = props.daoId ?? \"build.sputnik-dao.near\";\n\n// check if user has published at least 1 widget\nlet isBuilder = false;\nlet widgets = Social.get(`${accountId}/widget/*`, \"final\", {\n  return_type: \"BlockHeight\",\n  values_only: true,\n});\nlet widgetCount = 0;\nif (widgets) {\n  widgetCount = Object.keys(widgets).length;\n}\nif (widgetCount > 0) {\n  isBuilder = true;\n}\n\n// get DAO policy data\nconst policy = Near.view(daoId, \"get_policy\");\n\nif (policy === null) {\n  return \"\";\n}\n\nconst groups = policy.roles\n  .filter((role) => role.name === \"community\")\n  .map((role) => {\n    const group = role.kind.Group;\n\n    return group;\n  });\n\n//check if user is a member of a group: [1]\nconst isMember = groups.some((group) => group.includes(accountId));\n\n// function call used for membership requests\nconst handleJoin = () => {\n  const deposit = policy.proposal_bond;\n  Near.call([\n    {\n      contractName: daoId,\n      methodName: \"add_proposal\",\n      args: {\n        proposal: {\n          description: \"potential member\",\n          kind: {\n            AddMemberToRole: {\n              member_id: accountId,\n              role: role,\n            },\n          },\n        },\n      },\n      gas: 300000000000000,\n      deposit: deposit,\n    },\n  ]);\n};\n\nconst Text = styled.p`\n  font-family: \"FK Grotesk\", sans-serif;\n  font-size: ${(p) => p.size ?? \"18px\"};\n  line-height: ${(p) => p.lineHeight ?? \"1.5\"};\n  font-weight: ${(p) => p.weight ?? \"400\"};\n  color: ${(p) => p.color ?? \"#000\"};\n  margin-botton: 8px;\n`;\n\nconst FlexContainer = styled.div`\n  display: flex;\n  gap: 8px;\n  align-items: center;\n  flex-direction: row;\n  justify-content: center;\n  flex-wrap: wrap;\n\n  @media (max-width: 998px) {\n    flex-direction: column;\n    gap: var(--section-gap);\n  }\n`;\n\nconst Flex = styled.div`\n  display: flex;\n  gap: 8px;\n  align-items: center;\n  flex-direction: column;\n  flex-wrap: \"nowrap\";\n\n    @media (max-width: 998px) {\n    flex-direction: column;\n    gap: var(--section-gap);\n    }\n`;\n\nconst Container = styled.div`\n  display: flex;\n  max-width: 1080px;\n  margin: 0 auto;\n  gap: var(--section-gap);\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  padding: var(--section-gap) 24px;\n`;\n\nreturn (\n  <Container>\n    {isBuilder ? (\n      <Flex>\n        <Text\n          size=\"18px\"\n          weight=\"600\"\n          style={{ textTransform: \"uppercase\", letterSpacing: \"0.17em\" }}\n        >\n          Your Adventure Has Begun\n        </Text>\n        {isMember ? (\n          <FlexContainer>\n            <Widget\n              src=\"near/widget/DIG.Button\"\n              props={{\n                href: \"#/devs.near/widget/dev.social\",\n                label: \"Build Together\",\n                variant: \"outline-secondary\",\n                size: \"large\",\n              }}\n            />\n          </FlexContainer>\n        ) : (\n          <FlexContainer>\n            <button className=\"btn btn-success\" onClick={handleJoin}>\n              Join Community\n            </button>\n          </FlexContainer>\n        )}\n      </Flex>\n    ) : (\n      <Flex>\n        <Text\n          size=\"18px\"\n          weight=\"600\"\n          style={{ textTransform: \"uppercase\", letterSpacing: \"0.17em\" }}\n        >\n          Begin a New Adventure\n        </Text>\n        <FlexContainer>\n          <Widget\n            src=\"near/widget/DIG.Button\"\n            props={{\n              href: \"#/hack.near/widget/Academy\",\n              label: \"Learn Together\",\n              variant: \"outline-secondary\",\n              size: \"large\",\n            }}\n          />\n        </FlexContainer>\n      </Flex>\n    )}\n  </Container>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/dao.cta", "__row_index": 5}