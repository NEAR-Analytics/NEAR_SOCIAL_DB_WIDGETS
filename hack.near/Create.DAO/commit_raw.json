{"tx_hash": "FRG4K8zEzSGb4UST4g8wmh1Q5UE9jY351xx7Mv9CJUoT", "action_id_social": "DLr2D2d5gFpEwNBio2yqM61tVa8fZHmNz4THa5xQ8aUm-0-widget", "block_id": 92409279, "block_timestamp": "2023-05-21T23:58:37.235Z", "signer_id": "hack.near", "widget_name": "Create.DAO", "source_code": "const daos = Near.view(\"sputnik-dao.near\", \"get_dao_list\");\n\nconst groups = [\"infinity.near\", \"council.near\"];\n\nState.init({\n  args: {\n    config: {\n      name: state.name,\n      purpose: state.purpose,\n      metadata: \"\",\n    },\n    policy: {\n      groups,\n    },\n  },\n  isValid: false,\n  isAvailable: true,\n});\n\nconst dao_args = Buffer.from(JSON.stringify(state.args), \"utf-8\").toString(\n  \"base64\"\n);\n\nconst handleCreate = () => {\n  Near.call([\n    {\n      contractName: \"sputnik-dao.near\",\n      methodName: \"create\",\n      args: {\n        name: state.name,\n        args: dao_args,\n      },\n      deposit: \"7000000000000000000000000\",\n      gas: \"300000000000000\",\n    },\n  ]);\n};\n\nconst onChangeName = (name) => {\n  State.update({\n    name,\n  });\n};\n\nconst onChangePurpose = (purpose) => {\n  State.update({\n    purpose,\n  });\n};\n\nconst dao_id = state.name + \".sputnik-dao.near\";\nconst dao_name = state.name;\n\nconst checkAvailability = (daos) => {\n  if (daos.indexOf(dao_id) !== -1) {\n    return State.update({ isAvailable: false });\n  }\n};\n\nconst availableName = checkAvailability(daos);\n\nconst checkValidity = (dao_name) => {\n  if (dao_name.length > 2) {\n    return State.update({ isValid: true });\n  }\n};\n\nconst validName = checkValidity(dao_name);\n\nreturn (\n  <>\n    <div className=\"mb-3\">\n      <h5>Name</h5>\n      {state.name && <p>{dao_id}</p>}\n      {validName ? (\n        <div>\n          {availableName ? (\n            <p className=\"text-danger\">unavailable</p>\n          ) : (\n            <p className=\"text-success\">available</p>\n          )}\n        </div>\n      ) : (\n        <div>\n          {state.name ? (\n            <p className=\"text-secondary\">must be 3+ characters</p>\n          ) : (\n            \"\"\n          )}\n        </div>\n      )}\n      <input\n        type=\"text\"\n        value={state.name}\n        onChange={(e) => onChangeName(e.target.value)}\n      ></input>\n    </div>\n    <div className=\"mb-3\">\n      <h5>Purpose</h5>\n      <input\n        type=\"text\"\n        value={state.purpose}\n        onChange={(e) => onChangePurpose(e.target.value)}\n      ></input>\n    </div>\n    <button\n      disabled={!validName}\n      className=\"btn btn-outline-success mt-2\"\n      onClick={handleCreate}\n    >\n      Create DAO\n    </button>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/Create.DAO", "__row_index": 0}