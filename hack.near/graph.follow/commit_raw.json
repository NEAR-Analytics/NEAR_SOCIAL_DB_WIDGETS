{"tx_hash": "EemNS744yMaZamRCXwJB3tpin1KezYiZzQJSLAZfoT8M", "action_id_social": "7GGiLfQDfNWE6vNG4rX1ZbBMMU8gNzP7dyBWA36Ha4mE-0-widget", "block_id": 95005199, "block_timestamp": "2023-06-25T14:59:04.631Z", "signer_id": "hack.near", "widget_name": "graph.follow", "source_code": "const networkData = Social.get(`*/graph/follow/*`, \"final\");\n\nif (networkData === null) {\n  return \"Loading...\";\n}\n\nconst testData = {\n  \"hack.near\": {\n    graph: {\n      follow: {\n        \"devs.near\": \"\",\n      },\n    },\n  },\n  \"devs.near\": {\n    graph: {\n      follow: {\n        \"every.near\": \"\",\n      },\n    },\n  },\n  \"root.near\": {\n    graph: {\n      follow: {\n        \"mob.near\": \"\",\n      },\n    },\n  },\n  \"every.near\": {\n    graph: {\n      follow: {\n        \"hack.near\": \"\",\n      },\n    },\n  },\n};\n\nconst scriptSrc = `\n\n<style>\n* { margin: 0; padding: 0;}\n\nbody, html { height: 100%; }\n\n#c {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n}\n</style>\n\n<script type=\"module\">\n    let data = ${JSON.stringify(networkData)};\n    let canvas = document.createElement('canvas');\n    document.body.appendChild(canvas);\n    let ctx = canvas.getContext('2d');\n\n    canvas.width = window.innerWidth;\n    canvas.height = window.innerHeight;\n\n    let nodes = [];\n    let edges = [];\n    for (let account in data) {\nlet radius = 5;  // The radius of the nodes\nlet padding = radius + 1;  // Additional padding to account for stroke width\nnodes.push({\n    id: account, \n    x: padding + Math.random()*(canvas.width - 2*padding), \n    y: padding + Math.random()*(canvas.height - 2*padding)\n});\n      for (let follower in data[account][\"graph\"][\"follow\"]) {\n        edges.push({source: account, target: follower});\n      }\n    }\n\n    function drawNode(node) {\n        ctx.beginPath();\n        ctx.arc(node.x, node.y, 5, 0, 2 * Math.PI, false);\n        ctx.fillStyle = 'green';\n        ctx.fill();\n        ctx.lineWidth = 1;\n        ctx.strokeStyle = '#003300';\n        ctx.stroke();\n    }\n\n    function drawEdge(edge) {\n        let sourceNode = nodes.find(node => node.id === edge.source);\n        let targetNode = nodes.find(node => node.id === edge.target);\n\n        ctx.beginPath();\n        ctx.moveTo(sourceNode.x, sourceNode.y);\n        ctx.lineTo(targetNode.x, targetNode.y);\n        ctx.stroke();\n    }\n\n    function animate() {\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        nodes.forEach(drawNode);\n        edges.forEach(drawEdge);\n    };\n\n    animate();\n            \n</script>\n`;\n\nconsole.log(JSON.stringify(networkData));\nconsole.log(JSON.stringify(testData));\n\nreturn (\n  <div>\n    <iframe\n      srcDoc={scriptSrc}\n      width=\"888\"\n      height=\"888\"\n      style={{ width: \"100%\" }}\n    />\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/graph.follow", "__row_index": 0}