{"tx_hash": "4u1Hi2LXRgPnnJtX2NcxyV3FZRDnJ68T64Np3K1Bsiiy", "action_id_social": "2eymD6UjGUCffTaKf4gL4xsoPJmCVCv4XM6q639tDfqb-0-widget", "block_id": 91826022, "block_timestamp": "2023-05-14T09:17:31.213Z", "signer_id": "hack.near", "widget_name": "dev.Widget", "source_code": "const accountId = props.accountId ?? context.accountId;\nconst daoId = props.daoId ?? \"build.sputnik-dao.near\";\n\nif (!accountId) {\n  return \"Please connect your NEAR wallet :)\";\n}\n\nconst widget = Social.get(`${daoId}/settings/dao/widget`);\n\nif (widget === null) {\n  return \"Loading...\";\n}\n\nState.init({\n  widget: widget ?? \"hack.near/widget/DAO.Profile\",\n});\n\nconst widget_args = JSON.stringify({\n  data: {\n    [daoId]: {\n      settings: {\n        dao: {\n          widget: state.widget,\n        },\n      },\n    },\n  },\n});\n\nconst proposal_args = Buffer.from(widget_args, \"utf-8\").toString(\"base64\");\n\nconst handleProposal = () => {\n  Near.call([\n    {\n      contractName: daoId,\n      methodName: \"add_proposal\",\n      args: {\n        proposal: {\n          description: \"update featured widget\",\n          kind: {\n            FunctionCall: {\n              receiver_id: \"social.near\",\n              actions: [\n                {\n                  method_name: \"set\",\n                  args: proposal_args,\n                  deposit: \"50000000000000000000000\",\n                  gas: \"200000000000000\",\n                },\n              ],\n            },\n          },\n        },\n      },\n      deposit: \"100000000000000000000000\",\n      gas: \"200000000000000\",\n    },\n  ]);\n};\n\nconst Wrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst Header = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n`;\n\nconst H1 = styled.h1`\n  font-weight: 600;\n  font-size: 32px;\n  line-height: 39px;\n  color: #11181c;\n  margin: 0;\n`;\n\nconst Items = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 23px;\n`;\n\nconst Item = styled.div``;\n\nconst Div = styled.div`\n  position: relative;\n  @media (hover: hover) {\n    > .edit-link {\n      display: none;\n    }\n  }\n  &:hover {\n    > .edit-link {\n      display: inline;\n    }\n  }\n`;\n\nconst addWidget = ({ widgetPath: widget, onHide }) => {\n  return (\n    <button\n      className=\"btn btn-primary\"\n      onClick={() => {\n        State.update({\n          widget,\n        });\n        onHide();\n      }}\n    >\n      <i className=\"bi bi-plus-lg\" /> Add\n    </button>\n  );\n};\n\nreturn (\n  <div>\n    <Wrapper>\n      <Header>\n        <H1>Featured Widget</H1>\n        <Widget\n          src=\"miraclx.near/widget/Attribution\"\n          props={{\n            dep: true,\n            authors: [daoId],\n          }}\n        />\n        <div>\n          <p className=\"mb-1\">\n            <b>INPUT NEW SOURCE PATH:</b>\n          </p>\n          <input\n            type=\"text\"\n            value={state.widget}\n            placeholder=\"account.near/widget/Example\"\n          />\n        </div>\n        <div className=\"mb-1\">\n          {context.accountId && (\n            <button\n              key=\"edit\"\n              onClick={handleProposal}\n              disabled={state.widget === widget}\n              className=\"btn btn-success me-2 mt-1\"\n            >\n              <i class=\"bi bi-patch-plus\" /> Submit Proposal\n            </button>\n          )}\n        </div>\n        <div className=\"mt-2\">\n          <Widget\n            src=\"hack.near/widget/dev.Widget.Search\"\n            props={{ extraButtons: addWidget }}\n          />\n        </div>\n        <hr />\n        <Items>\n          <Item>\n            <Widget\n              src=\"adminalpha.near/widget/ComponentSummary\"\n              props={{\n                src: `${state.widget}`,\n              }}\n            />\n          </Item>\n        </Items>\n      </Header>\n      <div className=\"mt-3\">\n        <Widget src={state.widget} props={{ accountId, daoId }} />\n      </div>\n    </Wrapper>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/dev.Widget", "__row_index": 6}