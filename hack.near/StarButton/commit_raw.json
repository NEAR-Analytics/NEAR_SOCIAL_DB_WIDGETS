{"tx_hash": "FdQLtQZeLf8pnFSPx7fZoV46HxPiKPx59hjCHkwR1PtX", "action_id_social": "2eVW4xTLEUT6mG4UikQw7s5SoCv11p3KWq3uHrkt4UFv-0-widget", "block_id": 91886241, "block_timestamp": "2023-05-15T04:07:29.697Z", "signer_id": "hack.near", "widget_name": "StarButton", "source_code": "const item = props.item;\n\nif (!item) {\n  return \"\";\n}\n\nconst stars = Social.index(\"star\", item);\n\nconst starsByUsers = {};\n\n(stars || []).forEach((star) => {\n  if (star.value.type === \"star\") {\n    starsByUsers[star.accountId] = star;\n  } else if (star.value.type === \"unstar\") {\n    delete starsByUsers[star.accountId];\n  }\n});\nif (state.starred === true) {\n  starsByUsers[context.accountId] = {\n    accountId: context.accountId,\n  };\n} else if (state.starred === false) {\n  delete starsByUsers[context.accountId];\n}\n\nconst accountsWithStars = Object.keys(starsByUsers);\nconst starred = context.accountId && !!starsByUsers[context.accountId];\n\nconst starClick = () => {\n  const data = {\n    index: {\n      star: JSON.stringify({\n        key: item,\n        value: {\n          type: starred ? \"unstar\" : \"star\",\n        },\n      }),\n    },\n  };\n\n  if (!starred && props.notifyAccountId) {\n    data.index.notify = JSON.stringify({\n      key: props.notifyAccountId,\n      value: {\n        type: \"star\",\n        item,\n      },\n    });\n  }\n  Social.set(data, {\n    onCommit: () => State.update({ starred: !starred }),\n  });\n};\n\nconst StarButton = styled.button`\n  border: 0 !important;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 23%;\n  width: 2.5em;\n  height: 2.5em;\n`;\n\nconst title = starred ? \"Starred\" : \"Star\";\n\nreturn (\n  <div className=\"d-inline-flex align-items-center\">\n    <StarButton\n      title={title}\n      className=\" btn me-1\"\n      disabled={!context.accountId}\n      onClick={starClick}\n    >\n      <i className={`bi fs-2 p-1 ${starred ? \"bi-star-fill\" : \"bi-star\"}`} />\n      {`${starred ? \"\" : \"Star\"}`}\n    </StarButton>\n    <Widget src=\"hack.near/widget/StarButton.Faces\" props={{ starsByUsers }} />\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/StarButton", "__row_index": 30}