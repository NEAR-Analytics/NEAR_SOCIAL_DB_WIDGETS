{"tx_hash": "8Vodd8QUciL9AeUnoenFghSST8xg7kRMAamsQqqdLLDh", "action_id_social": "FJVN1y56oJWvBxeNRbxgtcnrcfBCqNhMfQ2osDh23RHH-0-widget", "block_id": 91884009, "block_timestamp": "2023-05-15T03:25:30.305Z", "signer_id": "hack.near", "widget_name": "TopWidgets", "source_code": "const accountId = props.accountId ?? context.accountId;\n\nconst limitForPosts = props.limitForPosts ?? 888;\ninitState({ widgetsByStars: [] });\n\nconst starredWidgets = Social.get(`${accountId}/index/star`);\n\nconst index = {\n  action: \"star\",\n  key: \"dev\",\n  options: {\n    subscribe: false,\n    limit: limitForPosts,\n    order: \"desc\",\n  },\n};\n\nif (!state.stars) {\n  State.update({\n    stars: Social.index(index.action, index.key, index.options),\n  });\n  return \"\";\n}\n\nlet widgetsByStars = [];\nstate.stars.map((star) => {\n  const key = JSON.stringify(star.value.item);\n  widgetsByStars[key] = (widgetsByStars[key] ?? 0) + 1;\n});\n\nconst sortedPosts = Object.keys(widgetsByStars).sort(\n  (a, b) => widgetsByStars[b] - widgetsByStars[a]\n);\n\nconst topWidgets = sortedPosts.map((widgetStringified) => {\n  const widget = JSON.parse(widgetStringified);\n  return (\n    <div style={{ paddingBottom: \"10px\" }}>\n      <Widget\n        src=\"hack.near/widget/dev.Widget.Card\"\n        props={{\n          accountId: widget.path.replace(\"/widget/starred\", \"\"),\n          blockHeight: widget.blockHeight,\n          rewidgetsNum: widgetsByStars[widgetStringified],\n        }}\n      />\n    </div>\n  );\n});\n\nreturn (\n  <>\n    <h1>Starred Widgets</h1>\n    {topWidgets}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/hack.near/widget/TopWidgets", "__row_index": 0}