{"tx_hash": "EKmtJiFB57qBynC5y6keEiwMthNfTDEfyfj2gbXBhX8Y", "action_id_social": "zA89bp2sk1tUdNGnnb2AUypqLfDi5xzyVEwkDzK7thp-0-widget", "block_id": 91994624, "block_timestamp": "2023-05-16T13:57:33.090Z", "signer_id": "jgodwill.near", "widget_name": "genadropExplore", "source_code": "initState({\r\n  inputCollectionSlug: \"genadrop-contract.nftgen.near\",\r\n  collectionSlug: \"genadrop-contract.nftgen.near\",\r\n  collectionData: {},\r\n  searchTerm: \"\",\r\n  nftData: [],\r\n  filteredNFTData: [],\r\n});\r\nconst fetchData = () => {\r\n  State.update({ nftData: [] });\r\n\r\n  let response = fetch(\"https://byz-multi-chain-01.hasura.app/v1/graphql\", {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"x-api-key\": \"ChRbeKE.c94220449dbb45973a67a614b1f590be\",\r\n      \"Content-Type\": \"application/json\",\r\n      \"Hasura-Client-Name\": \"near-social\",\r\n    },\r\n    body: JSON.stringify({\r\n      query: `\r\n        query MyQuery {\r\n      near {\r\n        collection(where: {slug: {_eq: \"${state.collectionSlug}\"}}) {\r\n          slug\r\n      cover_image\r\n      description\r\n      floor\r\n      usd_volume\r\n      volume\r\n      title\r\n      collection_size\r\n      nft_metas {\r\n        image\r\n        name\r\n        rarity\r\n        ranking\r\n        token_id\r\n        nft_state {\r\n          owner\r\n          staked\r\n          staked_owner\r\n        }\r\n        nft_state_lists(\r\n          where: {listed: {_eq: true}}\r\n          limit: 1\r\n          order_by: {list_contract: {name: desc}}\r\n        ) {\r\n          list_price\r\n          listed\r\n          list_contract {\r\n            name\r\n          }\r\n        }\r\n      }\r\n        }\r\n      }\r\n    }`,\r\n    }),\r\n  });\r\n\r\n  if (response) {\r\n    const data = response;\r\n    const collectionData = data.body.data.near.collection[0];\r\n    let nftData = collectionData.nft_metas;\r\n\r\n    // Sort NFTs based on list price (lowest to highest) and list status\r\n    nftData.sort((a, b) => {\r\n      const aListed = a.nft_state_lists && a.nft_state_lists[0];\r\n      const bListed = b.nft_state_lists && b.nft_state_lists[0];\r\n\r\n      if (aListed && bListed) {\r\n        return aListed.list_price - bListed.list_price;\r\n      } else if (aListed) {\r\n        return -1;\r\n      } else if (bListed) {\r\n        return 1;\r\n      } else {\r\n        return 0;\r\n      }\r\n    });\r\n\r\n    console.log(collectionData, nftData);\r\n    State.update({ collectionData, nftData });\r\n  }\r\n};\r\nfetchData();\r\n\r\nconst updateInputCollectionSlug = (e) => {\r\n  State.update({ inputCollectionSlug: e.target.value });\r\n};\r\n\r\nconst handleFetchButtonClick = () => {\r\n  State.update({ collectionSlug: state.inputCollectionSlug });\r\n  fetchData();\r\n};\r\n\r\nconst updateCollectionSlug = (e) => {\r\n  State.update({ collectionSlug: e.target.value });\r\n};\r\n\r\nconst getRarityColor = (rarity) => {\r\n  if (rarity < 0.1) {\r\n    return \"#ee0000\";\r\n  } else if (rarity < 0.25) {\r\n    return \"#ff9900\";\r\n  } else if (rarity < 0.5) {\r\n    return \"#ffc300\";\r\n  } else {\r\n    return \"#61c700\";\r\n  }\r\n};\r\n\r\nconst seachInputHandler = (e) => {\r\n  const value = e.target.value.toLowerCase();\r\n  console.log(value);\r\n  const searched = state.nftData.filter((nft) =>\r\n    nft.name.toLowerCase().includes(value)\r\n  );\r\n  State.update({\r\n    searchTerm: value,\r\n    filteredNFTData: searched,\r\n  });\r\n};\r\n\r\nconst Stats = styled.div`\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-around;\r\n      width: \"100%\";\r\n      max-width: 800px;\r\n      gap: 20px;\r\n  `;\r\n\r\nconst Main = styled.div`\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: 10px;\r\n    margin-bottom: 20px;\r\n  `;\r\n\r\nconst PageTitle = styled.h1`\r\n  text-align:center;\r\n  font-size: 48px; \r\n  font-weight: bold; \r\n  margin-bottom: 20px; \r\n  `;\r\n\r\nconst NFTCard = styled.div`\r\n   display: flex;\r\n   flex-flow: column nowrap;\r\n   -ms-flex-flow:column nowrap;\r\n   align-items:center;\r\n   background-color: \"#f0f0f0\";\r\n   border-radius: 10px;\r\n   border: 1.41429px solid rgba(28,27,28,.1);\r\nbox-shadow: 5.65714px 5.65714px 11.3143px rgba(28,27,28,.04);\r\n   padding: 8px;\r\n   text-align: center;\r\n   background-color:#fff;\r\n   max-width: 350px;\r\n   margin: 0 auto;\r\n   &:hover &>div>img{\r\n     transform:scale(1.05);\r\n   }\r\n  `;\r\nconst NFTCards = styled.div`\r\n  display: grid;\r\n  gap: 2rem;\r\n  grid-template-columns: repeat(auto-fit, minmax(270px, 1fr));\r\n  justify-content: center;\r\n  // background: linear-gradient(180deg,#e4f1fb,hsla(0,0%,85.1%,0));\r\n  margin-top: 20px;\r\n  width:100%;\r\n`;\r\n\r\nconst ImageCard = styled.div`\r\n  height:250px;\r\n  width: 100%;\r\n  border-radius: 0.5rem;\r\n  overflow:hidden;\r\n  margin-bottom: 1rem;\r\n  &>img{\r\n  object-fit: cover;\r\n  transition: all 0.3s ease-in-out;\r\n  }\r\n  &>img:hover{\r\n    transform:scale(1.05);\r\n  }\r\n`;\r\nconst InputContainer = styled.div`\r\n    width:80%;\r\n    max-width: 500px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content:center;\r\n    margin: 2rem auto 4rem auto;\r\n    &>input{\r\n        outline: none;\r\n    }\r\n`;\r\n\r\nreturn (\r\n  <div className=\"container-fluid\">\r\n    <PageTitle>\ud83d\udca7 GenaDrop NEAR NFTs</PageTitle>\r\n    <div\r\n      style={{\r\n        display: \"flex\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"space-between\",\r\n        marginBottom: \"30px\",\r\n        flexWrap: \"wrap\",\r\n      }}\r\n    ></div>\r\n    {state.collectionData && (\r\n      <Main>\r\n        <Stats>\r\n          <div>\r\n            <p>USD Volume:</p>\r\n            <p>{Math.round(state.collectionData.usd_volume)}</p>\r\n          </div>\r\n          <div>\r\n            <p>Volume:</p>\r\n            <p>\r\n              {Math.round(\r\n                state.collectionData.volume / 1000000000000000000000000\r\n              )}{\" \"}\r\n              N\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p>Collection Size:</p>\r\n            <p>{state.collectionData.collection_size}</p>\r\n          </div>\r\n        </Stats>\r\n      </Main>\r\n    )}\r\n    <InputContainer>\r\n      <input\r\n        type=\"search\"\r\n        value={state.searchTerm}\r\n        placeholder=\"Search NFTs\"\r\n        onChange={seachInputHandler}\r\n      />\r\n    </InputContainer>\r\n    {state.nftData.length > 0 && (\r\n      <NFTCards>\r\n        {state.searchTerm === \"\"\r\n          ? state.nftData.map((nft) => (\r\n              <a\r\n                href={`https://www.tradeport.xyz/near/collection/${state.collectionData.slug}/${nft.token_id}`}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n                style={{ textDecoration: \"none\", color: \"inherit\" }}\r\n              >\r\n                <NFTCard classNmae=\"card\">\r\n                  <ImageCard>\r\n                    <img\r\n                      src={nft.image}\r\n                      alt={nft.name}\r\n                      width=\"100%\"\r\n                      height=\"100%\"\r\n                      className=\"rounded-3\"\r\n                    />\r\n                  </ImageCard>\r\n                  <h3\r\n                    style={{\r\n                      fontSize: \"18px\",\r\n                      margin: \"0 0 10px\",\r\n                      wordBreak: \"break-all\",\r\n                    }}\r\n                  >\r\n                    {nft.name}\r\n                  </h3>\r\n                  <div\r\n                    style={{\r\n                      display: \"flex\",\r\n                      alignItems: \"center\",\r\n                      justifyContent: \"space-between\",\r\n                      marginBottom: \"5px\",\r\n                    }}\r\n                  >\r\n                    <span\r\n                      style={{\r\n                        backgroundColor: \"#3f51b5\",\r\n                        borderRadius: \"20px\",\r\n                        color: \"#fff\",\r\n                        display: \"inline-block\",\r\n                        fontSize: \"12px\",\r\n                        fontWeight: \"bold\",\r\n                        padding: \"3px 8px\",\r\n                      }}\r\n                    >\r\n                      Rank: {Math.round(nft.ranking)}\r\n                    </span>\r\n                  </div>\r\n                  <p style={{ fontSize: \"14px\", marginBottom: \"5px\" }}>\r\n                    Token ID: {nft.token_id}\r\n                  </p>\r\n                  <p style={{ fontSize: \"14px\" }}>\r\n                    Collection: {nft.collection.slug}\r\n                  </p>\r\n                  {nft.nft_state_lists && nft.nft_state_lists[0] && (\r\n                    <p style={{ fontSize: \"14px\" }}>\r\n                      Price:{\" \"}\r\n                      {nft.nft_state_lists[0].list_price /\r\n                        1000000000000000000000000}\r\n                      {\"N \"}\r\n                      {nft.nft_state_lists[0].list_contract.name}\r\n                    </p>\r\n                  )}\r\n                  {nft.nft_state && (\r\n                    <p style={{ fontSize: \"14px\" }}>\r\n                      Owner:\r\n                      {nft.nft_state.owner.length > 20\r\n                        ? nft.nft_state.owner.slice(0, 20) + \"...\"\r\n                        : nft.nft_state.owner}\r\n                    </p>\r\n                  )}\r\n                </NFTCard>\r\n              </a>\r\n            ))\r\n          : state.filteredNFTData.map((nft) => (\r\n              <a\r\n                href={`https://www.tradeport.xyz/near/collection/${state.collectionData.slug}/${nft.token_id}`}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n                style={{ textDecoration: \"none\", color: \"inherit\" }}\r\n              >\r\n                <NFTCard classNmae=\"card\">\r\n                  <ImageCard>\r\n                    <img\r\n                      src={nft.image}\r\n                      alt={nft.name}\r\n                      width=\"100%\"\r\n                      height=\"100%\"\r\n                      className=\"rounded-3\"\r\n                    />\r\n                  </ImageCard>\r\n                  <h3\r\n                    style={{\r\n                      fontSize: \"18px\",\r\n                      margin: \"0 0 10px\",\r\n                      wordBreak: \"break-all\",\r\n                    }}\r\n                  >\r\n                    {nft.name}\r\n                  </h3>\r\n                  <div\r\n                    style={{\r\n                      display: \"flex\",\r\n                      alignItems: \"center\",\r\n                      justifyContent: \"space-between\",\r\n                      marginBottom: \"5px\",\r\n                    }}\r\n                  >\r\n                    <span\r\n                      style={{\r\n                        backgroundColor: \"#3f51b5\",\r\n                        borderRadius: \"20px\",\r\n                        color: \"#fff\",\r\n                        display: \"inline-block\",\r\n                        fontSize: \"12px\",\r\n                        fontWeight: \"bold\",\r\n                        padding: \"3px 8px\",\r\n                      }}\r\n                    >\r\n                      Rank: {Math.round(nft.ranking)}\r\n                    </span>\r\n                  </div>\r\n                  <p style={{ fontSize: \"14px\", marginBottom: \"5px\" }}>\r\n                    Token ID: {nft.token_id}\r\n                  </p>\r\n                  <p style={{ fontSize: \"14px\" }}>\r\n                    Collection: {nft.collection.slug}\r\n                  </p>\r\n                  {nft.nft_state_lists && nft.nft_state_lists[0] && (\r\n                    <p style={{ fontSize: \"14px\" }}>\r\n                      Price:{\" \"}\r\n                      {nft.nft_state_lists[0].list_price /\r\n                        1000000000000000000000000}\r\n                      {\"N \"}\r\n                      {nft.nft_state_lists[0].list_contract.name}\r\n                    </p>\r\n                  )}\r\n                  {nft.nft_state && (\r\n                    <p style={{ fontSize: \"14px\" }}>\r\n                      Owner:\r\n                      {nft.nft_state.owner.length > 20\r\n                        ? nft.nft_state.owner.slice(0, 20) + \"...\"\r\n                        : nft.nft_state.owner}\r\n                    </p>\r\n                  )}\r\n                </NFTCard>\r\n              </a>\r\n            ))}\r\n      </NFTCards>\r\n    )}\r\n  </div>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/jgodwill.near/widget/genadropExplore", "__row_index": 3}