{"tx_hash": "64GFHfuoHY2bJTWohfWJAMkRDLLLM1RzC28MxvHmEdkH", "action_id_social": "Gtre8GSmHsaT6fCtueAhHEJeYzqzdfTZyrP3q9Eizik2-1-widget", "block_id": 84305200, "block_timestamp": "2023-02-01 21:00:43.113", "signer_id": "metachill.near", "widget_name": "ValidatorStakingVoteAction", "source_code": "//ValidatorStakingVoteAction\nif (!context.accountId) {\n  return \"Please sign in with NEAR wallet to stake NEAR\";\n}\n\nconst poolId = props.validator_account_id || \"idtcn4.poolv1.near\";\nconst CONTRACT_ID = \"meta-vote.near\";\nconst GET_VP_METHOD = \"get_available_voting_power\";\nconst VOTE_METHOD = \"vote\";\nconst VOTE_CONTRACT_ADDRESS_ARG = \"metastaking.app\";\n\nconst getVotingPowerBalance = () => {\n  const balanceYocto = Near.view(CONTRACT_ID, GET_VP_METHOD, {\n    voter_id: context.accountId,\n  });\n  return parseInt(balanceYocto) / 1000000000000000000000000;\n};\n\ninitState({ amount: \"0\", poolId, balance: getVotingPowerBalance() });\n\nconst onVoteClick = () => {\n  const gas = 200 * 1000000000000;\n  const deposit = \"\";\n  const args = {\n    contract_address: VOTE_CONTRACT_ADDRESS_ARG,\n    voting_power: state.amount,\n    votable_object_id: state.poolId,\n  };\n\n  Near.call(CONTRACT_ID, VOTE_METHOD, args, gas, deposit);\n};\nconst onUseMaxClick = () => {\n  const balance = getVotingPowerBalance();\n  console.log(\"balance\", balance);\n  State.update({ amount: balance });\n};\nreturn (\n  <div>\n    <h1>\n      Vote&nbsp;for&nbsp;{state.poolId}\n      <a href=\"/#/manzanal.near/widget/ValidatorsStakingVote\" target=\"_blank\">\n        <span className=\"badge bg-secondary fs-6 align-middle\">Validators</span>\n      </a>\n    </h1>\n    <p>\n      Validator: <input value={state.poolId} readOnly />\n    </p>\n    <p>Balance: {state.balance} Voting Power</p>\n    <p>\n      Amount (Voting Power):\n      <div class=\"input-group\">\n        <input\n          type=\"number\"\n          value={state.amount}\n          class=\"form-control\"\n          placeholder=\"Input group example\"\n          aria-label=\"Input group example\"\n          aria-describedby=\"btnGroupAddon\"\n        />\n        <div class=\"input-group-prepend\">\n          <button\n            class=\"input-group-text\"\n            id=\"btnGroupAddon\"\n            className={`btn ${\n              context.loading ? \"btn-outline-dark\" : \"btn-secondary\"\n            }`}\n            onClick={onUseMaxClick}\n          >\n            Use MAX\n          </button>\n        </div>\n      </div>\n    </p>\n\n    <button\n      disabled={context.loading}\n      className={`btn ${context.loading ? \"btn-outline-dark\" : \"btn-primary\"}`}\n      onClick={onVoteClick}\n    >\n      Vote\n    </button>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/metachill.near/widget/ValidatorStakingVoteAction"}