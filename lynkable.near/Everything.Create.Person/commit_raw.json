{"tx_hash": "6BjhGQh5RdVqRUQQdY1SU2tNsk9nsrwsupZwpQbC5hfm", "action_id_social": "23Zd81aHRUFsMavH6Nx4oHkabxRNbUJH4wkk2mVoqEmg-0-widget", "block_id": 89433560, "block_timestamp": "2023-04-12 19:28:53.591", "signer_id": "lynkable.near", "widget_name": "Everything.Create.Person", "source_code": "const Header = styled.div`display: flex; flex-direction: row; justify-content: space-between; align-items: center; `;\nconst Title = styled.div` font-size: 24px; line-height: 33.6px; `;\nconst Form = styled.div` display: flex; flex-direction: column; gap: 4px; `;\nconst Input = styled.input` width: 100%; `;\nconst TextArea = styled.textarea` width: 100%; `;\nconst ButtonRow = styled.div` display: flex; flex-direction: row; gap: 4px; `;\nconst Button = styled.button`\n  text-transform: lowercase !important;\n`;\n\nconst typeStr = \"lynkable.near/type/Person\";\nconst type = Type.get(typeStr);\nconsole.log(type);\n\nconst initState = type.properties.reduce((p, { name }) => {\n  p[name] = \"\";\n  return p;\n}, {});\n\nState.init(initState);\nstate.accountId = context.accountId;\n\nconst handleCreatePerson = () => {\n  if (state) {\n    asyncFetch(\"https://monkfish-app-ginhc.ondigitalocean.app/graphql\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"X-Everything\": \"simple\",\n      },\n      body: JSON.stringify({\n        query:\n          \"mutation createPerson($name: String, $note: String, $accountId: String, $email: String, $widgetSrc: String) { people { create(name: $name, accountId: $accountId, email: $email, widgetSrc: $widgetSrc) { entities { id } } appendContentToDescription(value: $note) { entities { id   } } } }\",\n        variables: state,\n      }),\n    }).then((res) => {\n      if (res.body.errors) {\n        console.log(res.body.errors);\n      } else {\n        Social.set(\n          {\n            thing: {\n              main: JSON.stringify({\n                thingId: res.body.data.people.create.entities[0].id,\n              }),\n            },\n            index: {\n              les: JSON.stringify({\n                key: \"main\",\n                value: {\n                  type: \"lynkable.near/type/Person\",\n                },\n              }),\n            },\n          },\n          {\n            force: true,\n          }\n        );\n      }\n    });\n    return;\n  }\n};\n\nreturn (\n  <>\n    <Header>\n      <Title>{typeStr.split(\"/\")[2]}</Title>\n    </Header>\n    <Form>\n      <Input\n        placeholder=\"name\"\n        onChange={({ target }) => State.update({ name: target.value })}\n      />\n      <Input\n        placeholder=\"email\"\n        onChange={({ target }) => State.update({ email: target.value })}\n      />\n      <TextArea\n        placeholder=\"note\"\n        onInput={({ target }) => State.update({ note: target.value })}\n      />\n      <ButtonRow>\n        <Button\n          onClick={handleCreatePerson}\n          disabled={state.name === \"\" || state.email === \"\"}\n        >\n          create\n        </Button>\n      </ButtonRow>\n    </Form>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/lynkable.near/widget/Everything.Create.Person"}