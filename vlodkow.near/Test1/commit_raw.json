{"tx_hash": "AHCEBVKaAxzq6Jwwsm4WCcsrrcFCUdBTVqNhherzggXp", "action_id_social": "H4FiX9aJV97iZvnvvUJbfBAAwJLvKeStzN1gJ5m81dad-0-widget", "block_id": 89405197, "block_timestamp": "2023-04-12 10:34:43.548", "signer_id": "vlodkow.near", "widget_name": "Test1", "source_code": null, "metadata": null, "branch": NaN, "widget_modules_used": null, "widget_url": "https://near.social/#/vlodkow.near/widget/Test1", "branch.draft.": "let user_account = context.accountId;\n\nconst contract = \"chatme.near\";\nconst greeting = Near.view(contract, \"get_greeting\", {});\n\nState.init({ greeting: \"have a great day!!!\" });\nconst onChange = ({ target }) => {\n  State.update({ greeting: target.value });\n};\n\nconst getPrivateChatId = (user1, user2) => {\n  if (user1 > user2) {\n    return user1.concat(\"|\").concat(user2);\n  }\n  return user2.concat(\"|\").concat(user1);\n};\n\nconst sourceURL =\n  \"https://api.thegraph.com/subgraphs/name/vlodkomr/chatme-main\";\n\nfetch(sourceURL, {\n  method: \"POST\",\n  headers: {\n    \"Content-Type\": \"application/json\",\n  },\n  body: JSON.stringify({\n    query: `{\n        privateMessages(\n          last: 100, \n          skip: 0,\n          orderBy: created_at, \n          orderDirection: desc,\n          where: {\n            chat_id: \"${getPrivateChatId(\"vlodkow.near\", \"chatme.near\")}\",\n        }) {\n            id\n            inner_id\n            text\n            image\n            from_address\n            to_address\n            deposit\n            created_at\n            encrypt_key\n            reply_message {id, from_address, text, image, encrypt_key}\n        }}\n      `,\n  }),\n})\n  .then((res) => res.json())\n  .then((result) => console.log(result));\n\nreturn (\n  <>\n    <div class=\"container border border-info p-2 text-center\">\n      <h1>Hello World! {user_account}</h1>\n      <hr />\n      {user_account && (\n        <>\n          <p>{state.greeting}</p>\n          <input onChange={onChange} />\n        </>\n      )}\n    </div>\n  </>\n);\n", "branch.draft.metadata": NaN}