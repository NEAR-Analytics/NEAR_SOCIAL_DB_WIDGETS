{"tx_hash": "HjWoCDxjp8br6J8DVCMH7vw9F5QCQ9dUeVBVcM3U2UNj", "action_id_social": "7Mku2Jee5nk8mVz3BAh7274fF5y3ccYgbhmfQ7CwNrUj-0-widget", "block_id": 87944332, "block_timestamp": "2023-03-23 13:12:07.609", "signer_id": "sainthiago.near", "widget_name": "Mint-Post.Minter", "source_code": null, "metadata": null, "widget_modules_used": null, "widget_url": "https://near.social/#/sainthiago.near/widget/Mint-Post.Minter", "branch.draft.": "const accountId = context.accountId;\n\nif (!accountId) {\n  return (\n    <p className=\"text-center mt-5\">\n      To mint your posts as NFTs please connect your wallet.\n    </p>\n  );\n}\n\nconst index = {\n  action: \"post\",\n  key: \"main\",\n  options: {\n    limit: 10,\n    order: \"desc\",\n    accountId,\n  },\n};\n\nconst handleImageUpload = (files) => {\n  if (files?.length > 0) {\n    State.update({\n      img: {\n        uploading: true,\n        cid: null,\n      },\n    });\n    const body = files[0];\n    asyncFetch(\"https://ipfs.near.social/add\", {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n      },\n      body,\n    }).then((res) => {\n      const cid = res.body.cid;\n\n      State.update({\n        img: {\n          cid,\n        },\n      });\n\n      handleMint(cid);\n    });\n  }\n  \nconst mintPost = ({ text, image, blockHeight }) => {\n  const gas = 200000000000000;\n  const deposit = 0;\n\n  Near.call([\n    {\n      contractName: proxyMinter,\n      methodName: \"mint\",\n      args: {\n        owner_id: accountId,\n        metadata: {\n          media: `https://ipfs.near.social/ipfs/${image}`,\n          title: `${accountId}-post-${blockHeight}`,\n          description: text,\n        },\n        num_to_mint: 1,\n        royalty_args: {\n          split_between: {\n            [accountId]: 10000,\n          },\n          percentage: 1000,\n        },\n        split_owners: null,\n        nft_contract_id: nftContractId,\n      },\n      gas: gas,\n      deposit: deposit,\n    },\n  ]);\n};\n\nconst renderItem = (a) =>\n  a.value.type === \"md\" && (\n    <div className=\"post\" key={JSON.stringify(a)}>\n      <Widget\n        src=\"sainthiago.near/widget/Mint-Post.Post\"\n        props={{\n          accountId: a.accountId,\n          blockHeight: a.blockHeight,\n          onChange: ({ text, image }) => {\n            console.log(text, image.ipfs_cid);\n          },\n        }}\n      />\n    </div>\n  );\n\nreturn (\n  <Widget\n    src=\"adminalpha.near/widget/IndexFeed\"\n    props={{ index, renderItem, moderatorAccount: \"adminalpha.near\" }}\n  />\n);\n"}