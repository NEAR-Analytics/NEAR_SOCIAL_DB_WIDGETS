{"tx_hash": "7Er2q4TSj5CDzcdEb1W2w7RUx5y3oB9oojts5z31kSNF", "action_id_social": "Du3Nq1uymSKy5mxQzg4a9dmb5wrZgRqvRgkgwq9LhGLq-0-widget", "block_id": 87344231, "block_timestamp": "2023-03-15 10:34:40.012", "signer_id": "reallyveryy.near", "widget_name": "Flipside-BarChart-V2.1", "source_code": "State.init({\r\n  imgSrc: \"\",\r\n});\r\n\r\nlet { query } = props;\r\nvar formBody = [];\r\nformBody.push(`statement=${query}`);\r\nformBody = formBody.join(\"&\");\r\n\r\n// Query API\r\nconst options = {\r\n  method: \"POST\",\r\n  body: formBody,\r\n  headers: {\r\n    Accept: \"application/json\",\r\n    \"Content-Type\": \"application/x-www-form-furlencoded;charset=UTF-8\",\r\n  },\r\n};\r\n\r\nasyncFetch(\"https://flipside.leslug.com/execute\", options).then((res) => {\r\n  let queryResults = res.body;\r\n\r\n  console.log(\"queryResults\", queryResults);\r\n  const chartType = `\"bar\"`;\r\n  let chartBottomAxisLabels = \"[\";\r\n  let chartValues = \"[\";\r\n  2;\r\n  // parsing of data from flipside\r\n  if (queryResults !== \"\") {\r\n    // parsing of labels\r\n    queryResults.rows.map((d, i) => {\r\n      if (i !== 0) {\r\n        chartBottomAxisLabels += \",\";\r\n        chartValues += \",\";\r\n      } else {\r\n        chartValues += `{label: '${props.title}', data:[`;\r\n      }\r\n      chartBottomAxisLabels += \"'\";\r\n      chartBottomAxisLabels += d[0];\r\n      chartBottomAxisLabels += \"'\";\r\n\r\n      chartValues += \"'\";\r\n      chartValues += d[1];\r\n      chartValues += \"'\";\r\n    });\r\n\r\n    chartValues += \"]}]\";\r\n    chartBottomAxisLabels += \"]\";\r\n    const imgTemplate = `https://quickchart.io/chart?width=${props.chartWidth}&height=${props.chartHeight}&chart={type:${chartType},data:{labels:${chartBottomAxisLabels}, datasets:${chartValues}}}`;\r\n    State.update({\r\n      imgSrc: imgTemplate,\r\n    });\r\n  }\r\n});\r\n\r\nreturn (\r\n  <>\r\n    {state.imgSrc === \"\" ? <div>Loading ...</div> : <img src={state.imgSrc} />}\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/reallyveryy.near/widget/Flipside-BarChart-V2.1"}