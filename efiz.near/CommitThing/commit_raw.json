{"tx_hash": "GQEhSGHyKthPkXaS46Y5VYZqqhZMsto8cvAhsC2RSt7P", "action_id_social": "9gEN4U5WFKyU3BuMjKhmnqjHtuzgxfwhikXpaHVA6hjs-0-widget", "block_id": 89669166, "block_timestamp": "2023-04-15 22:26:00.941", "signer_id": "efiz.near", "widget_name": "CommitThing", "source_code": "/*\n---props---\n\nprops.widgetPath?: string,\n\n*/\n\n// How can I access the widget path dynamically?\nconst initWidgetPath = \"efiz.near/widget/Create\";\n\nState.init({\n  widgetPath: initWidgetPath,\n  color: \"\",\n  brand: \"\",\n  size: \"\",\n  material: \"\",\n});\n\n// START GET THE WIDGET COMMIT\nconst historyBlocksRequest = Social.keys(`${initWidgetPath}`, \"final\", {\n  return_type: \"History\",\n});\n\nif (historyBlocksRequest === null) return \"loading...\";\n\nconst [widgetAccountId, _, widgetName] = initWidgetPath.split(\"/\");\n\nlet blocksChanges =\n  historyBlocksRequest[widgetAccountId]?.[\"widget\"]?.[widgetName];\n\n// Latest commit sits at blocksChanges[0]\n// How do we know this is the one they are using though?\n// END GET THE WIDGET COMMIT\n\nconst composeData = () => {\n  const data = {\n    thing: {\n      main: JSON.stringify({\n        color: state.color,\n        brand: state.brand,\n        size: state.size,\n        material: state.material,\n        commit: blocksChanges[0],\n      }),\n    },\n    index: {\n      thing: JSON.stringify({\n        key: \"main\",\n        value: {\n          type: \"thing\",\n        },\n      }),\n    },\n  };\n\n  return data;\n};\n\nreturn (\n  <div>\n    <h1 class=\"text-center\">Thing</h1>\n\n    <div class=\"input-group mb-3\">\n      <input\n        class=\"form-control\"\n        placeholder={\"color\"}\n        onChange={({ target }) => State.update({ color: target.value })}\n      />\n      <input\n        class=\"form-control\"\n        placeholder={\"brand\"}\n        onChange={({ target }) => State.update({ brand: target.value })}\n      />\n      <input\n        class=\"form-control\"\n        placeholder={\"size\"}\n        onChange={({ target }) => State.update({ size: target.value })}\n      />\n      <input\n        class=\"form-control\"\n        placeholder={\"material\"}\n        onChange={({ target }) => State.update({ material: target.value })}\n      />\n    </div>\n    <div>\n      <div className={\"list-group-item list-group-item-action \"}>\n        #{blocksChanges[0]}\n      </div>\n      <div className={\"list-group-item list-group-item-action \"}>\n        {state.color}\n      </div>\n      <div className={\"list-group-item list-group-item-action \"}>\n        {state.brand}\n      </div>\n      <div className={\"list-group-item list-group-item-action \"}>\n        {state.size}\n      </div>\n      <div className={\"list-group-item list-group-item-action \"}>\n        {state.material}\n      </div>\n    </div>\n    <CommitButton\n      disabled={false}\n      force\n      className=\"btn btn-dark rounded-3\"\n      data={composeData}\n    >\n      Create\n    </CommitButton>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/efiz.near/widget/CommitThing"}