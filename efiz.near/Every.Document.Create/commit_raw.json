{"tx_hash": "C4mwWBQ6JWM6SZZ5cWym6xq4StVQVBYSfT4BL9AavZzs", "action_id_social": "GbSSRAF5cWutBBPTzg3TBvMzSxpcjuBVwFbTNduMwxVS-0-widget", "block_id": 92497063, "block_timestamp": "2023-05-23T03:43:43.582Z", "signer_id": "efiz.near", "widget_name": "Every.Document.Create", "source_code": "const accountId = context.accountId || null;\nconst onChange = props.onChange;\n\nif (accountId === null) {\n  return \"please login to a near account\";\n}\n\nconst FormContainer = styled.div`\n  width: 500px;\n  margin: 0 auto;\n`;\n\nconst SectionTitle = styled.h2`\n  font-size: 24px;\n  margin-top: 20px;\n`;\n\nconst SectionContainer = styled.div`\n  border: 1px solid #ccc;\n  padding: 10px;\n  margin-bottom: 20px;\n`;\n\nconst FormGroup = styled.div`\n  margin-bottom: 10px;\n`;\n\nconst Label = styled.label`\n  display: block;\n  margin-bottom: 5px;\n  font-size: 18px;\n`;\n\nconst InputContainer = styled.div`\n  display: flex;\n  align-items: center;\n`;\n\nconst Input = styled.input`\n  width: 100%;\n  padding: 8px;\n`;\n\nconst Button = styled.button`\n  margin-left: 5px;\n`;\n\nState.init({\n  components: [],\n});\n\nfunction handleSaveDocument() {\n  const thing = {};\n  const blocks = [];\n\n  state.components?.forEach((entry) => {\n    const entryId = Math.random();\n    thing[entryId] = {\n      data: entry.value,\n      type: entry.type,\n    };\n    blocks.push(`${accountId}/thing/${entryId}`);\n  });\n  if (onChange) {\n    onChange(blocks);\n  }\n}\n\nfunction handleTypeClick(type) {\n  State.update({ components: [...state.components, { type }] });\n}\n\nfunction handleDeleteClick(index) {\n  const updatedComponents = [...state.components];\n  updatedComponents.splice(index, 1);\n  State.update({ components: updatedComponents });\n}\n\nfunction handleMoveUpClick(index) {\n  if (index > 0) {\n    const updatedComponents = [...state.components];\n    const component = updatedComponents[index];\n    updatedComponents.splice(index, 1);\n    updatedComponents.splice(index - 1, 0, component);\n    State.update({ components: updatedComponents });\n  }\n}\n\nfunction handleMoveDownClick(index) {\n  if (index < state.components.length - 1) {\n    const updatedComponents = [...state.components];\n    const component = updatedComponents[index];\n    updatedComponents.splice(index, 1);\n    updatedComponents.splice(index + 1, 0, component);\n    State.update({ components: updatedComponents });\n  }\n}\n\nfunction RenderComponent({ component, index }) {\n  const isTop = index === 0;\n  const isBottom = index === state.components.length - 1;\n\n  const type = JSON.parse(Social.get(component.type, \"final\") || \"null\");\n  const widgetSrc = type.widgets?.create;\n\n  const handleComponentChange = (value) => {\n    const updatedComponents = [...state.components];\n    updatedComponents[index] = {\n      ...updatedComponents[index],\n      value,\n    };\n    State.update({ components: updatedComponents });\n  };\n\n  return (\n    <div>\n      <Widget\n        src={widgetSrc}\n        props={{\n          data: state.components[index].value,\n          onChange: handleComponentChange,\n        }}\n      />\n      <Button onClick={() => handleDeleteClick(index)}>Delete</Button>\n      <Button onClick={() => handleMoveUpClick(index)} disabled={isTop}>\n        &uarr;\n      </Button>\n      <Button onClick={() => handleMoveDownClick(index)} disabled={isBottom}>\n        &darr;\n      </Button>\n    </div>\n  );\n}\n\nreturn (\n  <div>\n    <Button onClick={() => handleTypeClick(\"efiz.near/type/Image\")}>\n      Add Image\n    </Button>\n    <Button onClick={() => handleTypeClick(\"efiz.near/type/paragraph\")}>\n      Add Paragraph\n    </Button>\n    {state.components.map((component, index) => (\n      <RenderComponent key={index} component={component} index={index} />\n    ))}\n    <Button onClick={handleSaveDocument}>save</Button>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/efiz.near/widget/Every.Document.Create", "__row_index": 4}