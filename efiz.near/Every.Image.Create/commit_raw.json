{"tx_hash": "F9QrWPwEjU4xT6LCTmN9gyn1wFxF4zys2ZzvagGNa9hE", "action_id_social": "AMR3MhgypZ932bUpTmyriShAmqbFGP5p5K25phuaicvV-0-widget", "block_id": 92490974, "block_timestamp": "2023-05-23T01:47:40.129Z", "signer_id": "efiz.near", "widget_name": "Every.Image.Create", "source_code": "const buttonText = props.buttonText || \"Upload an image\";\nconst onChange = props.onChange;\nconst cid = props.cid ?? null;\n\ninitState({\n  file: { cid },\n});\n\nconst ipfsUrl = (cid) => `https://ipfs.near.social/ipfs/${cid}`;\n\nconst filesOnChange = (file) => {\n  if (file?.length > 0) {\n    State.update({\n      file: {\n        uploading: true,\n        cid: null,\n      },\n    });\n    const body = file[0];\n    asyncFetch(\"https://ipfs.near.social/add\", {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n      },\n      body,\n    }).then((res) => {\n      const cid = res.body.cid;\n      console.log(\"CID\", cid);\n      State.update({\n        file: {\n          cid,\n        },\n      });\n      if (onChange) {\n        onChange(cid);\n      }\n    });\n  } else {\n    State.update({\n      file: null,\n    });\n  }\n};\n\nreturn (\n  <div className=\"d-inline-block\">\n    {state.file.cid ? <img src={ipfsUrl(state.file.cid)} width={100} /> : <></>}\n    <Files\n      multiple={false}\n      accepts={[\"image/*\"]}\n      minFileSize={1}\n      clickable\n      className=\"btn btn-outline-primary\"\n      onChange={filesOnChange}\n    >\n      {state.file?.uploading\n        ? \"Uploading\"\n        : state.file && state.file.cid\n        ? \"Replace\"\n        : buttonText}\n    </Files>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/efiz.near/widget/Every.Image.Create", "__row_index": 0}