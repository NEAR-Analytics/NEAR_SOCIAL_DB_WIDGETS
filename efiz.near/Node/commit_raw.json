{"tx_hash": "xSX9sCnVPuUZtWE2SZmTgQkkhZGiHFnWuRDMCB2P5UK", "action_id_social": "5nzRKJywMHBzNDS4LnjAQti59DdHneG9AyZEU6HcLqp8-0-widget", "block_id": 91621375, "block_timestamp": "2023-05-11T17:15:28.968Z", "signer_id": "efiz.near", "widget_name": "Node", "source_code": "const key = props.key;\nconst path = props.path;\nconst history = props.history;\nconst traverseInto = props.traverseInto;\nconst traverseBack = props.traverseBack;\n\nState.init({\n  expanded: false,\n});\n\nfunction handleExpand() {\n  State.update({ expanded: !state.expanded });\n}\n\nfunction handleInto() {\n  traverseInto(key, path, history);\n}\n\nfunction handleBack() {\n  console.log(`going back, out of ${key} and current path ${path}`);\n  traverseBack(history);\n}\n\nconst parts = path.split(\"/\");\nif (parts.length === 1) {\n  // account\n  if (parts[0] !== \"*\") {\n    parts.push(\"**\");\n  }\n} else if (parts.length === 2) {\n  parts.push(\"**\");\n}\n\nconst value = Social.get(parts.join(\"/\"), \"final\");\n\nconst Button = styled.button`\n  text-transform: lowercase !important;\n`;\n\nconst renderThing = (value) => {\n  const text = `\n\\`\\`\\`json\n${JSON.stringify(value, undefined, 2)}\n\\`\\`\\`\n`;\n\n  return <Markdown text={text} />;\n};\n\nfunction buildPath(current, key) {\n  const parts = current.split(\"/\");\n  const suffix = parts[parts.length - 1];\n  if (suffix === \"*\" || suffix === \"**\") {\n    parts.pop();\n  }\n  parts.push(key);\n\n  if (parts.length < 3) {\n    parts.push(\"**\");\n  }\n  return parts.join(\"/\");\n}\n\nreturn (\n  <div>\n    {history.length > 0 && <Button onClick={handleBack}>back</Button>}\n    <Button onClick={handleInto}>{key}</Button>\n    <Button onClick={handleExpand}>{state.expanded ? \"-\" : \"+\"}</Button>\n    {state.expanded && (\n      <div>\n        {typeof value === \"object\" ? (\n          Object.entries(value).map(([key, val]) => (\n            <Widget\n              src=\"efiz.near/widget/Node\"\n              props={{\n                key,\n                path,\n                history,\n                traverseInto,\n                traverseBack,\n              }}\n            />\n          ))\n        ) : (\n          <div>{renderThing()}</div>\n        )}\n      </div>\n    )}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/efiz.near/widget/Node", "__row_index": 48}