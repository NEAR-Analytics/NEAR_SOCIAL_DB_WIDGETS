{"tx_hash": "C4nSPHZ8vnGP9e7Gvs7BCF6k26N1QJwaWTsHJ6hnFFAr", "action_id_social": "DoR6hyuoY9tLrxRN5W8bb2Mbvey2WgsghvSeRkzP5VD6-0-widget", "block_id": 86635087, "block_timestamp": "2023-03-05 20:03:18.637", "signer_id": "zahidulislam.near", "widget_name": "Widget.Leaderboard", "source_code": "const profiles =\n  Social.get([\"*/profile/name\", \"*/profile/tags/*\"], \"final\") || {};\n\nconst accounts = Object.keys(profiles);\n\nconst getWidgetHistory = (accountId) => {\n  const allWidgetsHistoryChangesBlocks = Social.keys(\n    `${accountId}/widget/*`,\n    \"final\",\n    {\n      return_type: \"History\",\n    }\n  );\n\n  return allWidgetsHistoryChangesBlocks;\n};\n\nconst users = accounts\n  .map((accountId) => {\n    const widgetHistory = getWidgetHistory(accountId);\n\n    console.log(widgetHistory);\n    if (Object.keys(widgetHistory).length !== 0) {\n      return widgetHistory;\n    } else {\n      return undefined;\n    }\n  })\n  .filter((x) => x);\n\nconst numOfProfiles = users.map((user) => {\n  const xs = Object.keys(user).map((key) => user[key]);\n  const xss = xs[0][\"widget\"]; //.map((x) => xs[x]);\n\n  const accountId = Object.keys(user)[0];\n\n  const widgets = Object.keys(xss).map((w) => ({ [w]: xss[w] }));\n\n  return {\n    accountId,\n    widgets,\n    numOfWidget: widgets.length,\n  };\n});\n\nconst rankContributors = numOfProfiles.sort(\n  (a, b) => b.numOfWidget - a.numOfWidget\n);\n\nconst contributors = rankContributors.map((c) => {\n  const profile = Social.getr(`${c.accountId}/profile`);\n  const url = `https://ipfs.near.social/ipfs/${profile?.image?.ipfs_cid}`;\n\n  const name = profile.name;\n  const description = profile.description;\n  const tags = Object.keys(profile.tags ?? {});\n\n  return {\n    profile,\n    url,\n    name,\n    description,\n    tags,\n    ...c,\n  };\n});\n\nreturn (\n  <div class=\"container\">\n    <h2 class=\"mb-4\">Widget Leaderboard</h2>\n    {contributors.map((contributor) => (\n      <div className=\"d-flex flex-row pt-4 pb-4 border-bottom\">\n        <Widget\n          src=\"mob.near/widget/ProfileImage\"\n          props={{\n            metadata,\n            accountId: contributor.accountId,\n            widgetName,\n            style: { height: \"6em\", width: \"6em\", minWidth: \"6em\" },\n            className: \"me-2\",\n          }}\n        />\n        <div className=\"text-truncate\">\n          <div className=\"text-truncate\">\n            <span className=\"fw-bold\">{contributor.name}</span>{\" \"}\n            <small>\n              <span className=\"font-monospace\">@{contributor.accountId}</span>\n            </small>\n          </div>\n          <div className=\"text-truncate text-muted\">\n            {contributor.tags.length > 0 && (\n              <>\n                {contributor.tags.map((tag, i) => (\n                  <span\n                    key={i}\n                    className=\"me-1 fw-light badge border border-secondary text-bg-light\"\n                  >\n                    #{tag}\n                  </span>\n                ))}\n              </>\n            )}\n            <div\n              class=\"mt-2\"\n              style={{\n                fontWeight: 600,\n              }}\n            >{`#${contributor.numOfWidget} of widgets`}</div>\n          </div>\n        </div>\n      </div>\n    ))}\n  </div>\n);\n", "metadata": NaN, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/zahidulislam.near/widget/Widget.Leaderboard", "metadata.description": NaN, "metadata.image.ipfs_cid": NaN, "metadata.name": NaN, "metadata.tags.dev": NaN, "metadata.tags.ethdenver2023": NaN, "metadata.tags.hackathon": NaN}