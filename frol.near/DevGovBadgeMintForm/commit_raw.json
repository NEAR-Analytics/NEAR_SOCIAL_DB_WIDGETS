{"tx_hash": "7jUsWjJHhdKc2geZZSyPDxzJpF31d61fBdFsBnxnqWRs", "action_id_social": "35R8jSofbn5skoFC7gwpunpn15g5egbAdFwcSwaPHySR-0-widget", "block_id": 83316228, "block_timestamp": "2023-01-19 15:12:30.775", "signer_id": "frol.near", "widget_name": "DevGovBadgeMintForm", "source_code": "const nearDevGovBadgesContractId = \"devgov-badges.frol.near\";\n\nState.init({\n  badgeId: \"\",\n  badgeMetadata: { copies: 0 },\n});\n\nconst slugify = (text) => {\n  return text\n    .normalize(\"NFD\")\n    .replace(/[\\u0300-\\u036f]/g, \"\")\n    .toLowerCase()\n    .trim()\n    .replace(/\\s+/g, \"-\")\n    .replace(/[^\\w-]+/g, \"\")\n    .replace(/--+/g, \"-\");\n};\n\nconst submitForm = () => {\n  Near.call(\n    nearDevGovBadgesContractId,\n    \"mint_badge\",\n    {\n      badge_id: state.badgeId,\n      badge_metadata: state.badgeMetadata,\n    },\n    30000000000000,\n    1\n  );\n};\n\nreturn (\n  <div className=\"row\">\n    <div className=\"col-lg-6\">\n      <div>\n        <h4>\n          Mint new NEAR Developer Governance Badge (available only for\n          moderators)\n        </h4>\n      </div>\n      <div className=\"mb-2\">\n        <Widget\n          src=\"mob.near/widget/MetadataEditor\"\n          props={{\n            initialMetadata: badgeMetadata,\n            onChange: (newMetadata) => {\n              let media = newMetadata.image.url || newMetadata.image.ipfs_cid;\n              if (!media && newMetadata.image.nft) {\n                media = Near.view(\n                  newMetadata.image.nft.contractId,\n                  \"nft_token\",\n                  {\n                    token_id: newMetadata.image.nft.tokenId,\n                  }\n                );\n                console.log(\n                  \"nft\",\n                  newMetadata.image.nft.contractId,\n                  \"nft_token\",\n                  {\n                    token_id: newMetadata.image.nft.tokenId,\n                  },\n                  media\n                );\n                media = media.metadata.media;\n              }\n              console.log(\"newmeta2\", newMetadata, media);\n              State.update({\n                badgeId: slugify(newMetadata.name),\n                badgeMetadata: {\n                  title: newMetadata.name,\n                  media,\n                  description: newMetadata.description,\n                  copies: 0,\n                },\n              });\n            },\n            options: {\n              name: { label: \"Badge Name\" },\n              image: { label: \"Badge Image\" },\n              description: { label: \"Badge Description\" },\n            },\n          }}\n        />\n      </div>\n      <div className=\"mb-2\">\n        <button class=\"btn btn-success\" onClick={submitForm}>\n          Mint Badge\n        </button>\n      </div>\n    </div>\n    <div className=\"col-lg-6\">\n      <div>\n        <Widget\n          src=\"frol.near/widget/DevGovBadgeDetails\"\n          props={{ badgeId: state.badgeId, badgeMetadata: state.badgeMetadata }}\n        />\n      </div>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/frol.near/widget/DevGovBadgeMintForm"}