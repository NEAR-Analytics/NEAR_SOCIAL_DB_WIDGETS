{"tx_hash": "FEZeQXPfm2NHtkcSzYWDMzJiXJjHtqGRvwYaevMdoV5B", "action_id_social": "837LY5sMD5KWxU5YVyukbBQdw29BEYX8bSwifeVyxR8-0-widget", "block_id": 94655052, "block_timestamp": "2023-06-21T01:22:57.407Z", "signer_id": "root.akaia.near", "widget_name": "gigs-board.entity.community.header", "source_code": "/* INCLUDE: \"common.jsx\" */\nconst nearDevGovGigsContractAccountId =\n  props.nearDevGovGigsContractAccountId ||\n  (context.widgetSrc ?? \"devgovgigs.near\").split(\"/\", 1)[0];\n\nconst nearDevGovGigsWidgetsAccountId =\n  props.nearDevGovGigsWidgetsAccountId ||\n  (context.widgetSrc ?? \"devgovgigs.near\").split(\"/\", 1)[0];\n\nfunction widget(widgetName, widgetProps, key) {\n  widgetProps = {\n    ...widgetProps,\n    nearDevGovGigsContractAccountId: props.nearDevGovGigsContractAccountId,\n    nearDevGovGigsWidgetsAccountId: props.nearDevGovGigsWidgetsAccountId,\n    referral: props.referral,\n  };\n\n  return (\n    <Widget\n      src={`${nearDevGovGigsWidgetsAccountId}/widget/gigs-board.${widgetName}`}\n      props={widgetProps}\n      key={key}\n    />\n  );\n}\n\nfunction href(widgetName, linkProps) {\n  linkProps = { ...linkProps };\n\n  if (props.nearDevGovGigsContractAccountId) {\n    linkProps.nearDevGovGigsContractAccountId =\n      props.nearDevGovGigsContractAccountId;\n  }\n\n  if (props.nearDevGovGigsWidgetsAccountId) {\n    linkProps.nearDevGovGigsWidgetsAccountId =\n      props.nearDevGovGigsWidgetsAccountId;\n  }\n\n  if (props.referral) {\n    linkProps.referral = props.referral;\n  }\n\n  const linkPropsQuery = Object.entries(linkProps)\n    .filter(([_key, nullable]) => (nullable ?? null) !== null)\n    .map(([key, value]) => `${key}=${value}`)\n    .join(\"&\");\n\n  return `/#/${nearDevGovGigsWidgetsAccountId}/widget/gigs-board.pages.${widgetName}${\n    linkPropsQuery ? \"?\" : \"\"\n  }${linkPropsQuery}`;\n}\n/* END_INCLUDE: \"common.jsx\" */\n/* INCLUDE: \"core/adapter/dev-hub\" */\nconst contractAccountId =\n  props.nearDevGovGigsContractAccountId ||\n  (context.widgetSrc ?? \"devgovgigs.near\").split(\"/\", 1)[0];\n\nconst DevHub = {\n  edit_community_github: ({ handle, github }) =>\n    Near.call(contractAccountId, \"edit_community_github\", { handle, github }) ??\n    null,\n\n  get_access_control_info: () =>\n    Near.view(contractAccountId, \"get_access_control_info\") ?? null,\n\n  get_all_communities: () =>\n    Near.view(contractAccountId, \"get_all_communities\") ?? null,\n\n  get_community: ({ handle }) =>\n    Near.view(contractAccountId, \"get_community\", { handle }) ?? null,\n\n  get_post: ({ post_id }) =>\n    Near.view(contractAccountId, \"get_post\", { post_id }) ?? null,\n\n  get_posts_by_label: ({ label }) =>\n    Near.view(nearDevGovGigsContractAccountId, \"get_posts_by_label\", {\n      label,\n    }) ?? null,\n\n  get_root_members: () =>\n    Near.view(contractAccountId, \"get_root_members\") ?? null,\n};\n/* END_INCLUDE: \"core/adapter/dev-hub\" */\n\nconst Header = styled.div`\n  overflow: hidden;\n  background: #fff;\n  margin-bottom: 25px;\n`;\n\nconst NavUnderline = styled.ul`\n  border-bottom: 1px #eceef0 solid;\n\n  a {\n    color: #687076;\n    text-decoration: none;\n  }\n\n  a.active {\n    font-weight: bold;\n    color: #0c7283;\n    border-bottom: 4px solid #0c7283;\n  }\n`;\n\nconst Button = styled.button`\n  height: 40px;\n  font-size: 14px;\n  border-color: #e3e3e0;\n  background-color: #ffffff;\n`;\n\nconst Banner = styled.div`\n  max-width: 100%;\n  width: 1320px;\n  height: 240px;\n`;\n\nconst LogoImage = styled.img`\n  top: -50px;\n`;\n\nconst SizedDiv = styled.div`\n  width: 150px;\n  height: 100px;\n`;\n\nconst CommunityHeader = ({ activeTabTitle, handle }) => {\n  State.init({\n    copiedShareUrl: false,\n  });\n\n  const accessControlInfo = DevHub.get_access_control_info();\n\n  const communityData = DevHub.get_community({ handle });\n\n  if (accessControlInfo === null || communityData === null) {\n    return <div>Loading...</div>;\n  }\n\n  const isSupervisionAllowed =\n    accessControlInfo.members_list[\"team:moderators\"]?.children?.includes(\n      context.accountId\n    ) ?? false;\n\n  const tabs = [\n    {\n      defaultActive: true,\n      iconClass: \"bi bi-house-door\",\n      route: \"community.activity\",\n      title: \"Activity\",\n    },\n\n    ...[communityData.wiki1, communityData.wiki2]\n      .filter((maybeWikiPage) => maybeWikiPage ?? false)\n      .map(({ name }, idx) => ({\n        params: { id: idx + 1 },\n        route: \"community.wiki\",\n        title: name,\n      })),\n\n    {\n      iconClass: \"bi bi-coin\",\n      route: \"community.sponsorship\",\n      title: \"Sponsorship\",\n    },\n\n    {\n      iconClass: \"bi bi-github\",\n      route: \"community.github\",\n      title: \"GitHub\",\n    },\n\n    ...((communityData?.telegram_handle?.length ?? 0) > 0\n      ? [\n          {\n            iconClass: \"bi bi-telegram\",\n            route: \"community.telegram\",\n            title: \"Telegram\",\n          },\n        ]\n      : []),\n  ];\n\n  const isEditingAllowed =\n    isSupervisionAllowed ||\n    communityData?.admins?.includes?.(context.accountId);\n\n  return (\n    <Header className=\"d-flex flex-column gap-3\">\n      <Banner\n        className=\"object-fit-cover\"\n        style={{\n          background: `center / cover no-repeat url(${communityData.banner_url})`,\n        }}\n      />\n\n      <div className=\"d-md-flex d-block justify-content-between container\">\n        <div className=\"d-md-flex d-block align-items-end\">\n          <div className=\"position-relative\">\n            <SizedDiv>\n              <LogoImage\n                src={communityData.logo_url}\n                alt=\"Community logo\"\n                width=\"150\"\n                height=\"150\"\n                className=\"border border-3 border-white rounded-circle shadow position-absolute\"\n              />\n            </SizedDiv>\n          </div>\n\n          <div>\n            <div className=\"h1 pt-3 ps-3 text-nowrap\">{communityData.name}</div>\n\n            <div className=\"ps-3 pb-2 text-secondary\">\n              {communityData.description}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"d-flex align-items-end gap-3\">\n          {isEditingAllowed && (\n            <a\n              href={href(\"community.edit-info\", { handle })}\n              className={[\n                \"d-flex align-items-center gap-2 border border-1 rounded-pill px-3 py-2\",\n                \"text-decoration-none text-dark text-nowrap font-weight-bold fs-6\",\n              ].join(\" \")}\n            >\n              <i className=\"bi bi-gear\" />\n              <span>Edit information</span>\n            </a>\n          )}\n\n          <OverlayTrigger\n            placement=\"top\"\n            overlay={<Tooltip>Copy URL to clipboard</Tooltip>}\n          >\n            <Button\n              type=\"button\"\n              className={[\n                \"d-flex align-items-center gap-2 border border-1 rounded-pill px-3 py-2\",\n                \"text-dark text-nowrap font-weight-bold fs-6\",\n              ].join(\" \")}\n              onMouseLeave={() => {\n                State.update({ copiedShareUrl: false });\n              }}\n              onClick={() => {\n                clipboard\n                  .writeText(\n                    \"https://near.org\" + href(\"community.activity\", { handle })\n                  )\n                  .then(() => {\n                    State.update({ copiedShareUrl: true });\n                  });\n              }}\n            >\n              {state.copiedShareUrl ? (\n                <i className=\"bi bi-16 bi-check\"></i>\n              ) : (\n                <i className=\"bi bi-16 bi-link-45deg\"></i>\n              )}\n\n              <span>Share</span>\n            </Button>\n          </OverlayTrigger>\n        </div>\n      </div>\n\n      <NavUnderline className=\"nav\">\n        {tabs.map(({ defaultActive, params, route, title }) =>\n          title ? (\n            <li className=\"nav-item\" key={title}>\n              <a\n                aria-current={defaultActive && \"page\"}\n                className={[\n                  \"d-inline-flex gap-2\",\n                  activeTabTitle === title ? \"nav-link active\" : \"nav-link\",\n                ].join(\" \")}\n                href={href(route, { handle, ...(params ?? {}) })}\n              >\n                <span>{title}</span>\n              </a>\n            </li>\n          ) : null\n        )}\n      </NavUnderline>\n    </Header>\n  );\n};\n\nreturn CommunityHeader(props);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/root.akaia.near/widget/gigs-board.entity.community.header", "__row_index": 1}