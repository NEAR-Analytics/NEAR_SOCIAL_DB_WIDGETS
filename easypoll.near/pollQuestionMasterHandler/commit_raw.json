{"tx_hash": "FuQMy2vDyCK5d9HBaZm8D8fVkq17NrthTBidiXJArKhp", "action_id_social": "3HHXLjqnCSFaSELZAZPNNT8EGmD7dWuphp2XZsW9td1x-0-widget", "block_id": 83173168, "block_timestamp": "2023-01-17 17:51:46.521", "signer_id": "easypoll.near", "widget_name": "pollQuestionMasterHandler", "source_code": "let sharedBlockHeight = props.sharedBlockHeight;\n\nconst tabs = {\n  MY_POLLS: { id: 0, text: \"My Polls\" },\n  ALL_EXISTING_POLLS: { id: 1, text: \"All existing polls\" },\n  NEW_POLL: { id: 2, text: \"Create a poll\" },\n};\n\nconst widgetOwner = \"easypoll.near\";\n\nState.init({\n  displaying: tabs.MY_POLLS.id,\n  hoveringElement: \"\",\n  showAbortPollCreation: false,\n  abortThroughAllExistingPolls: false,\n  profile: {},\n});\n\nfunction makeAccountIdShorter(accountId, length) {\n  if (accountId.length > length) {\n    return accountId.slice(0, length) + \"...\";\n  }\n  return accountId;\n}\n\nconst profile = Social.getr(`${context.accountId}/profile`);\n\nif (JSON.stringify(profile) != JSON.stringify(state.profile)) {\n  State.update({ profile: profile });\n}\n\nif (!profile) {\n  return \"Loading...\";\n}\n\nfunction abortPollCreation() {\n  State.update({ showAbortPollCreation: true });\n}\n\nfunction closeModalClickingOnTransparent() {\n  return (e) => {\n    e.target.id == \"modal\" && State.update({ showAbortPollCreation: false });\n  };\n}\n\nconst renderAbortPollCreationModal = () => {\n  return (\n    <div\n      className=\"modal\"\n      id=\"modal\"\n      style={\n        state.showAbortPollCreation && {\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          backgroundColor: \"#7e7e7e70\",\n          backdropFilter: \"blur(4px)\",\n        }\n      }\n      tabindex=\"-1\"\n      role=\"dialog\"\n      onClick={closeModalClickingOnTransparent()}\n    >\n      <div\n        className=\"modal-dialog\"\n        style={{ width: \"540px\", borderRadius: \"28px\" }}\n        role=\"document\"\n      >\n        <div\n          className=\"modal-content\"\n          style={{ border: \"none\", borderRadius: \"28px\" }}\n        >\n          <div\n            className=\"modal-header flex-row-reverse\"\n            style={{ padding: \"0\", margin: \"0\", border: \"none\" }}\n          >\n            <button\n              type=\"button\"\n              className=\"close\"\n              style={{\n                border: \"none\",\n                backgroundColor: \"transparent\",\n                margin: \"0.5rem 0.5rem 0px 0px\",\n                borderRadius: \"28px\",\n                marginRight: \"0.3rem\",\n                padding: \"0.3rem 0.7rem 0 0\",\n              }}\n              dataDismiss=\"modal\"\n              ariaLabel=\"Close\"\n              onClick={() => State.update({ showAbortPollCreation: false })}\n            >\n              <i className=\"bi bi-x-lg\"></i>\n            </button>\n          </div>\n          <div\n            className=\"modal-body\"\n            style={{\n              width: \"90%\",\n              borderRadius: \"1rem\",\n              margin: \"0 auto\",\n              padding: \"0\",\n            }}\n          >\n            <h3\n              style={{\n                fontWeight: \"700\",\n                fontSize: \"1.5rem\",\n                letterSpacing: \"0.1px\",\n                textAlign: \"center\",\n              }}\n            >\n              Discard changes\n            </h3>\n            <p\n              style={{\n                letterSpacing: \"-0.01\",\n                color: \"#4B516A\",\n                fontSize: \"1rem\",\n                textAlign: \"center\",\n              }}\n            >\n              If you leave now, you will lose all your changes\n            </p>\n          </div>\n          <div\n            className=\"modal-footer\"\n            style={{ border: \"none\", justifyContent: \"space-around\" }}\n          >\n            <button\n              type=\"button\"\n              className=\"btn btn-secondary\"\n              data-dismiss=\"modal\"\n              style={{\n                padding: \"0.7rem\",\n                borderRadius: \"16px\",\n                width: \"45%\",\n                backgroundColor: \"white\",\n                border: \"1.5px solid #B0B3BE\",\n                color: \"#010A2D\",\n                fontWeight: \"700\",\n                letterSpacing: \"0.01em\",\n              }}\n              onClick={() => State.update({ showAbortPollCreation: false })}\n            >\n              Continue editing\n            </button>\n            <button\n              type=\"button\"\n              className=\"btn btn-secondary\"\n              data-dismiss=\"modal\"\n              style={{\n                padding: \"0.7rem\",\n                borderRadius: \"16px\",\n                width: \"45%\",\n                backgroundColor: \"#FF4747\",\n                border: \"1.5px solid transparent\",\n                color: \"white\",\n                fontWeight: \"700\",\n                letterSpacing: \"0.01em\",\n              }}\n              onClick={() => {\n                if (state.abortThroughAllExistingPolls) {\n                  State.update({\n                    displaying: tabs.ALL_EXISTING_POLLS.id,\n                    abortThroughAllExistingPolls: false,\n                    hoveringElement: \"\",\n                    showAbortPollCreation: false,\n                  });\n                } else {\n                  State.update({\n                    displaying: tabs.MY_POLLS.id,\n                    hoveringElement: \"\",\n                    showAbortPollCreation: false,\n                  });\n                }\n              }}\n            >\n              Discard changes\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nreturn (\n  <div\n    className=\"pb-5\"\n    style={{\n      backgroundColor: \"rgb(230, 230, 230)\",\n      fontFamily: \"Onest\",\n      fontStyle: \"normal\",\n      borderRadius: \"20px\",\n    }}\n  >\n    <div\n      className=\"d-flex justify-content-between align-items-center px-4 py-3\"\n      style={{\n        backgroundColor: \"white\",\n        boxShadow: \"0px 4px 28px rgba(43, 68, 106, 0.04)\",\n      }}\n    >\n      <div className=\"d-flex align-items-center\">\n        <div\n          className=\"d-flex align-items-center justify-content-center\"\n          style={{\n            backgroundColor: \"#010A2D\",\n            color: \"white\",\n            height: \"100%\",\n            minWidth: \"2.5rem\",\n            aspectRatio: \"1\",\n            borderRadius: \"12px\",\n          }}\n        >\n          <i className=\"bi bi-bar-chart-fill\"></i>\n        </div>\n        <h3\n          style={{\n            margin: \"0 0.5rem\",\n            color: \"#010A2D\",\n            fontWeight: \"700\",\n            fontSize: \"1.3rem\",\n            letterSpacing: \"0.1px\",\n          }}\n        >\n          EasyPoll\n        </h3>\n      </div>\n\n      <div\n        className=\"w-100 d-flex justify-content-between\"\n        style={{ margin: \"0 4rem\" }}\n      >\n        <div style={{ marginTop: \"0.6rem\" }}>\n          <div className=\"d-flex\">\n            {Object.keys(tabs).map((tabKey) => {\n              const tab = tabs[tabKey];\n              if (tabKey != \"NEW_POLL\") {\n                return (\n                  <div\n                    style={{\n                      marginRight: \"1.5rem\",\n                      position: \"relative\",\n                      cursor: \"pointer\",\n                      userSelect: \"none\",\n                    }}\n                  >\n                    <p\n                      ariaCurrent=\"page\"\n                      onMouseEnter={() => {\n                        State.update({ hoveringElement: tab.id });\n                      }}\n                      onMouseLeave={() => {\n                        State.update({ hoveringElement: \"\" });\n                      }}\n                      onClick={() => {\n                        state.displaying != tabs.NEW_POLL.id\n                          ? State.update({ displaying: tab.id })\n                          : tab.id == tabs.ALL_EXISTING_POLLS.id\n                          ? State.update({\n                              showAbortPollCreation: true,\n                              abortThroughAllExistingPolls: true,\n                            })\n                          : State.update({ showAbortPollCreation: true });\n                      }}\n                      style={{\n                        fontWeight: \"500\",\n                        fontSize: \"1rem\",\n                        margin: \"0\",\n                      }}\n                    >\n                      {tab.text}\n                    </p>\n                    {(state.hoveringElement == tab.id ||\n                      state.displaying == tab.id) && (\n                      <div\n                        style={{\n                          height: \"0.2rem\",\n                          width: \"50%\",\n                          position: \"absolute\",\n                          bottom: \"-55%\",\n                          left: \"25%\",\n                          backgroundColor: \"#010A2D\",\n                          borderRadius: \"8px\",\n                        }}\n                      >\n                        {/*Decorative Div, do not delete*/}\n                      </div>\n                    )}\n                  </div>\n                );\n              }\n            })}\n          </div>\n        </div>\n\n        <div className=\"d-flex\">\n          <button\n            onMouseEnter={() => {\n              State.update({ hoveringElement: tabs.NEW_POLL.id });\n            }}\n            onMouseLeave={() => {\n              State.update({ hoveringElement: \"\" });\n            }}\n            onClick={() => {\n              State.update({ displaying: tabs.NEW_POLL.id });\n            }}\n            style={\n              state.hoveringElement == tabs.NEW_POLL.id ||\n              state.displaying == tabs.NEW_POLL.id\n                ? {\n                    border: \"2px solid black\",\n                    color: \"black\",\n                    backgroundColor: \"white\",\n                    fontWeight: \"500\",\n                    fontSize: \"1rem\",\n                    margin: \"0\",\n                    padding: \"0.3rem 1.5rem\",\n                    borderRadius: \"12px\",\n                  }\n                : {\n                    border: \"2px solid transparent\",\n                    fontWeight: \"500\",\n                    fontSize: \"1rem\",\n                    margin: \"0\",\n                    padding: \"0.3rem 1.5rem\",\n                    backgroundColor: \"#010A2D\",\n                    borderRadius: \"12px\",\n                    color: \"white\",\n                  }\n            }\n          >\n            <i\n              className=\"bi bi-plus-lg\"\n              style={\n                state.hoveringElement == tabs.NEW_POLL.id ||\n                state.displaying == tabs.NEW_POLL.id\n                  ? { color: \"black\" }\n                  : { color: \"white\" }\n              }\n            ></i>\n            {tabs.NEW_POLL.text}\n          </button>\n        </div>\n      </div>\n      <div className=\"p-2\">\n        <div>\n          <p style={{ margin: \"0\", fontSize: \"0.8rem\" }}>\n            {makeAccountIdShorter(state.profile.name, 12)}\n          </p>\n          <p style={{ margin: \"0\", fontSize: \"0.8rem\" }}>\n            @{makeAccountIdShorter(context.accountId, 12)}\n          </p>\n        </div>\n      </div>\n    </div>\n\n    {state.displaying == tabs.ALL_EXISTING_POLLS.id ? (\n      <div className=\"px-4\">\n        <h2 style={{ margin: \"2rem 0 0.5rem 0\", fontWeight: \"700\" }}>\n          All existing polls\n        </h2>\n        <Widget\n          src={`${widgetOwner}/widget/showQuestionsHandler`}\n          props={{ sharedBlockHeight }}\n        />\n      </div>\n    ) : state.displaying == tabs.MY_POLLS.id ? (\n      <div className=\"px-4\">\n        <h2 style={{ margin: \"2rem 0 0.5rem 0\", fontWeight: \"700\" }}>\n          My Polls\n        </h2>\n        <Widget\n          src={`${widgetOwner}/widget/showQuestionsHandler`}\n          props={{ sharedBlockHeight, onlyUser: true }}\n        />\n      </div>\n    ) : (\n      state.displaying == tabs.NEW_POLL.id && (\n        <div\n          className=\"px-4\"\n          style={{\n            backgroundColor: \"white\",\n            borderRadius: \"28px\",\n            margin: \"2rem auto 0 auto\",\n            width: \"60%\",\n          }}\n        >\n          <div style={{ position: \"relative\" }}>\n            <i\n              className=\"bi bi-x-lg\"\n              style={{\n                position: \"absolute\",\n                right: \"2rem\",\n                top: \"2rem\",\n                cursor: \"pointer\",\n              }}\n              onClick={abortPollCreation}\n            ></i>\n            <h2\n              style={{\n                padding: \"2rem\",\n                margin: \"2rem 0 0.5rem 0\",\n                fontWeight: \"700\",\n              }}\n            >\n              Create a poll\n            </h2>\n          </div>\n          <Widget src={`${widgetOwner}/widget/newPollQuestionInterface`} />\n          <button\n            onMouseEnter={() => {\n              State.update({ hoveringElement: \"cancelNewPoll\" });\n            }}\n            onMouseLeave={() => {\n              State.update({ hoveringElement: \"\" });\n            }}\n            onClick={abortPollCreation}\n            style={\n              state.hoveringElement == \"cancelNewPoll\"\n                ? {\n                    border: \"2px solid transparent\",\n                    fontWeight: \"500\",\n                    fontSize: \"1rem\",\n                    padding: \"0.3rem 1.5rem\",\n                    backgroundColor: \"#010A2D\",\n                    borderRadius: \"12px\",\n                    color: \"white\",\n                    transform: \"translateY(-2.3rem)\",\n                  }\n                : {\n                    border: \"2px solid black\",\n                    color: \"black\",\n                    backgroundColor: \"white\",\n                    fontWeight: \"500\",\n                    fontSize: \"1rem\",\n                    padding: \"0.3rem 1.5rem\",\n                    borderRadius: \"12px\",\n                    transform: \"translateY(-2.3rem)\",\n                  }\n            }\n          >\n            Cancel\n          </button>\n        </div>\n      )\n    )}\n    {state.showAbortPollCreation && renderAbortPollCreationModal()}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/easypoll.near/widget/pollQuestionMasterHandler"}