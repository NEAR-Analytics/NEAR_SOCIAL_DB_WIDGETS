{"tx_hash": "2sonJA11Pb2kjdhaxAViLXxcSms2yea9QNr4gNL9VxNk", "action_id_social": "92f9iyaMGUMMXSNXuYdh6VXysXU968iNa17Rrhvsc8T2-0-widget", "block_id": 84130334, "block_timestamp": "2023-01-30 12:33:04.675", "signer_id": "events_v1.near", "widget_name": "events__components__event_image_slider", "source_code": "let event = props.event || null;\n\nif (!state) {\n  State.init({ index: 0 });\n}\n\nif (!event) {\n  // TODO: return default image\n  return <img src=\"\" alt=\"Event!\" />;\n}\n\nconst mode = props.mode || 'banner';\n\nconst imagesWithCid = (event.images || [])\n  .filter((image) => {\n    return image.url && image.url.cid;\n  })\n  .filter((image) => {\n    return image.url.cid.length > 0;\n  });\n\nconst displayImages = imagesWithCid.filter((image) => {\n  return image.type === mode;\n});\n\n// HACK: this is a hack to get regular update calls\nconst data = `\n\nif(!state){\n  State.init({ index: 0 });\n  return ''\n}\n\nfetch('https://api.coingecko.com/api/v3/coins/near', {\n  subscribe: true,\n  method: 'GET',\n  headers: {\n    Accept: '*/*',\n  },\n});\n\nconst index = Storage.get('index') || 0;\nif(Storage.get('index') < 50){\n  console.log(\"index\", index)\n  Storage.set('index', Storage.get('index') + 1);\n  return ''\n}\n\nprops.onUpdate()\nStorage.set('index', 0)\n\nreturn ''\n`;\n\nreturn (\n  <div\n    style={{\n      width: '100%',\n      height: '100%',\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      maxWidth: '100%',\n      overflow: 'hidden',\n      userSelect: 'none',\n    }}\n  >\n    {displayImages.length > 1 ? (\n      <Widget\n        code={data}\n        props={{\n          onUpdate: () => {\n            State.update({ index: (state.index + 1) % displayImages.length });\n          },\n        }}\n      />\n    ) : null}\n\n    {displayImages.map((_, i) => {\n      const image = displayImages[(i + state.index) % displayImages.length];\n\n      return (\n        <img\n          src={`https://ipfs.near.social/ipfs/${image.url.cid}`}\n          key={image.cid}\n          alt={image.url.cid}\n          style={{\n            width: '100%',\n            height: '100%',\n            maxWidth: '100%',\n            boxSizing: 'border-box',\n            objectFit: 'cover',\n            transform: `translateX(-${\n              (state.index * 100) / displayImages.length\n            }%)`,\n            transition: 'transform 0.5s',\n          }}\n        />\n      );\n    })}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/events_v1.near/widget/events__components__event_image_slider"}