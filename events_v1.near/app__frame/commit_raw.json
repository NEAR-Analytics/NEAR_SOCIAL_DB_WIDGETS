{"tx_hash": "BzXo1mQLf6qrkKQiwubC8xdRxcv88ybEHvhBptDSocT4", "action_id_social": "EALqoPFFdq2BgdhddLJuLKMro4a3GxatBvtWi5hdcZdY-0-widget", "block_id": 83780797, "block_timestamp": "2023-01-25 18:46:27.813", "signer_id": "events_v1.near", "widget_name": "app__frame", "source_code": "const VERSION = '0.0.1';\n\nconst APP_OWNER = 'events_v1.near';\nconst APP_NAME = 'events_app';\nconst ENTRY_ROUTE = 'index';\n\nconst accountId = context.accountId;\nif (!accountId) {\n  return 'Please connect your NEAR wallet to create an activity';\n}\n\nconst env = {\n  APP_OWNER,\n  APP_NAME,\n};\n\n// TODO: get layers from URL\nState.init({\n  env,\n  layers: [\n    {\n      name: ENTRY_ROUTE,\n      props: {},\n    },\n  ],\n});\n\nconst Loading = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  width: 100%;\n`;\n\nif (!state) {\n  return 'Loading...';\n}\n\nfunction slugFromName(name) {\n  return name.split(/\\.|\\//gu).join('__');\n}\n\nfunction layoutFromName(name) {\n  return `${APP_OWNER}/widget/app__layouts__${slugFromName(name)}`;\n}\n\nconst Select = styled.select`\n  background-color: #4caf50;\n  border: none;\n  color: white;\n  padding: 15px 32px;\n  text-align: center;\n  text-decoration: none;\n  display: inline-block;\n  font-size: 16px;\n  margin: 4px 2px;\n  cursor: pointer;\n`;\n\nconst Button = styled.button`\n  background-color: #4caf50;\n  border: none;\n  color: white;\n  padding: 15px 32px;\n  text-align: center;\n  text-decoration: none;\n  display: inline-block;\n  font-size: 16px;\n  transition: all 0.5s ease;\n\n  &:hover {\n    background-color: #3e8e41;\n  }\n`;\n\nconst Components = {\n  Select,\n  Button,\n  Loading,\n};\n\nconst currentRoute = state.layers[state.layers.length - 1];\n\nconst engine = {\n  renderComponent,\n};\n\nfunction push(name, props) {\n  State.update({\n    layers: [\n      ...state.layers,\n      {\n        name,\n        props: props || {},\n      },\n    ],\n  });\n}\n\n// pop from the stack, ensure we always have at least one layer\nfunction pop() {\n  State.update({\n    layers: state.layers.length > 1 ? state.layers.slice(0, -1) : state.layers,\n  });\n}\n\nconst routing = {\n  push,\n  pop,\n  currentRoute,\n};\n\n// TODO: layouting, render widgets in widgets for maximum awesomeness\nfunction renderComponent(name, props) {\n  const layout = props.layout || 'default';\n  const componentProps = {\n    ...props,\n    routing,\n    engine,\n    Components,\n    accountId,\n    env,\n    VERSION,\n  };\n\n  return (\n    <Widget\n      src={layoutFromName(layout)}\n      props={{\n        ...componentProps,\n        component: {\n          src: `${APP_OWNER}/widget/${APP_NAME}__${slugFromName(name)}`,\n          props: componentProps,\n        },\n      }}\n    />\n  );\n}\n\nreturn (\n  <>\n    {/* main widget */}\n    {state.layers.map((layer, index) => {\n      return (\n        <div\n          key={index}\n          style={{\n            width: '100%',\n            height: '100%',\n            position: 'fixed',\n            backgroundColor: 'white',\n            top: 72, // sit right below the navbar\n            left: 0,\n            right: 0,\n            bottom: 0,\n            padding: 0,\n            zIndex: Math.pow(10, 1 + index) + 10000,\n            overflow: 'auto',\n          }}\n        >\n          {renderComponent(layer.name, layer.props)}\n        </div>\n      );\n    })}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/events_v1.near/widget/app__frame"}