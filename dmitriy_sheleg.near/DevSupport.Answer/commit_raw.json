{"tx_hash": "6AX8pBq4xD9FwbyvGEaEpLMNU3diWDnSiGaMfkjfugjM", "action_id_social": "HYKQbD58Luq6AbtkU94fEs2zWgz59MWKvxMk7WKbTZbg-0-widget", "block_id": 88462546, "block_timestamp": "2023-03-30 21:27:16.567", "signer_id": "dmitriy_sheleg.near", "widget_name": "DevSupport.Answer", "source_code": "const accountId = props.accountId;\nconst blockHeight =\n  props.blockHeight === \"now\" ? \"now\" : parseInt(props.blockHeight);\nconst subscribe = !!props.subscribe;\nconst admins = props.admins || [];\nconst adminContract = props.adminContract;\n\nif (accountId === undefined || blockHeight === undefined) {\n  return;\n}\n\nState.init({ showAnswer: false, showOverlay: false });\n\nconst answer = JSON.parse(\n  Social.get(`${accountId}/question/answer`, blockHeight) ?? \"null\"\n);\n\nconst is_useful = Near.view(adminContract, \"is_useful\", {\n  id: { account_id: accountId, block_height: blockHeight },\n});\nconst border = is_useful ? \"border-success\" : \"border-black\";\n\nconst item = {\n  type: \"social\",\n  path: `${accountId}/question/main`,\n  blockHeight,\n};\n\nconst handleOnMouseEnter = () => {\n  State.update({ showOverlay: true });\n};\nconst handleOnMouseLeave = () => {\n  State.update({ showOverlay: false });\n};\nconst handleValidAnswerClick = () => {\n  Near.call(adminContract, \"mark_useful\", {\n    id: { account_id: accountId, block_height: blockHeight },\n    amount: \"1\",\n  });\n};\n\nconst Post = styled.div`\n  position: relative;\n\n  &::before {\n    content: \"\";\n    display: block;\n    position: absolute;\n    left: 19px;\n    top: 52px;\n    bottom: 12px;\n    width: 2px;\n    background: #eceef0;\n  }\n`;\nconst Header = styled.div`\n  margin-bottom: 0;\n  display: inline-flex;\n`;\nconst Body = styled.div`\n  padding-left: 52px;\n  padding-bottom: 1px;\n`;\nconst Content = styled.div`\n  img {\n    display: block;\n    max-width: 100%;\n    max-height: 80vh;\n    margin: 0 0 12px;\n  }\n`;\nconst Text = styled.p`\n  display: block;\n  margin: 0;\n  font-size: 14px;\n  line-height: 20px;\n  font-weight: 400;\n  color: #687076;\n  white-space: nowrap;\n`;\nconst Actions = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin: -6px -6px 6px;\n`;\n\nconst Comments = styled.div`\n  > div > div:first-child {\n    padding-top: 12px;\n  }\n`;\nconst Item = styled.div`\n  .btn {\n\n    &:hover,\n    &:focus {\n      background-color: #ECEDEE;\n      text-decoration: none;\n      outline: none;\n    }\n    i {\n      color: #30A46C;\n    }\n    span {\n      font-weight: 500;\n    }\n  }\n`;\n\nconst overlay = (\n  <div\n    className=\"border m-3 p-3 rounded-4 bg-white shadow\"\n    style={{ maxWidth: \"24em\", zIndex: 1070 }}\n    onMouseEnter={handleOnMouseEnter}\n    onMouseLeave={handleOnMouseLeave}\n  >\n    <Item>\n      <Widget\n        src=\"dmitriy_sheleg.near/widget/DevSupport.Answer.Button.Valid\"\n        props={{\n          accountId,\n          blockHeight,\n          admins,\n          adminContract,\n          onClick: handleValidAnswerClick,\n          text: \"Mark as Correct\",\n          className: \"btn\",\n        }}\n      />\n    </Item>\n  </div>\n);\n\nreturn (\n  <Post>\n    <Header>\n      <Widget\n        src=\"dmitriy_sheleg.near/widget/AccountProfile\"\n        props={{\n          accountId,\n          inlineContent: (\n            <div class=\"d-flex align-items-center flex-fill\">\n              <Text as=\"span\">\uff65</Text>\n              <Text>\n                {blockHeight === \"now\" ? (\n                  \"now\"\n                ) : (\n                  <>\n                    <Widget\n                      src=\"mob.near/widget/TimeAgo\"\n                      props={{ blockHeight }}\n                    />{\" \"}\n                    ago\n                  </>\n                )}\n              </Text>\n              <OverlayTrigger\n                show={state.showOverlay}\n                trigger={[\"hover\", \"focus\"]}\n                delay={{ show: 250, hide: 300 }}\n                placement=\"auto\"\n                overlay={overlay}\n              >\n                <span\n                  className=\"ms-auto\"\n                  onMouseEnter={handleOnMouseEnter}\n                  onMouseLeave={handleOnMouseLeave}\n                >\n                  <i class=\"bi bi-three-dots\" />\n                </span>\n              </OverlayTrigger>\n            </div>\n          ),\n        }}\n      />\n    </Header>\n    <Body>\n      <Content>\n        {answer.text && (\n          <Widget\n            src=\"adminalpha.near/widget/SocialMarkdown\"\n            props={{ text: answer.text }}\n          />\n        )}\n\n        {answer.image && (\n          <Widget\n            src=\"mob.near/widget/Image\"\n            props={{\n              image: answer.image,\n            }}\n          />\n        )}\n      </Content>\n\n      {blockHeight !== \"now\" && (\n        <Actions>\n          <Widget\n            src=\"adminalpha.near/widget/LikeButton\"\n            props={{\n              item,\n              accountId,\n            }}\n          />\n          <Widget\n            src=\"adminalpha.near/widget/CommentButton\"\n            props={{\n              item,\n              onClick: () => State.update({ showReply: !state.showReply }),\n            }}\n          />\n        </Actions>\n      )}\n\n      {state.showReply && (\n        <div className=\"mb-2\">\n          <Widget\n            src=\"dmitriy_sheleg.near/widget/DevSupport.Answer.Edit\"\n            props={{\n              notifyAccountId: accountId,\n              item,\n              onComment: () => State.update({ showReply: false }),\n            }}\n          />\n        </div>\n      )}\n\n      <Comments>\n        <Widget\n          src=\"dmitriy_sheleg.near/widget/DevSupport.Answer.Feed\"\n          props={{ item, admins, adminContract, nested: true }}\n        />\n      </Comments>\n    </Body>\n  </Post>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/dmitriy_sheleg.near/widget/DevSupport.Answer"}