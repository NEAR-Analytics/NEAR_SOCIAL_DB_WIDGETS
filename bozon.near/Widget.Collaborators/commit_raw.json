{"tx_hash": "K9v1FL3dw8SSxD1owTJP34oTbTcqfnoDMmGi4rKmq5T", "action_id_social": "betrsgfQZimHWDFrUNHM46mALDPcbkAZ91LoaTSTbW2-0-widget", "block_id": 85946029, "block_timestamp": "2023-02-24 14:48:01.794", "signer_id": "bozon.near", "widget_name": "Widget.Collaborators", "source_code": "/*props\r\n\r\nwidgetPath: string\r\ncount(number)?: function\r\n\r\n*/\r\n\r\nif (!props.widgetPath) return \"send {widgetPath: string} in props\";\r\n\r\nconst SOCIAL_CONTRACT = \"social.near\";\r\n\r\nconst [widgetAccountId, _, widget] = props.widgetPath.split(\"/\");\r\n\r\n//to_vec overflow rust contract\r\nconst accountsGrantedPermissions = Near.view(\r\n  SOCIAL_CONTRACT,\r\n  \"debug_get_permissions\",\r\n  { account_id: widgetAccountId }\r\n);\r\n\r\nconst widgetwithNodeId = Near.view(SOCIAL_CONTRACT, \"get\", {\r\n  keys: [props.widgetPath],\r\n  options: { with_node_id: true },\r\n});\r\n\r\nconst nodeIds = [\r\n  widgetwithNodeId[\":node\"],\r\n  widgetwithNodeId[widgetAccountId][\":node\"],\r\n  widgetwithNodeId[widgetAccountId][\"widget\"][\":node\"],\r\n  widgetwithNodeId[widgetAccountId][\"widget\"][widget][\":node\"],\r\n];\r\n\r\nconst filtered = accountsGrantedPermissions.filter((el) => {\r\n  return el[1].Granted.find((el) => nodeIds.includes(el));\r\n});\r\n\r\nif (props.count) props.count(filtered.length);\r\n\r\nreturn (\r\n  <div>\r\n    {filtered.map((el) => (\r\n      <div>{el[0].AccountId || el[0].SignerPublicKey}</div>\r\n    ))}\r\n  </div>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/bozon.near/widget/Widget.Collaborators"}