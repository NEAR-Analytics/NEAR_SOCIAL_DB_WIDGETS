{"tx_hash": "DVMmHGfhqjSHak7MD7jaGEahMKoNrTJAj9DhbiqjPHtb", "action_id_social": "GZvMJQsa5P6rKjwh5JcsfwFmnpeL88PJ6RESv8MyD4AG-0-widget", "block_id": 82409532, "block_timestamp": "2023-01-07 13:54:00.225", "signer_id": "silkking.near", "widget_name": "minimalistQuestionGeneralInfo", "source_code": "let poll = props;\n\nlet dateFormatOptions = {\n  month: \"short\",\n  day: \"numeric\",\n  year: \"numeric\",\n  hour: \"numeric\",\n  minute: \"numeric\",\n  hour12: \"false\",\n};\n\nif (!poll) {\n  return \"Prop passed wrongly to minimalistQuestionHeader\";\n}\n\nfunction makeAccountIdShorter(accountId) {\n  if (accountId.length > 12) {\n    return accountId.slice(0, 12) + \"...\";\n  }\n  return accountId;\n}\n\nState.init({\n  answers: {},\n});\n\nfunction getValidAnswersQtyFromQuestion() {\n  let questionBlockHeight = poll.blockHeight;\n\n  const answers = Social.index(\"poll_question\", \"answer-v3.1.0\");\n\n  if (JSON.stringify(answers) != JSON.stringify(state.answers)) {\n    State.update({ answers: answers });\n  }\n  if (!answers) {\n    return \"Loading...\";\n  }\n  const answersFromThisPoll = state.answers.filter(\n    (a) => a.value.questionBlockHeight == questionBlockHeight\n  );\n  const usersWithAnswers = answersFromThisPoll.map((a) => a.accountId);\n  const usersWithAnswersWithoutDuplicates = usersWithAnswers.filter(\n    (u, index) => usersWithAnswers.indexOf(u) == index\n  );\n  return usersWithAnswersWithoutDuplicates.length;\n}\n\nfunction isActive() {\n  return (\n    poll.value.startTimestamp < Date.now() &&\n    Date.now() < poll.value.endTimestamp\n  );\n}\n\nfunction isUpcoming() {\n  return poll.value.startTimestamp > Date.now();\n}\n\nreturn (\n  <div className=\"mt-2 pt-2\">\n    <div\n      className=\"d-flex justify-content-around\"\n      style={{\n        border: \"1.5px solid #F2F6FA\",\n        borderRadius: \"16px\",\n      }}\n    >\n      <div className=\"px-2 my-2\">\n        <p style={{ margin: \"0\" }}>Created by</p>\n        <p\n          style={{\n            fontWeight: \"600\",\n            color: \"#4B516A\",\n            margin: \"0\",\n          }}\n        >\n          {makeAccountIdShorter(poll.accountId)}\n        </p>\n      </div>\n\n      <div\n        className=\"px-2 my-2\"\n        style={{\n          borderLeft: \"1.5px solid #F2F6FA\",\n          borderRight: \"1.5px solid #F2F6FA\",\n        }}\n      >\n        {Date.now() > poll.value.startTimestamp ? (\n          <p style={{ margin: \"0\" }}>Started</p>\n        ) : (\n          <p style={{ margin: \"0\" }}>Start</p>\n        )}\n        <p\n          style={{\n            fontWeight: \"600\",\n            color: \"#4B516A\",\n            margin: \"0\",\n          }}\n        >\n          {new Date(poll.value.startTimestamp).toLocaleDateString(\n            [],\n            dateFormatOptions\n          )}\n        </p>\n      </div>\n\n      <div className=\"px-2 my-2\">\n        {Date.now() > poll.value.endTimestamp ? (\n          <p style={{ margin: \"0\" }}>Ended</p>\n        ) : (\n          <p style={{ margin: \"0\" }}>Ends</p>\n        )}\n        <p\n          style={{\n            fontWeight: \"600\",\n            letterSpacing: \"-0.1em\",\n            color: \"#4B516A\",\n            margin: \"0\",\n          }}\n        >\n          {new Date(poll.value.endTimestamp).toLocaleDateString(\n            [],\n            dateFormatOptions\n          )}\n        </p>\n      </div>\n    </div>\n    <div className=\"d-flex justify-content-between mt-3\">\n      <div className=\"d-flex\">\n        <i className=\"bi bi-people\" style={{ marginRight: \"0.3rem\" }}></i>\n        <span>{getValidAnswersQtyFromQuestion(poll.blockHeight)} votes</span>\n      </div>\n      <span\n        style={{\n          backgroundColor: isUpcoming()\n            ? \"#FFF3B4\"\n            : isActive()\n            ? \"#D9FCEF\"\n            : \"#FFE5E5\",\n\n          height: \"1.5rem\",\n          width: \"4rem\",\n          textAlign: \"center\",\n          borderRadius: \"16px\",\n          marginRight: \"1rem\",\n          lineHeight: \"1.5rem\",\n          fontSize: \"0.8rem\",\n          letterSpacing: \"-0.025rem\",\n          color: isUpcoming() ? \"#FFC905\" : isActive() ? \"#00B37D\" : \"#FF4747\",\n          fontWeight: \"500\",\n        }}\n      >\n        {isUpcoming() ? \"Upcoming\" : isActive() ? \"Active\" : \"Closed\"}\n      </span>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/silkking.near/widget/minimalistQuestionGeneralInfo"}