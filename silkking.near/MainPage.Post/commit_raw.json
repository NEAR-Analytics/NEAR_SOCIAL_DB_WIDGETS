{"tx_hash": "7p9CBaPTuc4YvpsRAvHaUEfeSPsU8ozTMYqwKoBqGeop", "action_id_social": "H7dzxNUc2zXMqtRP4VqbvhvZMjt8h9PSncDpqygG9u4C-0-widget", "block_id": 87520565, "block_timestamp": "2023-03-17 20:52:14.007", "signer_id": "silkking.near", "widget_name": "MainPage.Post", "source_code": "const content = props.content;\r\nconst accountId = content.accountId;\r\nconst blockHeight = parseInt(content.blockHeight);\r\n\r\nState.init({\r\n  displayCommentBox: false,\r\n  answer: \"\",\r\n});\r\n\r\nconst notifyAccountId = accountId;\r\nconst item = {\r\n  type: \"social\",\r\n  path: `${accountId}/post/main`,\r\n  blockHeight,\r\n};\r\n\r\nconst link = `#/mob.near/widget/MainPage.Post.Page?accountId=${accountId}&blockHeight=${blockHeight}`;\r\n\r\nconst card = {\r\n  background: \"linear-gradient(to right, #4deeea, #f000ff)\",\r\n  border: \"1px solid black\",\r\n  borderRadius: \"5px\",\r\n  textAlign: \"center\",\r\n  color: \"white\",\r\n  padding: \"10px\",\r\n};\r\n\r\nconst cardContent = {\r\n  display: \"grid\",\r\n  gridTemplateColumns: \"3fr 1fr 1fr\",\r\n};\r\n\r\nconst headerStyles = {\r\n  display: \"flex\",\r\n  justifyContent: \"center\",\r\n};\r\n\r\nconst startCommentTo = () => {\r\n  State.update({ displayCommentBox: true });\r\n};\r\n\r\nconst RenderCommentInput = (blockHeight) => {\r\n  return state.displayCommentBox ? (\r\n    <div\r\n      style={{\r\n        margin: \"10px 0px\",\r\n      }}\r\n    >\r\n      <textarea\r\n        style={{\r\n          backgroundColor: \"rgb(230, 230, 230)\",\r\n          border: \"1px solid #ced4da\",\r\n          borderRadius: \"0.375rem\",\r\n          width: \"50%\",\r\n          verticalAlign: \"middle\",\r\n        }}\r\n        rows=\"2\"\r\n        value={state.commentTextMap[blockHeight]}\r\n        onChange={(e) => {\r\n          State.update({ answer: e.target.value });\r\n        }}\r\n      />\r\n      <CommitButton\r\n        style={button}\r\n        data={{\r\n          index: {\r\n            kudo: JSON.stringify(\r\n              {\r\n                key: \"commentAnswers\",\r\n                value: {\r\n                  commentAnswer: state.answer,\r\n                  blockHeight,\r\n                },\r\n              },\r\n              undefined,\r\n              0\r\n            ),\r\n          },\r\n        }}\r\n        onCommit={() => {\r\n          let ctm = state.commentTextMap;\r\n          ctm[blockHeight] = \"\";\r\n          State.update({\r\n            commentTextMap: ctm,\r\n            reloadData: true,\r\n          });\r\n        }}\r\n      >\r\n        Comment\r\n      </CommitButton>\r\n    </div>\r\n  ) : (\r\n    \"\"\r\n  );\r\n};\r\n\r\n/* START KudoBox */\r\nconst RenderKudoBox = (d) => {\r\n  const text = `From @${d.accountId} Kudos ${d.value.answer} `;\r\n  const content = { text };\r\n  return (\r\n    <>\r\n      <div style={card}>\r\n        <div style={headerStyles}>\r\n          <Widget\r\n            src=\"mob.near/widget/MainPage.Post.Header\"\r\n            props={{\r\n              accountId,\r\n              blockHeight,\r\n              link,\r\n              postType: \"post\",\r\n              flagItem: item,\r\n            }}\r\n          />\r\n          <Widget\r\n            src=\"mob.near/widget/FollowButton\"\r\n            props={{ accountId: d.accountId }}\r\n          />\r\n        </div>\r\n        <div className=\"mt-3 text-break\" style={cardContent}>\r\n          <Widget\r\n            src=\"mob.near/widget/MainPage.Post.Content\"\r\n            props={{ content, raw }}\r\n          />\r\n          <a href={`${urlPrefix}${d.value.url}`} target=\"_blank\">\r\n            {d.value.url}\r\n          </a>\r\n          <div>\r\n            <Widget\r\n              src=\"mob.near/widget/CommentButton\"\r\n              props={{\r\n                onClick: startCommentTo,\r\n              }}\r\n            />\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <CommitButton\r\n            data={{\r\n              index: {\r\n                kudo: JSON.stringify(\r\n                  {\r\n                    key: \"upvote\",\r\n                    value: {\r\n                      blockHeight: d.blockHeight,\r\n                    },\r\n                  },\r\n                  undefined,\r\n                  0\r\n                ),\r\n              },\r\n            }}\r\n          >\r\n            Upvote\r\n          </CommitButton>\r\n          <span>\r\n            {d.value.upvotes} {d.value.upvotes == 1 ? \"upvote\" : \"upvotes\"}\r\n          </span>\r\n        </div>\r\n        {RenderCommentInput(Number(d.blockHeight))}\r\n      </div>\r\n\r\n      {\r\n        //RenderAllCommentAnswerBox(d)\r\n      }\r\n    </>\r\n  );\r\n};\r\n/* END KudoBox  */\r\n\r\nreturn <>{RenderKudoBox(props.content)}</>;\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/silkking.near/widget/MainPage.Post"}