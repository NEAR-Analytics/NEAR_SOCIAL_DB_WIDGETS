{"tx_hash": "4RsNeZgnGJmYJoKEeGFAJwToVir5RnJFjqGJQSoHz3Ui", "action_id_social": "F4Tzr9zw7nFYF7fjRzTPizGoBGbrmjieEYiev33pAv1G-0-widget", "block_id": 85749239, "block_timestamp": "2023-02-21 22:38:18.014", "signer_id": "calebjacob.near", "widget_name": "LatestNews", "source_code": "const accountId = \"near\";\nconst limit = 3;\nlet posts = [];\n\nconst indexedPosts = Social.index(\"post\", \"main\", {\n  accountId,\n  limit: 20,\n  order: \"desc\",\n});\n\nif (indexedPosts?.length > 0) {\n  posts = [];\n\n  indexedPosts.forEach((post) => {\n    const data = Social.get(`${post.accountId}/post/main`, post.blockHeight);\n\n    if (data) {\n      const json = JSON.parse(data);\n      const content = json.text.split(\"\\n\");\n      const title = content[0];\n      const url = content[1];\n      const lastLine = content.pop() || \"\";\n      const hasNewsTag = lastLine.indexOf(\"#news\") > -1;\n      const isValid = hasNewsTag && !!url && url.indexOf(\"https://\") > -1;\n\n      if (isValid) {\n        posts.push({\n          blockHeight: post.blockHeight,\n          title,\n          url,\n        });\n\n        posts.sort((a, b) => b.blockHeight - a.blockHeight);\n      }\n    }\n  });\n\n  posts = posts.slice(0, limit);\n}\n\nconst Wrapper = styled.div`\n  display: grid;\n  gap: 24px;\n`;\n\nconst H2 = styled.h2`\n  font-size: 19px;\n  line-height: 22px;\n  color: #11181C;\n  margin: 0;\n`;\n\nconst Items = styled.ul`\n  list-style: disc;\n  padding-left: 16px;\n  margin: 0;\n  color: #687076;\n`;\n\nconst Item = styled.li`\n  width: 100%;\n  margin-bottom: 12px;\n\n  &:last-child {\n    margin-bottom: 0;\n  }\n\n  > * {\n    min-width: 0\n  }\n`;\n\nconst Text = styled.span`\n  display: block;\n  margin: 0;\n  font-size: 14px;\n  line-height: 20px;\n  color: ${(p) => (p.bold ? \"#11181C\" : \"#687076\")} !important;\n  font-weight: ${(p) => (p.bold ? \"600\" : \"400\")};\n  font-size: ${(p) => (p.small ? \"12px\" : \"14px\")};\n\n  &[href] {\n    &:hover,\n    &:focus {\n      outline: none;\n      text-decoration: underline;\n    }\n  }\n`;\n\nconst ButtonLink = styled.a`\n  display: block;\n  width: 100%;\n  padding: 8px;\n  height: 32px;\n  background: #FBFCFD;\n  border: 1px solid #D7DBDF;\n  border-radius: 6px;\n  font-weight: 600;\n  font-size: 12px;\n  line-height: 15px;\n  text-align: center;\n  cursor: pointer;\n  color: #11181C !important;\n  margin: 0;\n\n  &:hover,\n  &:focus {\n    background: #ECEDEE;\n    text-decoration: none;\n    outline: none;\n  }\n`;\n\nreturn (\n  <Wrapper>\n    <H2>News</H2>\n\n    {indexedPosts !== null && posts.length === 0 ? (\n      <Text>No recent news at the moment. Check back soon!</Text>\n    ) : (\n      <Items>\n        {posts.map((item, i) => (\n          <Item key={i}>\n            <Text as=\"a\" href={item.url} target=\"_blank\" bold>\n              {item.title}\n            </Text>\n            <Text small>\n              <Widget\n                src=\"mob.near/widget/TimeAgo\"\n                props={{ blockHeight: item.blockHeight }}\n              />{\" \"}\n              ago\n            </Text>\n          </Item>\n        ))}\n      </Items>\n    )}\n\n    <ButtonLink href=\"https://near.org/blog/\" target=\"_blank\">\n      View All News\n    </ButtonLink>\n  </Wrapper>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/calebjacob.near/widget/LatestNews"}