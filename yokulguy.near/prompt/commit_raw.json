{"tx_hash": "3gJ9ForxqMpSn8eWQwx86gMC4sHCeum6ULVmKFjNCXbw", "action_id_social": "8sbA8mfBa9r5kcTtPuENWu9cNCDFuFQzJnzbVGjn4kpV-0-widget", "block_id": 95027832, "block_timestamp": "2023-06-25T22:04:12.639Z", "signer_id": "yokulguy.near", "widget_name": "prompt", "source_code": "const getRandomInt = (max) => {\n  return Math.floor(Math.random() * max);\n};\nconst getPrompt = (page, cb) =>\n  asyncFetch(\n    `https://alpha.tryhologram.art/api/prompt/pagination?page=${page}`\n  ).then(cb);\n\nconst initialPage = getRandomInt(10);\nconst lastPage = initialPage + 10;\nconst sender = Ethers.send(\"eth_requestAccounts\", [])[0];\n\nState.init({\n  contents: [],\n  currentPage: initialPage,\n  lastPage: lastPage,\n  isLoading: true,\n});\n\nconst loadMore = () => {\n  State.update({\n    isLoading: true,\n    ...state,\n  });\n  const newPage = state.currentPage + 1;\n  getPrompt(newPage, (res) => {\n    console.log({ res });\n    State.update({\n      contents: state.contents.concat(res.body.prompt.rows),\n      currentPage: newPage,\n      lastPage: res.body.lastPage,\n      isLoading: false,\n    });\n  });\n};\n\nlet hasBeenMinted = {};\nconst mint = async (id, ipfsUrl) => {\n  const abi = [{\"type\":\"constructor\",\"inputs\":[{\"type\":\"string\",\"name\":\"name\",\"internalType\":\"string\"},{\"type\":\"string\",\"name\":\"symbol\",\"internalType\":\"string\"}]},{\"type\":\"function\",\"stateMutability\":\"nonpayable\",\"outputs\":[],\"name\":\"approve\",\"inputs\":[{\"type\":\"address\",\"name\":\"to\",\"internalType\":\"address\"},{\"type\":\"uint256\",\"name\":\"tokenId\",\"internalType\":\"uint256\"}]},{\"type\":\"function\",\"stateMutability\":\"view\",\"outputs\":[{\"type\":\"uint256\",\"name\":\"\",\"internalType\":\"uint256\"}],\"name\":\"balanceOf\",\"inputs\":[{\"type\":\"address\",\"name\":\"owner\",\"internalType\":\"address\"}]},{\"type\":\"function\",\"stateMutability\":\"view\",\"outputs\":[{\"type\":\"address\",\"name\":\"\",\"internalType\":\"address\"}],\"name\":\"getApproved\",\"inputs\":[{\"type\":\"uint256\",\"name\":\"tokenId\",\"internalType\":\"uint256\"}]},{\"type\":\"function\",\"stateMutability\":\"view\",\"outputs\":[{\"type\":\"bool\",\"name\":\"\",\"internalType\":\"bool\"}],\"name\":\"isApprovedForAll\",\"inputs\":[{\"type\":\"address\",\"name\":\"owner\",\"internalType\":\"address\"},{\"type\":\"address\",\"name\":\"operator\",\"internalType\":\"address\"}]},{\"type\":\"function\",\"stateMutability\":\"nonpayable\",\"outputs\":[],\"name\":\"mint\",\"inputs\":[{\"type\":\"string\",\"name\":\"_tokenURI\",\"internalType\":\"string\"}]},{\"type\":\"function\",\"stateMutability\":\"view\",\"outputs\":[{\"type\":\"string\",\"name\":\"\",\"internalType\":\"string\"}],\"name\":\"name\",\"inputs\":[]},{\"type\":\"function\",\"stateMutability\":\"view\",\"outputs\":[{\"type\":\"address\",\"name\":\"\",\"internalType\":\"address\"}],\"name\":\"ownerOf\",\"inputs\":[{\"type\":\"uint256\",\"name\":\"tokenId\",\"internalType\":\"uint256\"}]},{\"type\":\"function\",\"stateMutability\":\"nonpayable\",\"outputs\":[],\"name\":\"safeTransferFrom\",\"inputs\":[{\"type\":\"address\",\"name\":\"from\",\"internalType\":\"address\"},{\"type\":\"address\",\"name\":\"to\",\"internalType\":\"address\"},{\"type\":\"uint256\",\"name\":\"tokenId\",\"internalType\":\"uint256\"}]},{\"type\":\"function\",\"stateMutability\":\"nonpayable\",\"outputs\":[],\"name\":\"safeTransferFrom\",\"inputs\":[{\"type\":\"address\",\"name\":\"from\",\"internalType\":\"address\"},{\"type\":\"address\",\"name\":\"to\",\"internalType\":\"address\"},{\"type\":\"uint256\",\"name\":\"tokenId\",\"internalType\":\"uint256\"},{\"type\":\"bytes\",\"name\":\"data\",\"internalType\":\"bytes\"}]},{\"type\":\"function\",\"stateMutability\":\"nonpayable\",\"outputs\":[],\"name\":\"setApprovalForAll\",\"inputs\":[{\"type\":\"address\",\"name\":\"operator\",\"internalType\":\"address\"},{\"type\":\"bool\",\"name\":\"approved\",\"internalType\":\"bool\"}]},{\"type\":\"function\",\"stateMutability\":\"view\",\"outputs\":[{\"type\":\"bool\",\"name\":\"\",\"internalType\":\"bool\"}],\"name\":\"supportsInterface\",\"inputs\":[{\"type\":\"bytes4\",\"name\":\"interfaceId\",\"internalType\":\"bytes4\"}]},{\"type\":\"function\",\"stateMutability\":\"view\",\"outputs\":[{\"type\":\"string\",\"name\":\"\",\"internalType\":\"string\"}],\"name\":\"symbol\",\"inputs\":[]},{\"type\":\"function\",\"stateMutability\":\"view\",\"outputs\":[{\"type\":\"uint256\",\"name\":\"\",\"internalType\":\"uint256\"}],\"name\":\"tokenCounter\",\"inputs\":[]},{\"type\":\"function\",\"stateMutability\":\"view\",\"outputs\":[{\"type\":\"string\",\"name\":\"\",\"internalType\":\"string\"}],\"name\":\"tokenURI\",\"inputs\":[{\"type\":\"uint256\",\"name\":\"_tokenId\",\"internalType\":\"uint256\"}]},{\"type\":\"function\",\"stateMutability\":\"nonpayable\",\"outputs\":[],\"name\":\"transferFrom\",\"inputs\":[{\"type\":\"address\",\"name\":\"from\",\"internalType\":\"address\"},{\"type\":\"address\",\"name\":\"to\",\"internalType\":\"address\"},{\"type\":\"uint256\",\"name\":\"tokenId\",\"internalType\":\"uint256\"}]},{\"type\":\"event\",\"name\":\"Approval\",\"inputs\":[{\"type\":\"address\",\"name\":\"owner\",\"indexed\":true},{\"type\":\"address\",\"name\":\"approved\",\"indexed\":true},{\"type\":\"uint256\",\"name\":\"tokenId\",\"indexed\":true}],\"anonymous\":false},{\"type\":\"event\",\"name\":\"ApprovalForAll\",\"inputs\":[{\"type\":\"address\",\"name\":\"owner\",\"indexed\":true},{\"type\":\"address\",\"name\":\"operator\",\"indexed\":true},{\"type\":\"bool\",\"name\":\"approved\",\"indexed\":false}],\"anonymous\":false},{\"type\":\"event\",\"name\":\"Transfer\",\"inputs\":[{\"type\":\"address\",\"name\":\"from\",\"indexed\":true},{\"type\":\"address\",\"name\":\"to\",\"indexed\":true},{\"type\":\"uint256\",\"name\":\"tokenId\",\"indexed\":true}],\"anonymous\":false}]\n  const hologram = new ethers.Contract(\"0xC0769C1a52f54e5cE83F4B8919017cff6c4Dc39C\", abi, Ethers.provider().getSigner());\n  hologram.mint(ipfsUrl).then(res => {\n    console.log(res)\n    hasBeenMinted[id] = true;\n  });\n}\n\nconst createCard = ({ id, imageUrl, creatorAddress, prompt, objectName, ipfsUrl }) => {\n  return (\n    <div class=\"text-center p-2\">\n      <p>\n        <strong>\u26a1\ufe0f {objectName} \u26a1\ufe0f</strong>\n      </p>\n      <img class=\"border border-dark rounded\" src={imageUrl} />\n      <p>\u26d3\ufe0f {creatorAddress}</p>\n      <p>\ud83d\udd8c\ufe0f {prompt}</p>\n      {sender && ipfsUrl && <button class=\"btn btn-primary\" onClick={() => mint(id, ipfsUrl)}>Mint</button>}\n      {!!hasBeenMinted[id] && <>\n        <a href=\"https://tofunft.com/discover/items?contracts=85949&network=1313161554\">Explore in marketplace</a>\n        <a href=\"https://explorer.aurora.dev/address/0xC0769C1a52f54e5cE83F4B8919017cff6c4Dc39C/transactions#address-tabs\">Explore in Aurorascan</a>\n      </>}\n    </div>\n  );\n};\n\nreturn (\n  <>\n    {state.isLoading && (\n      <div class=\"position-sticky alert alert-primary\" role=\"alert\">\n        Loading...\n      </div>\n    )}\n\n    <div class=\"container border border-info p-3 text-center min-vw-90\">\n      <h1>Hologram AI</h1>\n      <p>What you are imagining today?</p>\n      <p>Minting available in Aurora only \ud83c\udf08</p>\n      {sender && <p>Account: {sender}</p>}\n    </div>\n    <div className=\"px-2 mx-auto\">\n      <InfiniteScroll\n        loadMore={loadMore}\n        hasMore={state.currentPage ? state.currentPage < state.lastPage : true} // infinite\n      >\n        {state.contents && state.contents.map(createCard)}\n      </InfiniteScroll>\n    </div>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/yokulguy.near/widget/prompt", "__row_index": 5}