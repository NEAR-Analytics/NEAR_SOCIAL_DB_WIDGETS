{"tx_hash": "4KPvVXte78vGRbN7SRHTDjB7ZN25drn42xa4DNekE7uN", "action_id_social": "7uhrreoeQZnYsyVYGuFYAnWUXVesXStyrvKowwZm3uRc-0-widget", "block_id": 80288038, "block_timestamp": "2022-12-09 21:36:25.365", "signer_id": "djwine_official.near", "widget_name": "Leaderboard", "source_code": "const loading = context.loading;\n\nif (loading) return \"Loading\";\n\nlet graph = Social.index(\"graph\", \"follow\");\nconsole.log(\"graph\", graph);\n// graph.forEach((i) => console.log(i));\n\nlet follows = graph.map((g) => ({\n  follower: g.accountId,\n  followed: g.value.accountId,\n  blockHeight: g.blockHeight,\n}));\n\nconsole.log(\"follows\", follows);\n\nlet followed = follows\n  .reduce((acc, i) => {\n    let result = acc.findIndex((el) => el.followed === i.followed);\n    if (result === -1) {\n      acc.push({ followed: i.followed, count: 1 });\n    } else {\n      let el = {\n        followed: i.followed,\n        count: acc[result].count + 1,\n      };\n      acc[result] = el;\n    }\n    return acc;\n  }, [])\n  .sort((a, b) => b.count - a.count);\n\nconsole.log(\"followed\", followed);\n\nlet followers = follows\n  .reduce((acc, i) => {\n    let result = acc.findIndex((el) => el.follower === i.follower);\n    if (result === -1) {\n      acc.push({ follower: i.follower, count: 1 });\n    } else {\n      let el = {\n        follower: i.follower,\n        count: acc[result].count + 1,\n      };\n      acc[result] = el;\n    }\n    return acc;\n  }, [])\n  .sort((a, b) => b.count - a.count);\n\nconsole.log(\"followers\", followers);\n\nreturn (\n  <>\n    <h1 class=\"mb-4\">Leaderboard</h1>\n\n    <div class=\"container\">\n      <div class=\"row\">\n        <div class=\"col mr-2\">\n          <Widget\n            src=\"djwine_official.near/widget/Table\"\n            props={{\n              title: \"Followed\",\n              data: followed,\n              key: \"followed\",\n              keyLabel: \"Account\",\n              value: \"count\",\n              valueLabel: \"Followed by\",\n            }}\n          />\n        </div>\n        <div class=\"col\">\n          <Widget\n            src=\"djwine_official.near/widget/Table\"\n            props={{\n              title: \"Followers\",\n              data: followers,\n              key: \"follower\",\n              keyLabel: \"Account\",\n              value: \"count\",\n              valueLabel: \"Following\",\n            }}\n          />\n        </div>\n        <div class=\"col \">One of three columns</div>\n      </div>\n    </div>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/djwine_official.near/widget/Leaderboard"}