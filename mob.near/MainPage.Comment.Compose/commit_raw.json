{"tx_hash": "5bZRv9ALvcmnsCJduaWTeYV6iDtFmKYRaioQ4b2ARGU7", "action_id_social": "3DifyonBv6BwTkZFmZ7EZgcpL1ZWPaai8WkRb3YBXt1c-0-widget", "block_id": 81357801, "block_timestamp": "2022-12-24 12:35:50.824", "signer_id": "mob.near", "widget_name": "MainPage.Comment.Compose", "source_code": "if (!context.accountId) {\n  return \"\";\n}\n\nconst item = props.item;\n\nState.init({\n  image: {},\n  text: \"\",\n});\n\nconst content = (state.text || state.image.cid) && {\n  type: \"md\",\n  text: state.text,\n  image: state.image.cid ? { ipfs_cid: state.image.cid } : undefined,\n};\n\nconst onChange = (text) => {\n  State.update({\n    text,\n  });\n};\n\nconst data = {\n  post: {\n    comment: JSON.stringify(Object.assign({ item }, content)),\n  },\n  index: {\n    comment: JSON.stringify({\n      key: item,\n      value: {\n        type: \"md\",\n      },\n    }),\n  },\n};\n\nif (props.notifyAccountId) {\n  data.index.notify = JSON.stringify({\n    key: props.notifyAccountId,\n    value: {\n      type: \"comment\",\n      item,\n    },\n  });\n}\n\nreturn (\n  <>\n    <div className=\"text-bg-light rounded-4\">\n      <div className=\"p-2\">\n        <textarea\n          className=\"form-control border-0 text-bg-light w-100\"\n          value={state.text || \"\"}\n          onChange={(e) => onChange(e.target.value)}\n          placeholder=\"Reply\"\n        />\n      </div>\n      <div className=\"d-flex flex-row p-2 border-top\">\n        <div className=\"flex-grow-1\">\n          <IpfsImageUpload\n            image={state.image}\n            className=\"btn btn-outline-secondary border-0 rounded-3\"\n          />\n        </div>\n        <div>\n          <CommitButton\n            disabled={!content}\n            force\n            className=\"btn btn-dark rounded-3\"\n            data={data}\n            onCommit={() => {\n              State.update({\n                image: {},\n                text: \"\",\n              });\n              props.onComment && props.onComment(content);\n            }}\n          >\n            Comment\n          </CommitButton>\n        </div>\n      </div>\n    </div>\n    {content && (\n      <div className=\"mt-3\">\n        <Widget\n          src=\"mob.near/widget/MainPage.Comment\"\n          props={{\n            item,\n            accountId: context.accountId,\n            content,\n            blockHeight: \"now\",\n          }}\n        />\n      </div>\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/mob.near/widget/MainPage.Comment.Compose"}