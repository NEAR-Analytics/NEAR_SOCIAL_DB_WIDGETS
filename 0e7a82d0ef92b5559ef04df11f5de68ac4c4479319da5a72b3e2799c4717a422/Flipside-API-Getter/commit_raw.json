{"tx_hash": "Fqn78GcLupaRfFyfxxJMpKPaLX8RLuY7bNjCCS1Y1Y1t", "action_id_social": "5daYpX1DJrFrxhL86evT5SpW5cEyKR5LrBmWPxU1HDpC-0-widget", "block_id": 86582552, "block_timestamp": "2023-03-05 03:00:44.687", "signer_id": "0e7a82d0ef92b5559ef04df11f5de68ac4c4479319da5a72b3e2799c4717a422", "widget_name": "Flipside-API-Getter", "source_code": "State.init({\r\n  results: \"Awaiting Query...\",\r\n});\r\n\r\nconst options = {\r\n  method: \"POST\",\r\n  body: `{ \"query\": \"${props.query}\" }`,\r\n  headers: {\r\n    \"Content-Type\": \"application/json\",\r\n  },\r\n};\r\n\r\nState.update({\r\n  results: \"Query Triggered...\",\r\n});\r\n\r\nasyncFetch(\"https://flipside-api.antonyip.com/getCachedQuery\", options).then(\r\n  (res) => {\r\n    State.update({\r\n      results: \"What is results?\",\r\n    });\r\n    if (!res.ok) {\r\n      if (props.onComplete) {\r\n        props.onComplete(\r\n          false,\r\n          `near.social issue with fetch: ${JSON.stringify(res)}`\r\n        );\r\n      }\r\n      State.update({\r\n        results: `near.social issue with fetch: ${JSON.stringify(res)}`,\r\n      });\r\n      return;\r\n    }\r\n    // select date_trunc('day', block_timestamp), count(1) from ethereum.core.blocks where block_timestamp > '2023-03-01' group by 1\r\n    if (res.body.error) {\r\n      if (props.onComplete) {\r\n        props.onComplete(\r\n          false,\r\n          `anton's api issue: ${JSON.stringify(res.body)}`\r\n        );\r\n      }\r\n      State.update({\r\n        results: `anton's api issue: ${JSON.stringify(res.body)}`,\r\n      });\r\n      return;\r\n    }\r\n\r\n    State.update({\r\n      results: `${JSON.stringify(res.body)}`,\r\n    });\r\n    if (props.onComplete) {\r\n      props.onComplete(true, res.body);\r\n    }\r\n  }\r\n);\r\n\r\nif (props.debug === \"true\") {\r\n  return (\r\n    <>\r\n      <div>query: {props.query}</div>\r\n      <div>isCallbackAttached: {props.onComplete ? \"true\" : \"false\"}</div>\r\n      <div>results: {state.results}</div>\r\n    </>\r\n  );\r\n}\r\n\r\nreturn <></>;\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/0e7a82d0ef92b5559ef04df11f5de68ac4c4479319da5a72b3e2799c4717a422/widget/Flipside-API-Getter"}