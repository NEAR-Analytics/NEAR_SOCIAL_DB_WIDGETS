{"tx_hash": "B9PPhzxpy3xGg3z2dp1yxEmH3Gh3353tYCn1QdNfBZqf", "action_id_social": "9QXg2rAU2S67cjAJ74qRvJks2ro3aUn8osoPaTK3Lcfc-0-widget", "block_id": 86582299, "block_timestamp": "2023-03-05 02:55:56.717", "signer_id": "0e7a82d0ef92b5559ef04df11f5de68ac4c4479319da5a72b3e2799c4717a422", "widget_name": "Flipside-API-Getter", "source_code": "State.init({\r\n  results: \"Awaiting Query...\",\r\n});\r\n\r\nfunction sendQueryToBackend() {\r\n  const options = {\r\n    method: \"POST\",\r\n    body: `{ \"query\": \"${props.query}\" }`,\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n  };\r\n\r\n  State.update({\r\n    results: \"Query Triggered...\",\r\n  });\r\n\r\n  const res = asyncFetch(\r\n    \"https://flipside-api.antonyip.com/getCachedQuery\",\r\n    options\r\n  ).then((res) => {\r\n    if (!res.ok) {\r\n      props.onComplete(\r\n        false,\r\n        `near.social issue with fetch: ${JSON.stringify(res)}`\r\n      );\r\n      State.update({\r\n        results: `near.social issue with fetch: ${JSON.stringify(res)}`,\r\n      });\r\n      return;\r\n    }\r\n    // select date_trunc('day', block_timestamp), count(1) from ethereum.core.blocks where block_timestamp > '2023-03-01' group by 1\r\n    if (res.body.error) {\r\n      props.onComplete(false, `anton's api issue: ${JSON.stringify(res.body)}`);\r\n      State.update({\r\n        results: `anton's api issue: ${JSON.stringify(res.body)}`,\r\n      });\r\n      return;\r\n    }\r\n\r\n    State.update({\r\n      results: `${JSON.stringify(res.body)}`,\r\n    });\r\n    props.onComplete(true, res.body);\r\n  });\r\n}\r\n\r\nif (props.debug === \"true\") {\r\n  return (\r\n    <>\r\n      <div>query: {props.query}</div>\r\n      <div>isCallbackAttached: {props.onComplete ? \"true\" : \"false\"}</div>\r\n      <div>results: {state.results}</div>\r\n    </>\r\n  );\r\n}\r\n\r\nreturn <></>;\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/0e7a82d0ef92b5559ef04df11f5de68ac4c4479319da5a72b3e2799c4717a422/widget/Flipside-API-Getter"}