{"tx_hash": "AHSHn342pus12XvYUesNzQQn87hs4XZGnkC58QDfNFVT", "action_id_social": "Gysveb2KuRFJpJMFXbDZvxUfNYzM49sWCHqLmpzMJwVc-0-widget", "block_id": 86579430, "block_timestamp": "2023-03-05 02:00:43.040", "signer_id": "0e7a82d0ef92b5559ef04df11f5de68ac4c4479319da5a72b3e2799c4717a422", "widget_name": "Flipside-API", "source_code": "State.init({\r\n  query: `select 1`,\r\n  result: `await results...`,\r\n});\r\n\r\nconst MyButton = styled.button`\r\n  background: ${(props) => (props.primary ? \"palevioletred\" : \"white\")};\r\n  color: ${(props) => (props.primary ? \"white\" : \"palevioletred\")};\r\n  font-size: 1em;\r\n  margin: 1em;\r\n  padding: 0.25em 1em;\r\n  border: 2px solid palevioletred;\r\n  border-radius: 3px;\r\n`;\r\n\r\nfunction updateQuery(value) {\r\n  State.update({\r\n    query: value,\r\n  });\r\n}\r\n\r\nfunction sendQueryToBackend() {\r\n  const options = {\r\n    method: \"POST\",\r\n    body: `{ \"query\": \"${state.query}\" }`,\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n  };\r\n\r\n  State.update({\r\n    result: \"Querying the backend...\",\r\n  });\r\n\r\n  const res = asyncFetch(\r\n    \"https://flipside-api.antonyip.com/getCachedQuery\",\r\n    options\r\n  ).then((res) => {\r\n    State.update({\r\n      result: \"Results are here\",\r\n    });\r\n    if (!res.ok) {\r\n      State.update({\r\n        result: `near.social issue with fetch: ${JSON.stringify(res)}`,\r\n      });\r\n      return;\r\n    }\r\n    // select date_trunc('day', block_timestamp), count(1) from ethereum.core.blocks where block_timestamp > '2023-03-01' group by 1\r\n    if (res.body.error) {\r\n      State.update({\r\n        result: `anton's api issue: ${JSON.stringify(res.body)}`,\r\n      });\r\n      return;\r\n    }\r\n\r\n    State.update({\r\n      result: JSON.stringify(res.body.records),\r\n    });\r\n  });\r\n}\r\n\r\nreturn (\r\n  <div>\r\n    <input\r\n      type=\"text\"\r\n      onChange={(e) => updateQuery(e.target.value)}\r\n      // className={`form-control ${state.term ? \"border-end-0\" : \"\"}`}\r\n      value={state.query ?? \"\"}\r\n      // onChange={(e) => computeResults(e.target.value)}\r\n      // placeholder={props.placeholder ?? `Enter your query here!`}\r\n    />\r\n    <MyButton onClick={() => sendQueryToBackend()}>Submit Query</MyButton>\r\n    <div>{state.result}</div>\r\n  </div>\r\n);\r\n", "metadata": NaN, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/0e7a82d0ef92b5559ef04df11f5de68ac4c4479319da5a72b3e2799c4717a422/widget/Flipside-API", "metadata.description": NaN, "metadata.linktree.website": NaN, "metadata.name": NaN, "metadata.image.url": NaN, "metadata.tags.api": NaN, "metadata.tags.flipside": NaN, "metadata.tags.metricsdao": NaN, "metadata.tags.near-analytics": NaN}