{"tx_hash": "B4AkwwSX7dnhrizLRQX2PaMPt7CMJUXXo6JPQt6v7n4D", "action_id_social": "2SZRhqQVEwZV6KnRa6Ynndrsun98E2UGKB6XjcDJKWiU-0-widget", "block_id": 86582087, "block_timestamp": "2023-03-05 02:51:59.902", "signer_id": "0e7a82d0ef92b5559ef04df11f5de68ac4c4479319da5a72b3e2799c4717a422", "widget_name": "Flipside-BarChart", "source_code": "// Monthly Active Accounts Example\r\nlet data = fetch(\r\n  \"https://api.flipsidecrypto.com/api/v2/queries/da1fb143-e325-43ea-a07d-8fcf750eea16/data/latest\",\r\n  {\r\n    subscribe: true,\r\n    method: \"GET\",\r\n    headers: {\r\n      Accept: \"*/*\",\r\n    },\r\n  }\r\n);\r\n\r\ndata.body = data.body.sort((a, b) => new Date(a.MONTH) - new Date(b.MONTH));\r\nconst METRIC_NAME = \"Monthly Active Accounts\";\r\n\r\nfunction formatNumberWithCommas(number) {\r\n  return number.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n}\r\n\r\nfunction formatDate(dateStr) {\r\n  const date = new Date(dateStr);\r\n  const year = date.getFullYear().toString().slice(-2);\r\n  const months = [\r\n    \"Jan\",\r\n    \"Feb\",\r\n    \"Mar\",\r\n    \"Apr\",\r\n    \"May\",\r\n    \"Jun\",\r\n    \"Jul\",\r\n    \"Aug\",\r\n    \"Sep\",\r\n    \"Oct\",\r\n    \"Nov\",\r\n    \"Dec\",\r\n  ];\r\n  const month = months[date.getMonth()];\r\n  return `${year} - ${month}`;\r\n}\r\n\r\nlet Style = styled.div`\r\n\r\n      .barTextH{\r\n        transition: fill 0.2s;\r\n\r\n      }\r\n    .barTextH:hover{\r\n        fill: #ad610a;\r\n\r\n      }\r\n      .bar {\r\n        transition: fill 0.2s;\r\n      }\r\n\r\n      .bar:hover {\r\n        fill: #ffa726;\r\n      }\r\n\r\n      .bar-chart {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n      }\r\n\r\n        svg {\r\n          width: 80%;\r\n        }\r\n\r\n        rect {\r\n          shape-rendering: crispEdges;\r\n          fill: #61dafb;\r\n          stroke: #333;\r\n          stroke-width: 1;\r\n        }\r\n\r\n\r\n        `;\r\n\r\nconst width = 800;\r\nconst height = 500;\r\nconst maxValue = Math.max(...data.body.map((d) => d.ACTIVE_WALLETS)) * 1.1;\r\n\r\nreturn (\r\n  <>\r\n    <Widget\r\n      src={`0e7a82d0ef92b5559ef04df11f5de68ac4c4479319da5a72b3e2799c4717a422/widget/Flipside-API-Getter`}\r\n      query=\"select 1\"\r\n      debug=\"true\"\r\n    />\r\n    <Style>\r\n      <div className=\"text-bg-light rounded-4 p-3 mb-4\">\r\n        {data !== null ? (\r\n          <p>\r\n            <div class=\"d-flex clearfix flex-wrap flex-column flex-sm-row\">\r\n              <div class=\"p-2\">\r\n                <div>\r\n                  <h2>Metric: {METRIC_NAME}</h2>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <hr />\r\n              <div className=\"bar-chart\">\r\n                <svg\r\n                  width={width}\r\n                  height={height}\r\n                  viewBox={`0 0 ${width} ${height + 200} `}\r\n                  preserveAspectRatio=\"xMidYMid meet\"\r\n                >\r\n                  {data.body.map((d, i) => (\r\n                    <g key={i} className=\"barTextH\">\r\n                      <rect\r\n                        className=\"bar\"\r\n                        x={i * (width / data.body.length)}\r\n                        y={height - (d.ACTIVE_WALLETS / maxValue) * height}\r\n                        width={width / data.body.length - 2}\r\n                        height={(d.ACTIVE_WALLETS / maxValue) * height}\r\n                        fill=\"#61dafb\"\r\n                      />\r\n                      <text\r\n                        className=\"text-primary-emphasis\"\r\n                        x={\r\n                          i * (width / data.body.length) +\r\n                          width / data.body.length / 2\r\n                        }\r\n                        y={height + 40}\r\n                        transform={`rotate(-75 ${\r\n                          i * (width / data.body.length) +\r\n                          width / data.body.length / 2\r\n                        } ${height + 40})`}\r\n                        textAnchor=\"middle\"\r\n                      >\r\n                        / {formatDate(d.MONTH)}\r\n                      </text>\r\n                      <text\r\n                        className=\"text-primary-emphasis\"\r\n                        x={\r\n                          i * (width / data.body.length) +\r\n                          width / data.body.length / 2\r\n                        }\r\n                        y={height + 90}\r\n                        transform={`rotate(-75 ${\r\n                          i * (width / data.body.length) +\r\n                          width / data.body.length / 2\r\n                        } ${height + 110})`}\r\n                        textAnchor=\"middle\"\r\n                      >\r\n                        {formatNumberWithCommas(d.ACTIVE_WALLETS)}\r\n                      </text>\r\n                    </g>\r\n                  ))}\r\n                </svg>\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <hr />\r\n              <small className=\"fw-bold\">\r\n                Data is provided by{\" \"}\r\n                <a\r\n                  target=\"_blank\"\r\n                  style={{ color: \"inherit\" }}\r\n                  variant=\"caption\"\r\n                  rel=\"nofollow\"\r\n                  href=\"https://www.flipsidecrypto.com/\"\r\n                >\r\n                  Flipside Crypto\r\n                </a>\r\n              </small>\r\n            </div>\r\n          </p>\r\n        ) : (\r\n          <div>Loading ...</div>\r\n        )}\r\n      </div>\r\n    </Style>\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/0e7a82d0ef92b5559ef04df11f5de68ac4c4479319da5a72b3e2799c4717a422/widget/Flipside-BarChart"}