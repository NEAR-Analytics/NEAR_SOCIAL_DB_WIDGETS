{"tx_hash": "12Adj3CFxfVW9w4Cqw7J7tA5FKywSPi7heVEEGqHfiiJ", "action_id_social": "J8F3nPGKfKyPVnCULtxbiR3WQKEFRRftHy1itkEcUuPk-0-widget", "block_id": 93908390, "block_timestamp": "2023-06-10T18:54:29.902Z", "signer_id": "donating.near", "widget_name": "DonateDAO.main", "source_code": "// TO-DO\n// hookup to paymster, show transactionr ecipet\n// show balance of USDC of connected wallet\n// put usdc address on ZKSync\n// check connect address instead of deposit\n// configure dropw down reciever\n// show the on chain mimum balance amount\n// add zk account\nif (state.chainId !== undefined && state.chainId !== 280) {\n  return <p>Switch to ZKSync Testnet</p>;\n} // not sure if this is working\n// https://era.zksync.io/docs/dev/building-on-zksync/useful-address.html\nState.init({\n  reciever: \"\",\n}); // write now state reciever is in clipboard\n\nconst { deposit, withdraw, onAction, title, isLoading, log, explorerLink } =\n  props;\nconst { action, amount, selectedAsset } = state;\nconst { assets } = deposit;\n\nconst isDeposit = !action || action === \"deposit\";\nconst actionTitle = isDeposit ? \"Donate\" : \"Withdraw\";\n\nif (assets && !selectedAsset) {\n  initState({\n    selectedAsset: assets.find((a) => a.selected) || assets?.[0],\n  });\n}\n\nconst selectedAssetWithdraw = selectedAsset\n  ? withdraw?.assets?.find((a) => a.id === selectedAsset.id)\n  : undefined;\n\nconst handleAction = () => {\n  if (onAction)\n    onAction({\n      networkId: deposit.network.id,\n      amount,\n      assetId: selectedAsset.id,\n      action: isDeposit ? \"deposit\" : \"withdraw\",\n    });\n};\n\nconst handleMax = () => {\n  State.update({ amount: selectedAsset.balance });\n};\n\nconst handleAmountChange = (e) => {\n  State.update({ amount: e.target.value });\n};\nconst handleRecieverChange = (e) => {\n  State.update({ reciever: e.target.value });\n};\n\nconst handleAssetChange = (e) => {\n  State.update({ selectedAsset: assets?.find((a) => a.id === e.target.value) });\n};\n\nconst Container = styled.div`\n    max-width: 400px;\n    width: 100%;\n    margin: 0 auto;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    border: 1px solid gray;\n    padding-top: 1rem;\n    border-radius: 0.5rem;\n    margin-top: 1rem;\n\n    * {\n        font-family: 'Inter custom',sans-serif;\n    }\n\n    background: white;\n    color: black;\n\n    .title {\n      margin-top: 8px;\n    }\n\n    .actionTabs {\n      border: 1px solid black;\n      height: 38px;\n\n      input:checked + label {\n        color: black;\n      }\n\n      label {\n        color: gray;\n        background: white !important;\n        border: 1px solid black !important;\n        height: 38px;\n        \n        &:hover {\n          color: black;\n        }\n      }\n    }\n\n    button.max {\n      border: 1px solid black;\n    }\n\n    button.action {\n      background-color: black;\n    }\n\n    .action {\n      background: black;\n      color: white;\n    }\n\n    .balance {\n      input {\n        height: 38px;\n        background: #f5f6fd;\n        color: black;\n        border: 1px solid black;\n      }\n      button {\n        height: 38px;\n        background: #f5f6fd;\n        color: black;\n      }\n    }\n\n    .assets {\n      select {\n        background: #f5f6fd;\n        color: black;\n      }\n    }\n`;\n\nconst sender = Ethers.send(\"eth_requestAccounts\", [])[0];\nconst erc20Abi = fetch(\n  \"https://gist.githubusercontent.com/veox/8800debbf56e24718f9f483e1e40c35c/raw/f853187315486225002ba56e5283c1dba0556e6f/erc20.abi.json\"\n);\n\nif (sender) {\n  Ethers.provider()\n    .getNetwork()\n    .then(({ chainId }) => {\n      State.update({ chainId: chainId === 5 ? \"testnet\" : \"mainnet\" });\n    });\n}\nconst contracts = {\n  mainnet: {\n    paymaster: {\n      L1ERC20BridgeProxy: \"0x57891966931Eb4Bb6FB81430E6cE0A03AAbDe063\", // change this\n    },\n    weth: {\n      withdraw: \"0x5AEa5775959fBC2557Cc8789bC1bf90A239D9a91\", // l2 token\n    },\n    usdc: {\n      withdraw: \"0x3355df6D4c9C3035724Fd0e3914dE96A5a83aaf4\", // l2 token\n    },\n  },\n  testnet: {\n    paymster: {\n      L2ERC20Bridge: \"0x00ff932A6d70E2B8f1Eb4919e1e09C1923E7e57b\",\n    },\n    weth: {\n      withdraw: undefined, // not found yet\n    },\n    usdc: {\n      withdraw: undefined, // not found yet\n    },\n  },\n};\nconst css = `\n  .flex {\n    display: flex;\n    color: white;\n    > div {\n        margin: 32px 0;\n      margin-right: 32px;\n      width: 50%;\n    }\n    > div:last-of-type {\n      margin-right: 0;\n    }\n  }\n  .btn {\n      margin-bottom: 16px !important;\n  }\n  .h1 {\n    font-family: 'Lato', sans-serif;\n    src: url('https://fonts.googleapis.com/css2?family=Lato&display=swap') format('css2');\n    font-weight: 300;\n    font-style: normal;\n  }\n  .Connect {\n    background-color: purple;\n    color: white;\n  }\n`;\n\nif (!state.theme) {\n  State.update({\n    theme: styled.div`\n    ${css}\n`,\n  });\n}\nconst Theme = state.theme;\nconst paymasterContract = \"\";\nconst tokenDecimals = 18; // double check on contract\n// FETCH Paymaster ABI\n\n// see if API3 can be fetched here\n\nconst paymasterABI = fetch(\n  \"https://raw.githubusercontent.com/codingshot/zksync-paymaster/main/paymaster-abi.json\"\n);\nif (!paymasterABI.ok) {\n  return \"Loading\";\n}\n// add conditional for charity // this should be emitted as an error from the smart contract\nreturn (\n  <Theme>\n    <Container>\n      <div className=\"d-flex gap-4 align-items-center mb-3 justify-content-center\">\n        <h1 className=\"title\">{title || \"\ud83d\ude4f DonateDAO\"}</h1>\n        <div\n          className=\"actionTabs btn-group\"\n          role=\"group\"\n          aria-label=\"Deposit\"\n        ></div>\n      </div>\n      <div className=\"border border-secondary border-bottom-0 border-light\" />\n      <div className=\"p-2\">\n        <div className=\"column\">\n          <div className=\"assets\">\n            <span>{deposit.network.name}</span>\n            <select\n              className=\"form-select\"\n              aria-label=\"select asset\"\n              onChange={handleAssetChange}\n            >\n              {assets &&\n                assets.map((asset) => (\n                  <option value={asset.id} selected={asset.selected}>\n                    {asset.name}\n                  </option>\n                ))}\n            </select>\n          </div>\n          <div className=\"d-flex justify-content-between\">\n            <span>Balance: {selectedAsset.balance}</span>\n          </div>\n          <div className=\"balance input-group\">\n            <input\n              style={{ maxWidth: \"120px\" }}\n              type=\"number\"\n              min=\"0\"\n              step=\"0.1\"\n              defaultValue={props.amount}\n              value={amount}\n              placeholder=\"0.00\"\n              onChange={handleAmountChange}\n            />\n            <button className=\"btn btn-light btn-sm max\" onClick={handleMax}>\n              max\n            </button>\n          </div>\n          <div className=\"balance input-group\">\n            <input\n              style={{ maxWidth: \"100%\" }}\n              type=\"string\"\n              defaultValue={props.amount}\n              value={reciever}\n              placeholder={state.reciever}\n              onChange={handleRecieverChange}\n            />\n          </div>\n        </div>\n      </div>\n      <div className=\"border border-secondary border-bottom-0 border-light\" />\n\n      <div className=\"border border-secondary border-bottom-0 border-light\" />\n      {!!state.sender ? (\n        <div className=\"p-4 d-grid gap-3\">\n          <button\n            className=\"action btn btn-primary\"\n            onClick={handleAction}\n            disabled={isLoading}\n          >\n            {isLoading ? \"Loading...\" : actionTitle}\n          </button>\n          {log && (\n            <div className=\"alert alert-success\" role=\"alert\">\n              <div className=\"text-truncate\" style={{ maxWidth: 300 }}>\n                {log}\n              </div>\n              <a href={explorerLink} className=\"alert-link\" target=\"_blank\">\n                Etherscan\n              </a>\n            </div>\n          )}\n        </div>\n      ) : (\n        <Web3Connect\n          className=\"action btn btn-primary\"\n          connectLabel=\"Connect To ZkSync \"\n        />\n      )}\n    </Container>\n    <div>\n      <h1>Debug</h1>\n      <p>Input USDC Amount: {state.amount}</p>\n      <p>Input Reciever Address: {state.reciever}</p>\n    </div>\n    <Widget src=\"donating.near/widget/DonateDAO.dropdown\" />\n  </Theme>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/donating.near/widget/DonateDAO.main", "__row_index": 4}