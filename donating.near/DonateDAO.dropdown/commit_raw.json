{"tx_hash": "AiwZ94kgt4JGgx5xqKbL5YDfgteovjTvQ8FPyyT3Hdj7", "action_id_social": "AaHHrPDe2guudHn4jdZwuNMsX9NEr636q3huwvpmTYCR-0-widget", "block_id": 93904316, "block_timestamp": "2023-06-10T17:36:45.371Z", "signer_id": "donating.near", "widget_name": "DonateDAO.dropdown", "source_code": "// add helper function to contract to see whitelisted charity addresses, map them to name, for now just in json\n\nconst Header = styled.div`\n  padding: 15px;\n  position: relative;\n  font-weight: normal;\n  font-family: \"Open Sans\", \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n  font-size: 32px;\n  text-align: center;\n  color: #333;\n`;\n\nconst ROW_LIMIT = 10;\n\n// need to have the search result updated and selected in state\n// Charity helper functions\nfunction loadCharities() {\n  const res = fetch(\n    \"https://raw.githubusercontent.com/codingshot/donatedao-landing/main/data/charityList.json\"\n  );\n  return res.body && JSON.parse(res.body);\n}\n\nfunction filterCharity(searchText, maxResults) {\n  return charityList\n    .filter((charity) => {\n      if (charity.title.toLowerCase().includes(searchText.toLowerCase())) {\n        return true;\n      }\n      if (charity.keywords.includes(searchText)) {\n        return true;\n      }\n      if (charity.description.includes(searchText)) {\n        return true;\n      }\n      if (charity.address.includes(searchText)) {\n        return true;\n      }\n      return false;\n    })\n    .slice(0, maxResults);\n}\n\n// Load Charities\nconst charityList = loadCharities();\nif (!charityList) {\n  return \"\u29d7 Loading Charities...\";\n}\n\nState.init({\n  filteredCharity: filterCharity(\"\", ROW_LIMIT),\n});\n\nconst handleSearchChange = (event) => {\n  State.update({\n    filteredCharity: filterCharity(event.target.value, ROW_LIMIT),\n  });\n};\n\nreturn (\n  <div>\n    <Header>\ud83d\udd0e Non-Profit Search</Header>\n    <p>Selected Charity Address: {state.selectedAddress}</p>\n    <Widget\n      src={`donating.near/widget/DonateDAO.searchInput`}\n      props={{ textChange: handleSearchChange }}\n    />\n    <div>\n      {state.filteredCharity.map(({ address, description, title }) => (\n        <Widget\n          src={`donating.near/widget/DonateDAO.searchResult`}\n          props={{\n            address,\n            description,\n            title,\n            onChange: ({ address }) => {\n              State.update({\n                selectedAddress: address,\n              });\n            },\n          }}\n        />\n      ))}\n    </div>\n  </div>\n);\n", "metadata": null, "branch": {"draft": null}, "widget_modules_used": null, "widget_url": "https://near.social/#/donating.near/widget/DonateDAO.dropdown", "__row_index": 0}