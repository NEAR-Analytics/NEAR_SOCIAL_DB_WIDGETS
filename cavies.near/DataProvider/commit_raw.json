{"tx_hash": "BYtm27j521G86dpDQ1ZAvrcyBVsfY2Q7DnuKdB4fjnTj", "action_id_social": "BGGuRSaE2Bh1cmFpSYPk282NexkCzq9A5Phmnx6wz5Na-0-widget", "block_id": 95059873, "block_timestamp": "2023-06-26T08:01:07.100Z", "signer_id": "cavies.near", "widget_name": "DataProvider", "source_code": "// onLoad\nconst { onLoad, targetState, updateState } = props;\n\n// Define constants value\nconst API = \"https://prod-pocket-api.hamsterbox.xyz/api\";\nconst POCKET_ABI_URL =\n  \"https://raw.githubusercontent.com/CaviesLabs/hamsterpocket-assets/main/pocketchef.json\";\nconst WHITELIST_ENDPOINT = `${API}/whitelist`;\nconst LIST_POCKET_ENDPOINT = `${API}/pool/decimals-formatted?limit=&offset=0&chainId=bnb&statuses=POOL_STATUS%3A%3AACTIVE&statuses=POOL_STATUS%3A%3ACLOSED&sortBy=DATE_START_DESC`;\n\n// Define state reducer\nconst useState = (stateName, defaultValue) => {\n  if (!targetState[stateName]) {\n    updateState({\n      [stateName]: defaultValue,\n    });\n  }\n\n  return [\n    targetState[stateName] || defaultValue,\n    (value) => {\n      updateState({\n        [stateName]: value,\n      });\n    },\n  ];\n};\n\n// Define methods to be exposed\nconst fetchPockets = (ownerAddress) => {\n  const [, setPocket] = useState(\"pockets\", []);\n\n  return new Promise((resolve) => {\n    asyncFetch(`${LIST_POCKET_ENDPOINT}&ownerAddress=${ownerAddress}`).then(\n      (result) => {\n        setPocket(result.body);\n        return resolve(result.body);\n      }\n    );\n  });\n};\n\n// emit data to parents component\nonLoad({\n  useState,\n  fetchPockets,\n});\n\n// trigger this to reload DOM\nupdateState({\n  [`cavies.near/Widget/DataProvider`]: new Date().getTime(),\n});\n\nconsole.log(\"widget reloaded\");\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/cavies.near/widget/DataProvider", "__row_index": 20}