{"tx_hash": "9xpxzmYYU8S4MBDwTme1scZBS7FrkfZQgNGL3nbvF6FA", "action_id_social": "9R1GqiW51h1cqHChfd3ZpDZAr82NRTCWyyp3hXmtQXc9-0-widget", "block_id": 85346320, "block_timestamp": "2023-02-16 10:55:56.029", "signer_id": "contribut3.near", "widget_name": "Index", "source_code": "const ownerId = \"contribut3.near\";\r\n\r\ninitState({\r\n  search: \"\",\r\n  content: props.content ?? \"entities\",\r\n  tab: props.tab ?? \"dashboard\",\r\n});\r\n\r\nconst isModerator = Near.view(\r\n  ownerId,\r\n  \"check_is_moderator\",\r\n  { account_id: context.accountId },\r\n  \"final\",\r\n  true\r\n);\r\n\r\nconst isContributor = Near.view(\r\n  ownerId,\r\n  \"check_is_contributor\",\r\n  { account_id: context.accountId },\r\n  \"final\",\r\n  true\r\n);\r\n\r\nconst editorForm = ({ formName }) => (\r\n  <div\r\n    className=\"collapse\"\r\n    id={`collapse${formName}Form`}\r\n    data-bs-parent=\"#accordion\"\r\n  >\r\n    <Widget src={`${ownerId}/widget/${formName}Form`} />\r\n  </div>\r\n);\r\n\r\nconst editorsFooter = props.isPreview ? null : (\r\n  <div className=\"row\" id=\"accordion\">\r\n    {editorForm({ formName: \"Contributor\" })}\r\n    {editorForm({ formName: \"ContributionRequest\" })}\r\n    {editorForm({ formName: \"Entity\" })}\r\n    {editorForm({ formName: \"Invite\" })}\r\n    {!isModerator ? null : editorForm({ formName: \"ModeratorEntity\" })}\r\n    {!isModerator ? null : editorForm({ formName: \"ModeratorSet\" })}\r\n  </div>\r\n);\r\n\r\nconst control = ({ formName, text, icon }) => (\r\n  <Widget\r\n    src={`${ownerId}/widget/NavbarControl`}\r\n    props={{ formName, text, icon }}\r\n  />\r\n);\r\n\r\nconst controls = (\r\n  <div className=\"card border-secondary mb-2\">\r\n    <div className=\"nav navbar navbar-expand-lg bg-body-tertiary\">\r\n      <div className=\"container-fluid\">\r\n        <div className=\"navbar-brand\">\r\n          <Widget\r\n            src=\"mob.near/widget/ProfileImage\"\r\n            props={{\r\n              metadata,\r\n              accountId,\r\n              widgetName,\r\n              style: { height: \"2.5em\", width: \"2.5em\", minWidth: \"2.5em\" },\r\n              className: \"me-2\",\r\n            }}\r\n          />\r\n        </div>\r\n        <div className=\"collapse navbar-collapse\" id=\"navbarText\">\r\n          <ul className=\"navbar-nav me-auto mb-2 mb-lg-0\">\r\n            {control({\r\n              formName: \"Contributor\",\r\n              text: isContributor\r\n                ? \"Edit contributor profile\"\r\n                : \"Register as a contributor\",\r\n              icon: isContributor\r\n                ? \"bi-person-fill-gear\"\r\n                : \"bi-person-fill-add\",\r\n            })}\r\n            {control({\r\n              formName: \"ContributionRequest\",\r\n              text: \"Propose Contribution\",\r\n              icon: \"bi-plus-circle\",\r\n            })}\r\n            {control({\r\n              formName: \"Entity\",\r\n              text: \"Create Entity\",\r\n              icon: \"bi-plus-circle\",\r\n            })}\r\n            {control({\r\n              formName: \"Invite\",\r\n              text: \"Invite Contributor\",\r\n              icon: \"bi-person-add\",\r\n            })}\r\n            {!isModerator\r\n              ? null\r\n              : control({\r\n                formName: \"ModeratorEntity\",\r\n                text: \"Edit/Create Entity\",\r\n                icon: \"bi-pencil-square\",\r\n              })}\r\n            {!isModerator\r\n              ? null\r\n              : control({\r\n                formName: \"ModeratorSet\",\r\n                text: \"Change moderator\",\r\n                icon: \"bi-person-lock\",\r\n              })}\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    {editorsFooter}\r\n  </div>\r\n);\r\n\r\nconst navbarButton = ({ content, text, icon }) => (\r\n  <li className=\"nav-item \">\r\n    <a\r\n      className=\"nav-link active button\"\r\n      href={`https://near.social/#/${ownerId}/widget/Index?content=${content}`}\r\n      role=\"button\"\r\n      onClick={() => State.update({ content })}\r\n    >\r\n      <i className={icon} />\r\n      {text}\r\n    </a>\r\n  </li>\r\n);\r\n\r\nconst navbar = (\r\n  <div className=\"card border-secondary\">\r\n    <div className=\"nav navbar navbar-expand-lg bg-body-tertiary\">\r\n      <div className=\"container-fluid\">\r\n        <ul className=\"navbar-nav me-auto mb-2 mb-lg-0\">\r\n          {navbarButton({\r\n            content: \"entities\",\r\n            text: \"Entities\",\r\n            icon: \"bi-house-fill\",\r\n          })}\r\n          {navbarButton({\r\n            content: \"contributors\",\r\n            text: \"Contributors\",\r\n            icon: \"bi-person-plus-fill\",\r\n          })}\r\n          {navbarButton({\r\n            content: \"admin\",\r\n            text: \"Manage entities\",\r\n            icon: \"bi-house-lock-fill\",\r\n          })}\r\n          {navbarButton({\r\n            content: \"needs\",\r\n            text: \"Contribution needs\",\r\n            icon: \"bi-clipboard-check-fill\",\r\n          })}\r\n          {navbarButton({\r\n            content: \"invites\",\r\n            text: \"Contribution invites\",\r\n            icon: \"bi-person-fill-add\",\r\n          })}\r\n          <li className=\"nav-item\">\r\n            <input\r\n              type=\"text\"\r\n              value={state.search}\r\n              placeholder=\"Search\"\r\n              onChange={(e) => State.update({ search: e.target.value })}\r\n            />\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nconst content = {\r\n  entities: (\r\n    <Widget\r\n      src={`${ownerId}/widget/EntityList`}\r\n      props={{ search: state.search }}\r\n    />\r\n  ),\r\n  contributors: (\r\n    <Widget\r\n      src={`${ownerId}/widget/ContributorList`}\r\n      props={{ search: state.search }}\r\n    />\r\n  ),\r\n  admin: (\r\n    <Widget\r\n      src={`${ownerId}/widget/AdminList`}\r\n      props={{ search: state.search }}\r\n    />\r\n  ),\r\n  needs: (\r\n    <Widget\r\n      src={`${ownerId}/widget/NeedList`}\r\n      props={{ search: state.search }}\r\n    />\r\n  ),\r\n  invites: (\r\n    <Widget\r\n      src={`${ownerId}/widget/InviteList`}\r\n      props={{ search: state.search }}\r\n    />\r\n  ),\r\n}[state.content];\r\n\r\nconst tabContent = {\r\n  dashboard: <Widget src={`${ownerId}/widget/Dashboard`} />,\r\n}[state.tab];\r\n\r\nreturn (\r\n  <div className=\"d-flex flex-row\">\r\n    <div className=\"px-1\">\r\n      <Widget\r\n        src={`${ownerId}/widget/Sidebar`}\r\n        props={{ tab: state.tab, update: (tab) => State.update({ tab }) }}\r\n      />\r\n    </div>\r\n    <div className=\"vr mx-2\" />\r\n    <div>\r\n      {tabContent}\r\n      {controls}\r\n      {navbar}\r\n      <div className=\"mt-2\">{content}</div>\r\n    </div>\r\n  </div>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/contribut3.near/widget/Index"}