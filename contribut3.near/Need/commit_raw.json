{"tx_hash": "2yj3AePNGmkuCBk15kw7rDuNDYY4qVTXXMjEpvL1jPSz", "action_id_social": "6EYnRo8CwiVREAgmX8JKM24eZtqXW85AuXxRyGma3r9G-0-widget", "block_id": 85432716, "block_timestamp": "2023-02-17 14:19:11.557", "signer_id": "contribut3.near", "widget_name": "Need", "source_code": "const ownerId = \"contribut3.near\";\r\nconst accountId = props.accountId;\r\nconst notStandalone = props.notStandalone ?? false;\r\nconst isPreview = props.isPreview ?? false;\r\nconst cid = props.cid;\r\n\r\nif (!accountId || !cid) {\r\n  return \"Cannot render contribution need widget without account ID or CID!\";\r\n}\r\n\r\nconst isContributor = Near.view(\r\n  ownerId,\r\n  \"check_is_contributor\",\r\n  { account_id: context.accountId },\r\n  \"final\",\r\n  true\r\n);\r\n\r\nconst contributionNeed = props.isPreview\r\n  ? props.contributionNeed\r\n  : Near.view(\r\n    ownerId,\r\n    \"get_contribution_need\",\r\n    {\r\n      account_id: accountId,\r\n      cid,\r\n    },\r\n    \"final\",\r\n    true\r\n  );\r\n\r\nconst entity = isPreview\r\n  ? props.entity\r\n  : Near.view(ownerId, \"get_entity\", { account_id: accountId }, \"final\");\r\n\r\nif (!entity) {\r\n  return isPreview\r\n    ? \"You must provide a entity object in preview mode\"\r\n    : \"Loading...\";\r\n}\r\n\r\nconst profile = Social.getr(`${accountId}/profile`);\r\n\r\nconst tags = Object.keys(profile.tags ?? {});\r\nconst image = profile.image;\r\nconst url =\r\n  (image.ipfs_cid\r\n    ? `https://ipfs.near.social/ipfs/${image.ipfs_cid}`\r\n    : image.url) || \"https://thewiki.io/static/media/sasha_anon.6ba19561.png\";\r\n\r\nconst circle = (\r\n  <div\r\n    className=\"profile-circle d-inline-block\"\r\n    title={`${profile.name} @${accountId}`}\r\n    style={{ width: \"1.5em\", height: \"1.5em\" }}\r\n  >\r\n    <img\r\n      className=\"rounded-circle w-100 h-100\"\r\n      style={{ objectFit: \"cover\" }}\r\n      src={`https://i.near.social/thumbnail/${url}`}\r\n      alt=\"profile image\"\r\n    />\r\n  </div>\r\n);\r\n\r\nconst body = (\r\n  <div\r\n    className=\"d-flex flex-row justify-content-start\"\r\n    id={accountId}\r\n    style={{ minHeight: \"10em\" }}\r\n  >\r\n    <div className=\"flex-grow-1 py-3\">\r\n      <div className=\"d-flex flex-column justify-content-between align-items-start w-100\">\r\n        <div className=\"w-100 d-flex flex-row justify-content-between align-items-start\">\r\n          <div>{contributionNeed.contribution_type}</div>\r\n          <div\r\n            className={contributionNeed.active ? \"text-success\" : \"text-muted\"}\r\n          >\r\n            {contributionNeed.active ? <i className=\"bi-circle-fill\" /> : <></>}\r\n            <span className=\"ms-1\">\r\n              {contributionNeed.active ? \"Open to proposals\" : \"Closed\"}\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          {circle}\r\n          <b>{entity.name || profile.name}</b>\r\n          <span className=\"text-muted\">@{accountId}</span>\r\n        </div>\r\n        <div className=\"text-truncate text-muted\">\r\n          {tags.length > 0 ? (\r\n            <>\r\n              {tags.map((tag) => (\r\n                <span\r\n                  className=\"d-inline-block mx-1 py-1 px-2 badge border border-secondary text-secondary text-muted text-center\"\r\n                  key={tag}\r\n                >\r\n                  {tag}\r\n                </span>\r\n              ))}\r\n            </>\r\n          ) : (\r\n            <></>\r\n          )}\r\n        </div>\r\n        <div className=\"text-truncate my-2\">{contributionNeed.description}</div>\r\n      </div>\r\n    </div>\r\n    <div className=\"vr mx-3\" />\r\n    <div className=\"d-flex flex-row justify-content-end align-items-start py-3\">\r\n      <a\r\n        className=\"btn btn-outline-secondary me-2\"\r\n        href={`https://near.social/#/${ownerId}/widget/Contributor?accountId=${accountId}`}\r\n      >\r\n        <i className=\"bi-person-plus\" />\r\n        Propose\r\n      </a>\r\n      <a className=\"btn btn-outline-secondary\">\r\n        <i className=\"bi-box-arrow-up-right\" />\r\n      </a>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nreturn (\r\n  <div className=\"card\">\r\n    <div className=\"card-body px-3 py-0\">{body}</div>\r\n  </div>\r\n);\r\n//\r\n// const ownerId = \"contribut3.near\";\r\n// const accountId = props.accountId;\r\n// const cid = props.cid;\r\n//\r\n// initState({\r\n//   description: \"\",\r\n// });\r\n//\r\n// if (!accountId || !cid) {\r\n//   return \"Cannot render contribution need widget without account ID or CID!\";\r\n// }\r\n//\r\n// const isContributor = Near.view(\r\n//   ownerId,\r\n//   \"check_is_contributor\",\r\n//   { account_id: context.accountId },\r\n//   \"final\",\r\n//   true\r\n// );\r\n//\r\n// const contributionNeed = props.isPreview\r\n//   ? props.contributionNeed\r\n//   : Near.view(\r\n//     ownerId,\r\n//     \"get_contribution_need\",\r\n//     {\r\n//       account_id: accountId,\r\n//       cid,\r\n//     },\r\n//     \"final\",\r\n//     true\r\n//   );\r\n//\r\n// if (!contributionNeed) {\r\n//   return props.isPreview\r\n//     ? \"You must provide contribution need object in preview mode!\"\r\n//     : \"Loading...\";\r\n// }\r\n//\r\n// const shareButton = props.isPreview ? null : (\r\n//   <a\r\n//     className=\"card-link\"\r\n//     href={`https://near.social/#/${ownerId}/widget/Need?accountId=${accountId}&cid=${cid}`}\r\n//     role=\"button\"\r\n//     target=\"_blank\"\r\n//     title=\"Open in new tab\"\r\n//   >\r\n//     <div className=\"bi bi-share\" />\r\n//   </a>\r\n// );\r\n//\r\n// const header = (\r\n//   <div className=\"card-header\">\r\n//     <small className=\"text-muted\">\r\n//       <div className=\"row justify-content-between\">\r\n//         <div className=\"col-4\">\r\n//           <Widget src={`mob.near/widget/ProfileLine`} props={{ accountId }} />\r\n//         </div>\r\n//         <div className=\"col-5\">\r\n//           <div className=\"d-flex justify-content-end\">{shareButton}</div>\r\n//         </div>\r\n//       </div>\r\n//     </small>\r\n//   </div>\r\n// );\r\n//\r\n// const needTitle = (\r\n//   <h5 className=\"card-title\">\r\n//     <div className=\"row justify-content-between\">\r\n//       <div className=\"col-9\">\r\n//         Contribution Need for {contributionNeed.contribution_type} -\r\n//         <small>{contributionNeed.active ? \" Active\" : \" Finished\"}</small>\r\n//       </div>\r\n//     </div>\r\n//   </h5>\r\n// );\r\n//\r\n// const description = isPreview\r\n//   ? props.contributionNeed.description\r\n//   : contributionNeed.description;\r\n//\r\n// const descriptionArea = <Markdown className=\"card-text\" text={description} />;\r\n//\r\n// const descriptionDiv = (\r\n//   <div className=\"col-lg-12  mb-2\">\r\n//     <label htmlFor=\"description\">Description for proposal:</label>\r\n//     <textarea\r\n//       id=\"description\"\r\n//       value={state.description}\r\n//       type=\"text\"\r\n//       rows={6}\r\n//       className=\"form-control\"\r\n//       onChange={(event) => State.update({ description: event.target.value })}\r\n//     />\r\n//   </div>\r\n// );\r\n//\r\n// const body = (\r\n//   <div className=\"card-body\">\r\n//     {needTitle}\r\n//     {descriptionArea}\r\n//   </div>\r\n// );\r\n//\r\n// const proposed =\r\n//   Near.view(\r\n//     ownerId,\r\n//     \"check_if_need_proposed\",\r\n//     { entity_id: accountId, contributor_id: context.accountId, cid },\r\n//     \"final\",\r\n//     true\r\n//   ) ?? true;\r\n//\r\n// const footer =\r\n//   !isContributor || isPreview || !contributionNeed.active || proposed ? null : (\r\n//     <div className=\"card-footer\">\r\n//       <div>\r\n//         {descriptionDiv}\r\n//         <a\r\n//           className=\"btn btn-outline-primary mb-2\"\r\n//           onClick={() => {\r\n//             const args = {\r\n//               entity_id: accountId,\r\n//               description: state.description,\r\n//               contribution_type: contributionNeed.contribution_type,\r\n//               need: cid,\r\n//             };\r\n//\r\n//             Near.call(ownerId, \"request_contribution\", args);\r\n//           }}\r\n//         >\r\n//           Propose\r\n//         </a>\r\n//       </div>\r\n//     </div>\r\n//   );\r\n//\r\n// return (\r\n//   <div className={`card my-2`}>\r\n//     {header}\r\n//     {body}\r\n//     {footer}\r\n//   </div>\r\n// );\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/contribut3.near/widget/Need"}