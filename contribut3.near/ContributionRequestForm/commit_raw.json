{"tx_hash": "CLQ1GdZgj5QMsug1tN8gVN1eConeibsymLkyxFUxdYnf", "action_id_social": "DrMoQe6D7MRbFQWUxjqJpuvR3Nt2RY6Gow2joda4xQh1-0-widget", "block_id": 84280432, "block_timestamp": "2023-02-01 12:53:09.901", "signer_id": "contribut3.near", "widget_name": "ContributionRequestForm", "source_code": "const ownerId = \"contribut3.near\";\r\n\r\ninitState({\r\n  // The entity to which to request a contribution.\r\n  entity: props.entity ? [{ name: props.entity }] : [],\r\n  // The description of the contribution request.\r\n  description: props.description ?? \"\",\r\n});\r\n\r\nconst onClick = () => {\r\n  const args = {\r\n    entity_id: state.entity[0].name,\r\n    description: state.description,\r\n  };\r\n\r\n  Near.call(ownerId, \"request_contribution\", args);\r\n};\r\n\r\nconst existingEntities = (\r\n  Near.view(ownerId, \"get_entities\", {}, \"final\") ?? []\r\n).map(([accountId]) => ({ name: accountId }));\r\n\r\nconst entityEditor = (\r\n  <div className=\"col-lg-12  mb-2\">\r\n    <label htmlFor=\"enity-id\">Entity account ID:</label>\r\n    <Typeahead\r\n      id=\"entity-id\"\r\n      labelKey=\"name\"\r\n      onChange={(entity) => State.update({ entity })}\r\n      options={existingEntities}\r\n      placeholder=\"social.near, contribut3.near\"\r\n      selected={state.entity}\r\n      positionFixed\r\n    />\r\n  </div>\r\n);\r\n\r\nconst descriptionDiv = (\r\n  <div className=\"col-lg-12  mb-2\">\r\n    <label htmlFor=\"description\">Description:</label>\r\n    <textarea\r\n      id=\"description\"\r\n      value={state.description}\r\n      type=\"text\"\r\n      rows={6}\r\n      className=\"form-control\"\r\n      onChange={(event) => State.update({ description: event.target.value })}\r\n    />\r\n  </div>\r\n);\r\n\r\nconst header = <div className=\"card-header\">Request contribution</div>;\r\n\r\nconst body = (\r\n  <div className=\"card-body\">\r\n    <div className=\"row\">\r\n      {entityEditor}\r\n      {descriptionDiv}\r\n    </div>\r\n\r\n    <a className=\"btn btn-outline-primary mb-2\" onClick={onClick}>\r\n      Submit\r\n    </a>\r\n  </div>\r\n);\r\n\r\nconst footer = (\r\n  <div className=\"card-footer\">\r\n    Preview:\r\n    <Widget\r\n      src={`${ownerId}/widget/ContributionRequest`}\r\n      props={{\r\n        isPreview: true,\r\n        id: 0, // irrelevant\r\n        contributorId: context.accountId,\r\n        entityId: state.entity[0].name,\r\n        contributionRequest: {\r\n          entity: state.entity[0].name,\r\n          description: state.description,\r\n        },\r\n      }}\r\n    />\r\n  </div>\r\n);\r\n\r\nreturn (\r\n  <div className=\"card\">\r\n    {header}\r\n    {body}\r\n    {footer}\r\n  </div>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/contribut3.near/widget/ContributionRequestForm"}