{"tx_hash": "2uZNu8v5jeGZpV91ERUUJXaEED2KHA3pfPJfuBzxpCmB", "action_id_social": "4w16b58MKVjLnMBkFbGEMxZoLdppUSv7XnBcQBjY1MjS-0-widget", "block_id": 89941712, "block_timestamp": "2023-04-19 12:37:21.917", "signer_id": "contribut3.near", "widget_name": "Inputs.SetUpPermissions", "source_code": "const ownerId = \"contribut3.near\";\nconst onSave = props.onSave ?? (() => { });\n\nState.init({\n  following: [],\n  followingIsFetched: false,\n  value: [],\n  accountsWithPermissions: [],\n  accountsWithPermissionsIsFetched: false,\n})\n\nif (!state.followingIsFetched) {\n  Near.asyncView(\n    \"social.near\",\n    \"get\",\n    { keys: [`${context.accountId}/graph/follow/*`] },\n    \"final\",\n    false,\n  ).then((data) => State.update({\n    following: Object.keys(data[context.accountId].graph.follow).map((name) => ({ name })),\n    followingIsFetched: true,\n  }));\n}\n\nif (!state.accountsWithPermissionsIsFetched) {\n  Near.asyncView(\n    \"social.near\",\n    \"debug_get_permissions\",\n    { account_id: context.accountId },\n    \"final\",\n    false,\n  ).then((data) => State.update({\n    accountsWithPermissions: data.map(([info]) => info).filter((info) => \"AccountId\" in info).map(({ AccountId }) => AccountId),\n    accountsWithPermissionsIsFetched: true,\n  }));\n}\n\nif (!state.followingIsFetched || !state.accountsWithPermissionsIsFetched) {\n  return <>Loading...</>;\n}\n\n\nreturn (<Widget\n  src={`${ownerId}/widget/Inputs.MultiSelect`}\n  props={{\n    label: \"Accounts to add permissions to\",\n    placeholder: \"Add accounts\",\n    options: state.following,\n    value: state.value,\n    onChange: (value) => State.update({ value }),\n  }}\n/>);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/contribut3.near/widget/Inputs.SetUpPermissions"}