{"tx_hash": "2s4ATxCQpFECbHmyiSNGFuYeA8o29fvnFTaDG8C5e6Ld", "action_id_social": "HHJu1WWaLinz3zZvHQYdbQmna2vqBb8qHTUH5YEhCAVi-0-widget", "block_id": 85953570, "block_timestamp": "2023-02-24 17:16:52.851", "signer_id": "contribut3.near", "widget_name": "NeedList", "source_code": "const ownerId = \"contribut3.near\";\r\nconst search = props.search;\r\nconst accountId = props.accountId;\r\nconst isAdmin = props.isAdmin;\r\n\r\nconst needs = accountId\r\n  ? Near.view(\r\n    ownerId,\r\n    isAdmin\r\n      ? \"get_admin_contribution_needs\"\r\n      : \"get_entity_contribution_needs\",\r\n    { account_id: accountId },\r\n    \"final\",\r\n    true\r\n  )\r\n  : Near.view(ownerId, \"get_contribution_needs\", {}, \"final\", true);\r\n\r\nif (!needs) {\r\n  return \"Loading...\";\r\n}\r\n\r\nif (\r\n  (Array.isArray(needs) && needs.length === 0) ||\r\n  Object.keys(needs).length === 0\r\n) {\r\n  return \"Couldn't find any contribution needs!\";\r\n}\r\n\r\nconst allNeeds = isAdmin\r\n  ? needs.filter(([entityId]) => entityId.includes(search))\r\n  : Object.keys(needs)\r\n    .reduce((list, accountIdOrCid) => {\r\n      if (props.accountId) {\r\n        return [\r\n          ...list,\r\n          [props.accountId, accountIdOrCid, needs[accountIdOrCid]],\r\n        ];\r\n      }\r\n\r\n      const entityNeeds = needs[accountIdOrCid];\r\n      const needsList = Object.keys(entityNeeds).map((cid) => [\r\n        accountIdOrCid,\r\n        cid,\r\n        entityNeeds[cid],\r\n      ]);\r\n\r\n      return [...list, ...needsList];\r\n    }, [])\r\n    .filter(\r\n      ([accountId, _, need]) =>\r\n        accountId.includes(search) ||\r\n        need.description.includes(search) ||\r\n        need.contribution_type.includes(search)\r\n    );\r\n\r\nif (!allNeeds || allNeeds.length === 0) {\r\n  return \"No contribution needs found!\";\r\n}\r\n\r\nreturn (\r\n  <>\r\n    {allNeeds.map(([accountId, cid]) => (\r\n      <div key={cid} className=\"mb-2\">\r\n        <Widget\r\n          src={`${ownerId}/widget/Need`}\r\n          props={{\r\n            accountId,\r\n            cid,\r\n            update: props.update,\r\n          }}\r\n        />\r\n      </div>\r\n    ))}\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/contribut3.near/widget/NeedList"}