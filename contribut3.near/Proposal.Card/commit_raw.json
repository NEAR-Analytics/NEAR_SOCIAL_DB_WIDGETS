{"tx_hash": "DQ4ykAb4RjpKBuVMJJb3TCvbXVRPoVwQShZvTKizP7Fh", "action_id_social": "8ouNrh9eAMHJUbvZ3PD1iLJjDT58aGyzdru1HsBXyAqQ-0-widget", "block_id": 90085872, "block_timestamp": "2023-04-21 10:06:32.214", "signer_id": "contribut3.near", "widget_name": "Proposal.Card", "source_code": "const ownerId = \"contribut3.near\";\nconst projectId = props.projectId;\nconst cid = props.cid;\nconst vendorId = props.vendorId;\n\nState.init({\n  request: null,\n  requestIsFetched: false,\n  proposal: null,\n  proposalIsFetched: false,\n  profile: null,\n  profileIsFetched: false,\n  contributions: [],\n  contributionsIsFetched: false,\n});\n\nif (!state.requestIsFetched) {\n  Near.asyncView(\n    ownerId,\n    \"get_request\",\n    { account_id: projectId, cid },\n    \"final\",\n    false\n  ).then((request) => State.update({ request, requestIsFetched: true }));\n}\n\nif (!state.proposalIsFetched) {\n  Near.asyncView(\n    ownerId,\n    \"get_proposal\",\n    { project_id: projectId, vendor_id: vendorId, cid },\n    \"final\",\n    false\n  ).then((proposal) => State.update({ proposal, proposalIsFetched: true }));\n}\n\nif (!state.contributionsIsFetched) {\n  Near.asyncView(\n    ownerId,\n    \"get_vendor_completed_contributions\",\n    { account_id: vendorId },\n    \"final\",\n    false\n  ).then((contributions) =>\n    State.update({ contributions, contributionsIsFetched: true })\n  );\n}\n\nif (!state.profileIsFetched) {\n  Near.asyncView(\n    \"social.near\",\n    \"get\",\n    { keys: [`${vendorId}/profile/**`] },\n    \"final\",\n    false\n  ).then((data) =>\n    State.update({ profile: data[vendorId].profile, profileIsFetched: true })\n  );\n}\n\nif (\n  !state.requestIsFetched ||\n  !state.proposalIsFetched ||\n  !state.profileIsFetched\n) {\n  return <>Loading...</>;\n}\n\nconst Container = styled.div`\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 1em;\n  width: 100%;\n`;\n\nconst Row = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 1em;\n  width: 100%;\n`;\n\nconst Column = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: flex-start;\n  gap: 0.25em;\n  width: 100%;\n`;\n\nconst Description = styled.div`\n  padding-left: 1em;\n  border-left: 3px solid #b2ddff;\n  width: 100%;\n`;\n\nconst RejectButton = styled.button`\n  position: absolute;\n  inset: -20px -20px auto auto;\n  transition: all 0.2s ease-in-out;\n  border: none;\n  background: none;\n\n  &:hover {\n    transform: scale(1.1);\n  }\n`;\n\nconst Price = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-start;\n  gap: 0.125em;\n\n  span:first-child {\n    font-style: normal;\n    font-weight: 400;\n    font-size: 0.75em;\n    line-height: 1em;\n    text-decoration-line: line-through;\n    color: #7e868c;\n  }\n\n  span:last-child {\n    font-style: normal;\n    font-weight: 700;\n    font-size: 0.75em;\n    line-height: 1em;\n    text-decoration-line: none;\n    color: #11181c;\n  }\n`;\n\nconst Detail = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-start;\n  gap: 0.125em;\n  font-style: normal;\n  font-weight: 400;\n  font-size: 0.75em;\n  line-height: 1em;\n  color: #11181c;\n`;\n\nconst price =\n  state.proposal.price !== state.request.budget ? (\n    <>\n      <span>NH {state.request.budget}</span>\n      {\" \u2192 \"}\n      <span>NH {state.proposal.price}</span>\n    </>\n  ) : (\n    <span>NH {state.proposal.price}</span>\n  );\n\nconst body = (\n  <Container>\n    <RejectButton\n      onClick={() =>\n        Near.call(ownerId, \"reject_proposal\", {\n          project_id: projectId,\n          vendor_id: vendorId,\n          cid,\n        })\n      }\n    >\n      <svg\n        width=\"12\"\n        height=\"12\"\n        viewBox=\"0 0 12 12\"\n        fill=\"none\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        <path\n          d=\"M10.5 1.5L1.5 10.5M1.5 1.5L10.5 10.5\"\n          stroke=\"#F44738\"\n          stroke-width=\"1.66667\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n        />\n      </svg>\n    </RejectButton>\n    <Row>\n      <Widget\n        src={`${ownerId}/widget/Vendor.Icon`}\n        props={{ accountId: vendorId, size: \"4em\" }}\n      />\n      <Column>\n        <Widget\n          src={`${ownerId}/widget/NameAndAccount`}\n          props={{\n            accountId: vendorId,\n            name: state.profile.name,\n            nameSize: \"1.125em\",\n          }}\n        />\n        <Row>\n          <span>\n            {state.profile.organization ? \"Organization\" : \"Individual\"}\n          </span>\n          <span>{state.contributions.length} requests completed</span>\n        </Row>\n        <Widget\n          src={`${ownerId}/widget/Tags`}\n          props={{ tags: state.profile.tags }}\n        />\n      </Column>\n    </Row>\n    <Column>\n      <Row>\n        <Price>{price}</Price>\n        <Detail>\n          Contract: <b>{state.proposal.proposal_type}</b>\n        </Detail>\n        <Detail>\n          Payment: <b>{state.proposal.payment_source}</b>\n        </Detail>\n      </Row>\n      <Description>\n        <Widget\n          src={`${ownerId}/widget/DescriptionArea`}\n          props={{ description: state.proposal.description }}\n        />\n      </Description>\n    </Column>\n  </Container>\n);\n\nconst footer = (\n  <Row>\n    <Widget\n      src={`${ownerId}/widget/Buttons.Grey`}\n      props={{ text: \"Discuss\", onClick: () => {} }}\n    />\n    <Widget\n      src={`${ownerId}/widget/Buttons.Green`}\n      props={{\n        text: \"Hire\",\n        onClick: () =>\n          Near.call(ownerId, \"add_contribution\", {\n            project_id: projectId,\n            vendor_id: vendorId,\n            cid,\n          }),\n      }}\n    />\n  </Row>\n);\n\nreturn <Widget src={`${ownerId}/widget/Card`} props={{ body, footer }} />;\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/contribut3.near/widget/Proposal.Card"}