{"tx_hash": "DM5DvU3QEm26LoCPyV8pLccg7zxRZdyxtj1sGnqcD7AE", "action_id_social": "E3fuMVaVq3jXtuweEDJMhLtvaxSZhnKjePXhENhcDPHA-0-widget", "block_id": 85865779, "block_timestamp": "2023-02-23 12:48:32.418", "signer_id": "contribut3.near", "widget_name": "ContributionForm", "source_code": "const ownerId = \"contribut3.near\";\nconst entityId = props.entityId;\nconst contributorId = props.contributorId;\nconst createDate = () => {\n  const date = new Date();\n  const year = date.getFullYear();\n  const month = (date.getMonth() + 1).toString().padStart(2, \"0\");\n  const day = date.getDate().toString().padStart(2, \"0\");\n\n  return `${year}-${month}-${day}`;\n};\n\nState.init({\n  endDate: props.endDate ?? createDate(),\n});\n\nconst onSubmit = () => {\n  const args = {\n    entity_id: entityId,\n    contributor_id: contributorId,\n    end_date: `${new Date(state.endDate).getTime()}`,\n  };\n\n  Near.call(ownerId, \"finish_contribution\", args);\n};\n\nconst existingEntities = (\n  Near.view(ownerId, \"get_entities\", {}, \"final\") ?? []\n).map(([accountId]) => ({ name: accountId }));\n\nconst entityEditor = props.entity ? (\n  <div>\n    <label htmlFor=\"account-id\" className=\"text-muted fw-semibold\">\n      Contribute to:\n    </label>\n    <div\n      className=\"rounded-3 bg-light\"\n      style={{ height: \"5em\" }}\n      id=\"account-id\"\n    >\n      <Widget\n        src={`${ownerId}/widget/ProfileLine`}\n        props={{ accountId: props.entity, imageSize: \"4em\", isEntity: true }}\n      />\n    </div>\n  </div>\n) : (\n  <div className=\"col-lg-12  mb-2\">\n    <label htmlFor=\"enity-id\">Contribute to:</label>\n    <Typeahead\n      id=\"entity-id\"\n      labelKey=\"name\"\n      onChange={(entity) => State.update({ entity })}\n      options={existingEntities}\n      placeholder=\"social.near, contribut3.near\"\n      selected={state.entity}\n      positionFixed\n    />\n  </div>\n);\n\nconst descriptionDiv = (\n  <div className=\"col-lg-12 mb-2\">\n    <Widget\n      src={`${ownerId}/widget/DescriptionInput`}\n      props={{\n        description: state.description,\n        text: \"Details:\",\n        update: (description) => State.update({ description }),\n      }}\n    />\n  </div>\n);\n\nconst contributionTypeInput = (\n  <div className=\"col-lg-12 mb-2\">\n    <Widget\n      src={`${ownerId}/widget/ContributionTypeInput`}\n      props={{\n        contributionType: state.contributionType,\n        update: (contributionType) => State.update({ contributionType }),\n        allContributionTypes,\n      }}\n    />\n  </div>\n);\n\nconst body = (\n  <div className=\"row\">\n    {entityEditor}\n    {contributionTypeInput}\n    {descriptionDiv}\n  </div>\n);\n\nreturn (\n  <Widget\n    src={`${ownerId}/widget/Modal`}\n    props={{\n      title: \"Propose contribution\",\n      confirmText: (\n        <>\n          <i className=\"bi-send\" />\n          <span>Send proposal</span>\n        </>\n      ),\n      onConfirm: onSubmit,\n      hidden: props.hidden,\n      onClose: props.onClose,\n      body,\n      id,\n    }}\n  />\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/contribut3.near/widget/ContributionForm"}