{"tx_hash": "9C1QK9ojkfMp4UGZD5JANbHorJor5XTwsie9DHgZAiJG", "action_id_social": "DGSy9Rjs3v22F6vRTX4ydpCRNMjt7Yg7CBHhbaMzPX6r-0-widget", "block_id": 89955911, "block_timestamp": "2023-04-19 17:13:21.250", "signer_id": "simonemelanie.near", "widget_name": "Test-0", "source_code": "const postsQuery = `\n  query IndexerQuery($offset: Int) {\n    roshaan_near_alphaindexer_posts(order_by: {block_height: desc}, offset: $offset, limit: ${LIMIT}) {\n      content\n    }\n  }\n`;\n\nasync function fetchGraphQL(operationsDoc, operationName, variables) {\n  const response = await fetch(\n    \"https://query-api-hasura-vcqilefdcq-uc.a.run.app/v1/graphql\",\n    {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"x-hasura-role\": \"roshaan_near\",\n      },\n      body: JSON.stringify({\n        query: operationsDoc,\n        variables: variables,\n        operationName: operationName,\n      }),\n    }\n  );\n\n  if (!response.ok) {\n    return null;\n  }\n\n  const responseJson = await response.json();\n  return responseJson;\n}\n\n// Retrieve the latest images from Near Social and display them in a widget\nasync function displayImages() {\n  try {\n    const response = await fetchGraphQL(postsQuery, \"IndexerQuery\", {\n      offset: 0,\n    });\n    if (response === null) {\n      return;\n    }\n\n    const posts = response.data.roshaan_near_alphaindexer_posts;\n    const images = posts\n      .map((post) => {\n        const content = JSON.parse(post.content);\n        if (content.type === \"image\") {\n          return content.src;\n        }\n      })\n      .filter((image) => image !== undefined);\n    const container = document.getElementById(\"image-widget-container\");\n    images.forEach((image) => {\n      const img = document.createElement(\"img\");\n      img.src = \"https://near.social/images/\" + image;\n      container.appendChild(img);\n    });\n  } catch (error) {\n    return;\n  }\n}\n\ndisplayImages();\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/simonemelanie.near/widget/Test-0"}