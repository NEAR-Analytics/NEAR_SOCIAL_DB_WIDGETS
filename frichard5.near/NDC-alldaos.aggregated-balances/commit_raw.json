{"tx_hash": "2WLCJm2FyS3Hhucp82iJ6DmGDiN6cwyktmNiYKY1Gqk8", "action_id_social": "A4rCzrCD2wAFhKaFAKTQ8MZacnYZqiPrBXCUwGdqKUbK-0-widget", "block_id": 92520850, "block_timestamp": "2023-05-23T11:17:48.999Z", "signer_id": "frichard5.near", "widget_name": "NDC-alldaos.aggregated-balances", "source_code": "const {widgetProvider, ftList} = props;\nconst account = props.account || \"foundation.near\";\nconst widgetUrl = `https://api.pikespeak.ai/widgets/balances/`;\nconst balanceUrl = `https://api.pikespeak.ai/account/balances/`;\nconst publicApiKey = \"36f2b87a-7ee6-40d8-80b9-5e68e587a5b5\";\nconst daosList = [\n    \"ndctrust.sputnik-dao.near\",\n    \"marketing.sputnik-dao.near\",\n    \"creativesdao.sputnik-dao.near\",\n    \"neardevgov.sputnik-dao.near\",\n    \"gwg.sputnik-dao.near\",\n];\nconst ftFormatter = (ftList) => {\n    return (data) => {\n        return (\n            <Widget\n                src={`${widgetProvider}/widget/table_ft_formatter`}\n                props={{\n                    ftList,\n                    ft: data[\"contract\"],\n                    amount: data[\"amount\"],\n                    isParsed: true,\n                }}\n            />\n        );\n    };\n};\n\nconst columns = [\n    {\n        id: \"amount\",\n        label: \"\",\n        formatter: ftFormatter(ftList),\n    },\n];\nconst forgeUrl = (apiUrl, params) =>\n    apiUrl +\n    Object.keys(params).sort().reduce(\n        (paramString, p) => paramString + `${p}=${params[p]}&`,\n        \"?\"\n    );\nconst fetchBalances = (params) => {\n    const balances = fetch(forgeUrl(balanceUrl, params), {\n        mode: \"cors\",\n        headers: {\n            \"x-api-key\": publicApiKey,\n        },\n    })\n\n    balances.body && State.update({\n        balances: balances.body,\n    });\n};\n\nfetchBalances({accounts: daosList});\nconst GenericTable = (\n    <Widget\n        src={`${widgetProvider}/widget/generic_table`}\n        props={{\n            title:  state.balances&&`Total: $ ${Number(state.balances.totalUsd).toLocaleString('en-US', {maximumFractionDigits:2})}`,\n            columns,\n            data:  state.balances&&state.balances.balancesTotal,\n        }}\n    />\n);\n\nconst Card = styled.div`\n  box-shadow: 3px 2px 24px rgba(68, 152, 224, 0.3);\n  border-radius: 4px;\n  padding: 20px;\n  margin-top: 40px;`\n\nconst BalanceContainer = styled.div`\n    display: flex;\n    justify-content: space-between;\n`;\n\nconst iframeSrc = forgeUrl(widgetUrl, {accounts: daosList});\n\nreturn (<Card>\n    <h2>Balances</h2>\n    {state.balances&&<BalanceContainer>\n        <iframe\n            style={{\n                width: \"35%\",\n                height: \"420px\",\n                marginTop: \"0px\",\n                overflow: \"none\",\n            }}\n            src={iframeSrc}\n        ></iframe>\n        <div style={{ width: \"40%\" }}>{GenericTable}</div>\n    </BalanceContainer>}\n</Card>)", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/frichard5.near/widget/NDC-alldaos.aggregated-balances", "__row_index": 6}