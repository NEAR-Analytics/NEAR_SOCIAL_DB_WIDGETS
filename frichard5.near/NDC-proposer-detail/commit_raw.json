{"tx_hash": "965edaPbcnFoQqTUmePmXAXb3rCiHz3rrwFxjQKcMTNd", "action_id_social": "DPmrhh1KLyVh6b4GCNheM84qUSDyj4i2psZVYksXfKFv-0-widget", "block_id": 91161392, "block_timestamp": "2023-05-05 15:14:58.042", "signer_id": "frichard5.near", "widget_name": "NDC-proposer-detail", "source_code": "const widgetProvider = props.widgetProvider;\nconst account = props.account || \"marketing.sputnik-dao.near\";\nconst proposer = props.proposer;\nconst apiUrl = `https://api.pikespeak.ai/daos/account-proposal-history/${account}`;\nconst publicApiKey = \"36f2b87a-7ee6-40d8-80b9-5e68e587a5b5\";\nconst resPerPage = 10;\n\nconst DetailWrapper = styled.div`\n  position: relative;\n  height: 370px;\n  width: 80%;\n  margin: 50px auto;\n  box-shadow: 3px 2px 24px rgba(68, 152, 224, 0.3);\n  overflow: auto;\n  border-radius: 4px;\n  padding: 20px;\n  background: white;\n  svg {\n    height: 20px;\n    &.approved-icon {\n      fill:#13a36e;\n    }\n    &.rejected-icon {\n      fill: #ff5e03;\n    }\n    &.not-voted-yet-icon {\n      fill:  rgb(140, 140, 140)\n    }\n  }`;\n\nconst columns = [\n  {\n    id: \"submission_time\",\n    label: \"Date\",\n  },\n  {\n    id: \"proposal_type\",\n    label: \"Type\",\n  },\n  {\n    id: \"proposal_id\",\n    label: \"Proposal id\",\n    formatter: (d) => {\n      return (\n        <a\n          href={`https://near.social/edit#/frichard5.near/widget/NDC-Page?tab=proposal&proposal_id=${d.proposal_id}`}\n          target=\"_blank\"\n        >\n          {d.proposal_id}\n        </a>\n      );\n    },\n  },\n  {\n    id: \"total\",\n    label: \"Details\",\n    formatter: (d) => {\n      const setModal = (d) => {\n        return () => {\n          State.update({\n            isModalOpen: true,\n            currentProposerDetail: d.account,\n          });\n        };\n      };\n      return <button onClick={setModal(d)}>Show</button>;\n    },\n  },\n];\n\nState.init({\n  displayedHistory: [],\n  history: [],\n  offset: 0,\n});\n\nconst nextPage = () => {\n  const currentOffset = state.offset + resPerPage;\n  State.update({\n    offset: currentOffset,\n    displayedHistory: state.history.slice(\n      currentOffset,\n      resPerPage + currentOffset\n    ),\n  });\n};\n\nconst previousPage = () => {\n  const currentOffset = state.offset - resPerPage;\n  State.update({\n    offset: currentOffset,\n    displayedHistory: state.history.slice(\n      currentOffset,\n      resPerPage + currentOffset\n    ),\n  });\n};\n\nconst GenericTable = (\n  <Widget\n    src={`${widgetProvider}/widget/generic_table`}\n    props={{\n      title: \"Proposers\",\n      columns,\n      data: state.displayedHistory,\n      nextPage,\n      previousPage,\n      offset: state.offset,\n      resPerPage,\n    }}\n  />\n);\n\nconst fetchProposerHistory = () => {\n  const history = fetch(apiUrl + `?proposer=${proposer}`, {\n    mode: \"cors\",\n    headers: {\n      \"x-api-key\": publicApiKey,\n    },\n  });\n  history.body &&\n    State.update({\n      displayedHistory: history.body.slice(0, resPerPage),\n      history: history.body,\n    });\n};\n\nfetchProposerHistory();\n\nreturn (\n  <DetailWrapper>\n    <h2>\n      <a\n        href={`https://explorer.near.org/accounts/${proposer}`}\n        target=\"_blank\"\n      >\n        {proposer} proposal history\n      </a>\n    </h2>\n    {state.displayedHistory && GenericTable}\n  </DetailWrapper>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/frichard5.near/widget/NDC-proposer-detail"}