{"tx_hash": "3d8Y3xLzSfMfaWRbzgYZY7BhSqEoYUwAudTt2TDJHsCk", "action_id_social": "rL3gxnB4aFHXW8NZrKYPBhNUCoD89yWWE2ACSSCE3fD-0-widget", "block_id": 90307157, "block_timestamp": "2023-04-24 07:41:19.533", "signer_id": "frichard5.near", "widget_name": "NDC-proposal-card", "source_code": "const proposal = props.proposal;\n\nconst formatCountdown = (seconds) => {\n  const d = Math.floor(seconds / (24 * 3600));\n  const h = Math.floor((seconds - d * 24 * 3600) / 3600);\n  const m = Math.floor((seconds - d * 24 * 3600 - h * 3600) / 60);\n  const s = Math.floor(seconds - d * 24 * 3600 - h * 3600 - m * 60);\n\n  let res = \"\";\n\n  if (d > 0) {\n    res += `${d}d `;\n  }\n\n  if (h > 0) {\n    res += `${h}h `;\n  }\n\n  if (m > 0) {\n    res += `${m}m `;\n  }\n\n  if (!res && s > 0 && s < 60) {\n    res = \"less than a minute\";\n  }\n\n  return res;\n};\n\nconst ProposalCard = styled.div`\n  position: relative;\n  height: 350px;\n  width: 80%;\n  margin: 50px auto;\n  box-shadow: 3px 2px 24px rgba(68, 152, 224, 0.3);\n  overflow: auto;\n  border-radius: 4px;\n  padding: 20px;\n  background: white;\n  svg {\n    height: 20px;\n    &.approved-icon {\n      fill:#13a36e;\n    }\n    &.rejected-icon {\n      fill: #ff5e03;\n    }\n  }\n`;\n\nconst VoteList = styled.div`\n  display:flex;\n  flex-direction:column;\n`;\n\nconst thumbUpSvg = (\n  <svg\n    class=\"approved-icon\"\n    focusable=\"false\"\n    aria-hidden=\"true\"\n    viewBox=\"0 0 24 24\"\n    data-testid=\"ThumbUpIcon\"\n  >\n    <path d=\"M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z\"></path>\n  </svg>\n);\nconst thumbDownSvg = (\n  <svg\n    class=\"rejected-icon\"\n    focusable=\"false\"\n    aria-hidden=\"true\"\n    viewBox=\"0 0 24 24\"\n    data-testid=\"ThumbDownIcon\"\n  >\n    <path d=\"M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z\"></path>\n  </svg>\n);\nconst votes = proposal.proposal.votes;\n\nconst getVoteSvg = (vote) => {\n  switch (vote) {\n    case \"Reject\":\n    case \"Reject=0x1\":\n      return thumbDownSvg;\n    case \"Approve\":\n    case \"Approve=0x0\":\n      return thumbUpSvg;\n  }\n};\n\nconst parseDescription = (description) => {\n  const parsedDesc = description\n    .replaceAll(\"$$$$\", \" \")\n    .replaceAll(\"\\n\\n\", \" \");\n  const parts = parsedDesc.split(\" \");\n\n  const parsedParts = parts.map((p) => {\n    const url = p.match(/https:\\/\\/\\S*/g);\n    if (url) {\n      return (\n        <a href={p} target=\"_blank\">\n          {p}\n        </a>\n      );\n    }\n    return p + \" \";\n  });\n\n  return parsedParts;\n};\n\nconst voteList = votes\n  ? Object.keys(votes).map((voter) => {\n      return (\n        <div>\n          <a\n            href={`https://explorer.near.org/accounts/${voter}`}\n            target=\"_blank\"\n          >\n            {voter}\n          </a>\n          <span>{getVoteSvg(votes[voter])} </span>\n        </div>\n      );\n    })\n  : \"\";\n\nconst Status = styled.div`\n  font-weight: 700;\n  color: ${(props) => {\n    switch (props.status) {\n      case \"Rejected\":\n        return \"#ff5e03\";\n      case \"Approved\":\n        return \"#13a36e\";\n      case \"Expired\":\n        return \"grey\";\n      case \"InProgress\":\n        return \"#ff8743\";\n    }\n  }}\n`;\n\nconst ProposalId = styled.div`\n  color:#8c8c8c;\n  font-size: 11px;\n`;\nconst Label = styled.span`\n  color:#8c8c8c;\n  font-size: 11px;\n`;\n\nconst Header = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n`;\n\nconst InfoWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 8px;\n`;\n\nconst Type = styled.div`\n  font-size: 22px;\n  font-weight: 700;\n  margin-bottom: 10px;\n`;\n\nconst PropInfos = styled.div`\n  float: right;\n  padding: 10px;\n  background: rgba(68, 152, 224, 0.1);\n  border-radius: 4px;\n`;\n\nconst VoteInfos = styled.div`\n  float: right;\n  padding: 10px;\n  background: rgba(68, 152, 224, 0.1);\n  border-radius: 4px;\n`;\n\nconst Description = styled.div`\n  overflow:auto;\n  max-height: 150px;\n`;\n\nif (proposal.status === \"InProgress\") {\n  const timeLeft = formatCountdown(\n    (Date.now() - new Date(proposal.submission_time)) / 1000\n  );\n  console.log(\"TIME LEFT\", timeLeft);\n}\n\nreturn (\n  <ProposalCard>\n    <Header>\n      <Status status={proposal.status}>\n        {proposal.status} <>2d left</>\n      </Status>\n      <ProposalId>Proposal Id {proposal.proposal_id}</ProposalId>\n    </Header>\n    <Type>{proposal.proposal_type}</Type>\n    <PropInfos>\n      <InfoWrapper>\n        <Label>Proposer</Label>\n        <a\n          href={`https://explorer.near.org/accounts/${proposal.proposal.proposer}`}\n          target=\"_blank\"\n        >\n          {proposal.proposal.proposer}\n        </a>\n      </InfoWrapper>\n      <InfoWrapper>\n        <Label>Submission Time</Label>\n        <span>{new Date(proposal.submission_time).toLocaleString()}</span>\n      </InfoWrapper>\n      <InfoWrapper>\n        <Label>Votes</Label>\n        <VoteList>{voteList}</VoteList>\n      </InfoWrapper>\n    </PropInfos>\n    <InfoWrapper>\n      <Label>Description</Label>\n      <Description>\n        {parseDescription(proposal.proposal.description)}\n      </Description>\n    </InfoWrapper>\n  </ProposalCard>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/frichard5.near/widget/NDC-proposal-card"}