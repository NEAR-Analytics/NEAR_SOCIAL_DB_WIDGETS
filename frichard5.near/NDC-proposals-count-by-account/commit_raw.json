{"tx_hash": "DDxacWMWrYFxo7x4NVK28KA6F6GpZKdLSUZkfnwCyV1F", "action_id_social": "4HeDVKhpEABGKutQqZmKKgyUpxGkhg5wUshUBFuz3uFr-0-widget", "block_id": 91076321, "block_timestamp": "2023-05-04 11:47:56.716", "signer_id": "frichard5.near", "widget_name": "NDC-proposals-count-by-account", "source_code": "const widgetProvider = props.widgetProvider;\nconst account = props.account || \"marketing.sputnik-dao.near\";\nconst apiUrl = `https://api.pikespeak.ai/daos/top-proposers/${account}`;\nconst publicApiKey = \"36f2b87a-7ee6-40d8-80b9-5e68e587a5b5\";\nconst resPerPage = 10;\n\nconst columns = [\n  {\n    id: \"account\",\n    label: \"Account\",\n    formatter: (d) => {\n      return (\n        <a\n          href={`https://explorer.near.org/accounts/${d.transaction_view.sender}`}\n          target=\"_blank\"\n        >\n          {d.transaction_view.sender}\n        </a>\n      );\n    },\n  },\n  {\n    id: \"total\",\n    label: \"Total\",\n  },\n];\n\nState.init({\n  displayedProposers: [],\n  proposers: [],\n  offset: 0,\n});\n\nconst nextPage = () => {\n  const currentOffset = state.offset + resPerPage;\n  State.update({\n    offset: currentOffset,\n    displayedProposers: state.proposers.slice(\n      currentOffset,\n      resPerPage + currentOffset\n    ),\n  });\n};\n\nconst previousPage = () => {\n  const currentOffset = state.offset - resPerPage;\n  State.update({\n    offset: currentOffset,\n    displayedProposers: state.proposers.slice(\n      currentOffset,\n      resPerPage + currentOffset\n    ),\n  });\n};\n\nconst GenericTable = (\n  <Widget\n    src={`${widgetProvider}/widget/generic_table`}\n    props={{\n      title: \"Proposers\",\n      columns,\n      data: state.displayedProposers,\n      nextPage,\n      previousPage,\n      offset: state.offset,\n      resPerPage,\n    }}\n  />\n);\n\nconst fetchTopProposers = () => {\n  const proposers = fetch(apiUrl, {\n    mode: \"cors\",\n    headers: {\n      \"x-api-key\": publicApiKey,\n    },\n  });\n  proposers.body &&\n    State.update({\n      proposers: proposers.body.slice(0, resPerPage),\n    });\n};\n\nfetchTopProposers();\n\nconsole.log(state);\n\nreturn <div>{GenericTable}</div>;\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/frichard5.near/widget/NDC-proposals-count-by-account"}