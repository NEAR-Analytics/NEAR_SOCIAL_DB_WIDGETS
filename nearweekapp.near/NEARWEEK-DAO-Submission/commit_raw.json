{"tx_hash": "2pCANKgxFkHe22yuKQvokSgL6zYJGatBG5cW2jtV923Y", "action_id_social": "J8oVqsc5m4X1tauJNDFMj6VjveWQnXEXsR7NfuQ1zTai-0-widget", "block_id": 88800801, "block_timestamp": "2023-04-04 12:46:30.077", "signer_id": "nearweekapp.near", "widget_name": "NEARWEEK-DAO-Submission", "source_code": "let accountId = context.accountId;\n\nif (!accountId) {\n  return \"Please connect your NEAR wallet :)\";\n}\n\nconst convertAmount = (amount, decimals) => {\n  const [whole, fractional] = amount.toString().split(\".\");\n  const wholePart = new BN(whole).mul(new BN(\"10\").pow(new BN(decimals)));\n  if (fractional === undefined) {\n    return wholePart.toString();\n  }\n  const fractionalPart = new BN(fractional).mul(\n    new BN(\"10\").pow(new BN(decimals - fractional.length))\n  );\n  return wholePart.add(fractionalPart).toString();\n};\n\nState.init({\n  recipient: accountId,\n  contract_name: \"nearweek-news-contribution.sputnik-dao.near\",\n  amount: 0.5,\n  deposit: 0.1,\n});\n\nconst onChangeGas = (gas) => {\n  State.update({\n    gas,\n  });\n};\n\nconst onChangeAmount = (amount) => {\n  State.update({\n    amount,\n  });\n};\n\nconst onChangeContract = (contract_name) => {\n  State.update({\n    contract_name,\n  });\n};\n\nconst onChangeRecipient = (recipient) => {\n  State.update({\n    recipient,\n  });\n};\n\nconst onChangeDeposit = (deposit) => {\n  State.update({\n    deposit,\n  });\n};\n\nconst onChangeDescription = (description) => {\n  State.update({\n    description,\n  });\n};\n\nconst onChangeLink = (link) => {\n  State.update({\n    link,\n  });\n};\n\nconst handleProposal = () => {\n  const link = state.link ? state.link.toString() : \"\";\n  const description = `${state.description.trim()}$$$$${link}`;\n  Near.call([\n    {\n      contractName: state.contract_name,\n      methodName: \"add_proposal\",\n      args: {\n        proposal: {\n          description: description,\n          kind: {\n            Transfer: {\n              token_id: \"\",\n              receiver_id: state.recipient.trim().toLowerCase(),\n              amount: convertAmount(state.amount.toString(), 24) ?? 0,\n            },\n          },\n        },\n      },\n      gas: state.gas ?? 200000000000000,\n      deposit:\n        convertAmount(state.deposit.toString(), 24) ?? 100000000000000000000000,\n    },\n  ]);\n};\n\nreturn (\n  <div className=\"mb-3\">\n    <h4 class=\"mb-3\">NEARWEEK DAO Submission</h4>\n    <div class=\"blockquote-footer figcaption\">\n      This is the specialized NEARWEEK Agents Widget. If you are looking for the\n      generic DAO proposal widget, please use:{\" \"}\n      <a\n        href=\"https://near.social/#/nearweekapp.near/widget/Easy-DAO-Payout-Proposal\"\n        target=\"_blank\"\n      >\n        Easy-DAO-Payout-Proposal\n      </a>\n    </div>\n    {/**\n    <div className=\" mb-2\">\n      DAO:\n      <input\n        type=\"text\"\n        placeholder={state.contract_name}\n        onChange={(e) => onChangeContract(e.target.value)}\n      />\n    </div>\n    **/}\n    <div className=\"mb-2\">\n      Description*\n      <textarea\n        value={state.description}\n        type=\"text\"\n        rows={6}\n        className=\"form-control\"\n        placeholder=\"describe your proposal\"\n        onChange={(e) => onChangeDescription(e.target.value)}\n      />\n      <div className=\" mb-2\">\n        Link:\n        <input type=\"text\" onChange={(e) => onChangeLink(e.target.value)} />\n      </div>\n    </div>\n    {/**\n    <div className=\" mb-2\">\n      Payout Amount\n      <input\n        type=\"text\"\n        placeholder=\"0.5\"\n        onChange={(e) => onChangeAmount(e.target.value)}\n      />\n    </div>\n    <div className=\" mb-2\">\n      Payout Recipient\n      <input\n        type=\"text\"\n        placeholder={accountId}\n        onChange={(e) => onChangeRecipient(e.target.value)}\n      />\n    </div>\n    <div className=\" mb-2\">\n      Deposit\n      <input\n        type=\"text\"\n        placeholder=\"0.1\"\n        onChange={(e) => onChangeDeposit(e.target.value)}\n      />\n      <p>\n        You will pay a deposit\n        {state.deposit ? \"of \u24c3\" + state.deposit.toString() : \"\"} to add this\n        proposal!, the deposit will be refunded if proposal rejected or expired.\n      </p>\n    </div>\n    **/}\n    <button className=\"btn btn-primary mt-3\" onClick={handleProposal}>\n      Submit\n    </button>\n  </div>\n);\n", "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearweekapp.near/widget/NEARWEEK-DAO-Submission", "metadata.description": NaN, "metadata.image.ipfs_cid": NaN, "metadata.linktree.website": NaN, "metadata.name": NaN, "metadata": NaN}