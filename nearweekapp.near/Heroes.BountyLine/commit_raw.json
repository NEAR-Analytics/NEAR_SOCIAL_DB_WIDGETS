{"tx_hash": "CBkw6UxmWn6zfU59J83ZsEHx9hQrpxXHBpNCoWRWLN5Y", "action_id_social": "4ARbTnoDBoH3QRnpnY8vGtx2BGmFKV7tDTqPC2weU7SC-0-widget", "block_id": 90578745, "block_timestamp": "2023-04-27 21:59:05.141", "signer_id": "nearweekapp.near", "widget_name": "Heroes.BountyLine", "source_code": "const bounty = props.bounty;\nconst deadline = bounty.deadline;\nconst accountId = bounty.owner;\nconst profile = Social.getr(`${accountId}/profile`);\nconst image = profile.image;\nconst url =\n  (image.ipfs_cid\n    ? `https://ipfs.near.socia/ipfs/${image.ipfs_cid}`\n    : image.url) || \"https://thewiki.io/static/media/sasha_anon.6ba19561.png\";\n\nconst claims = Near.view(props.contract, \"get_bounty_claims_by_id\", {\n  id: props.id,\n});\n\nfunction convertNanoToUnits(nanoseconds) {\n  const seconds = nanoseconds / 1e9;\n  const minutes = seconds / 60;\n  const hours = Math.floor(minutes / 60);\n  const days = Math.floor(hours / 24);\n  const weeks = Math.floor(days / 7);\n  const months = Math.floor(days / 30.44); // Approximate average days per month\n\n  if (months >= 1) {\n    return `${months} months`;\n  } else if (weeks >= 1) {\n    return `${weeks} weeks`;\n  } else if (days >= 1) {\n    return `${days} days`;\n  } else {\n    return `${hours} hours`;\n  }\n}\n\nfunction isBountyClaimed(claims, bounty) {\n  if (claims !== null) {\n    return (\n      claims.some((item) => item[1].status === \"InProgress\") ||\n      bounty.status === \"Completed\" ||\n      bounty.status === \"Claimed\"\n    );\n  }\n}\n\nfunction formatDate(epoch, output) {\n  const dateObj = new Date(epoch / 1000000);\n  let humanDate = null;\n  if (output === \"datetime\") {\n    humanDate = dateObj.toLocaleString();\n  } else {\n    humanDate = dateObj.toLocaleDateString();\n  }\n  return humanDate;\n}\n\nfunction isObjectNotNull(value) {\n  return value !== null && typeof value === \"object\";\n}\n\nconsole.log(deadline);\n\nlet due;\nif (deadline === \"WithoutDeadline\") {\n  due = \"Deadline not specified\";\n} else if (isObjectNotNull(deadline) && isObjectNotNull(deadline.DueDate)) {\n  due = \"Deadline: \" + formatDate(deadline.DueDate.due_date.toString(), \"date\");\n} else if (isObjectNotNull(deadline) && isObjectNotNull(deadline.MaxDeadline)) {\n  due =\n    \"Deadline: \" +\n    convertNanoToUnits(deadline.MaxDeadline.max_deadline).toString();\n} else {\n  due = \"Deadline unknown\";\n}\n\nreturn (\n  <div className=\"text-bg-light rounded-4 p-3 mb-3 border\">\n    {bounty !== null ? (\n      <p>\n        <div class=\"container\">\n          <div class=\"row\">\n            <div class=\"col-sm col-lg-5\">\n              <div class=\"d-flex justify-content-between\">\n                <div class=\"d-flex\">\n                  <div\n                    className=\"profile-image me-2\"\n                    style={{ width: \"3em\", height: \"3em\" }}\n                  >\n                    <img\n                      className=\"rounded w-100 h-100\"\n                      style={{ objectFit: \"cover\" }}\n                      src={url}\n                      alt=\"profile image\"\n                    />\n                  </div>\n\n                  <div className=\"profile-info d-inline-block\">\n                    <div className=\"profile-name\">\n                      {formatDate(bounty.created_at, \"datetime\")}\n                    </div>\n                    <div className=\"profile-name\">{accountId}</div>\n                  </div>\n                </div>\n                <div>\n                  <div class=\"d-flex float-end\">\n                    <span\n                      class={\n                        bounty.status === \"New\"\n                          ? \"bg-warning badge rounded-pill\"\n                          : \"bg-success badge rounded-pill\"\n                      }\n                    >\n                      {bounty.status}\n                    </span>\n                  </div>\n                  <br />\n                  <div class=\"float-end\">\n                    {\" \"}\n                    <span class={\"badge p-2 badge bg-light text-dark\"}>\n                      <div class=\"\"> {due}</div>\n                    </span>{\" \"}\n                  </div>\n                </div>\n              </div>\n              <div class=\"d-flex clearfix\"></div>\n              <hr />\n              <Markdown text={bounty.metadata.description} />\n              <div class=\"text-break\">\n                {/*p class=\"text-break\" style={{ textAlign: \"justify\" }}>\n                  {bounty.metadata.description.replace(/(?:\\r\\n)/g, \"\\n\")}\n                </p>\n                */}\n              </div>\n            </div>\n            <div class=\"p-2 col-sm col-lg-7\">\n              <div class=\"container\">\n                <div class=\"row\">\n                  <div class=\"col-12 col-lg-6 mb-2\">\n                    <Widget\n                      src={`${props.rootUser}/widget/Heroes.ClaimData`}\n                      props={{\n                        amount: bounty.amount,\n                        token: bounty.token,\n                        deadline: bounty.deadline.DueDate.due_date,\n                        bountyClaimed: isBountyClaimed(claims, bounty),\n                        bountyTitle: bounty.metadata.title,\n                        bountyCompleted: bounty.status === \"Completed\",\n                        bountyId: props.id,\n                      }}\n                    />\n                  </div>\n                  <div class=\"col-12 col-lg-6\">\n                    <div class=\"card\">\n                      <div class=\"card-header\">\n                        <h4>Applicants:</h4>\n                      </div>\n                      {claims !== null ? (\n                        <div class=\"card-body\">\n                          {claims.length !== 0 ? (\n                            claims\n                              .slice(0)\n                              .reverse()\n                              .map((claim) => {\n                                return (\n                                  <div>\n                                    <Widget\n                                      src={`${props.rootUser}/widget/Heroes.Profile`}\n                                      props={{\n                                        accountId: claim[0],\n                                        createdAt: claim[1].created_at,\n                                        claimStatus: claim[1].status,\n                                      }}\n                                    />\n                                    <div class=\"d-flex clearfix\"></div>\n                                    <p />\n                                    <div class=\"text-justify text-wrap bd-highlight\">\n                                      <Markdown text={claim[1].description} />\n                                      <div class=\"d-flex clearfix float-end\">\n                                        <a\n                                          href=\"#\"\n                                          class={\n                                            \"btn btn-sm text-warning-emphasis disabled\"\n                                          }\n                                        >\n                                          Accept\n                                        </a>\n                                      </div>\n                                    </div>\n                                    <div class=\"clearfix\"></div>\n                                    <hr />\n                                  </div>\n                                );\n                              })\n                          ) : (\n                            <div>\n                              No one has claimed this bounty yet. Be the first\n                              to seize the opportunity!\n                            </div>\n                          )}\n                        </div>\n                      ) : (\n                        <div>Loading</div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </p>\n    ) : (\n      <div>Loading ...</div>\n    )}\n  </div>\n);\n", "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/nearweekapp.near/widget/Heroes.BountyLine", "metadata.description": "Heroes.BountyLine 0x4 Subcomponent", "metadata.name": "Heroes.BountyLine"}