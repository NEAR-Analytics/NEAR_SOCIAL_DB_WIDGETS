{"tx_hash": "Dergq1NSUXPQAQd2q9483yJ9FBTmytxSHBVfJNDBCEq7", "action_id_social": "CvpXFsZGjptDs2i1z1XpF8odzz9ZaL9ZqpywEHEjcYRJ-0-widget", "block_id": 87361765, "block_timestamp": "2023-03-15 16:13:40.924", "signer_id": "y3k.near", "widget_name": "WAU_PlayEmber", "source_code": "// Monthly Active Accounts Example\nlet rawData = fetch(\n  \"https://github-near-data-api.vercel.app/api/wau_playember\",\n  {\n    subscribe: true,\n    method: \"GET\",\n    headers: {\n      Accept: \"*/*\",\n    },\n  }\n);\n\n// data.body = data.body.sort((a, b) => new Date(a.MONTH) - new Date(b.MONTH));\nconst METRIC_NAME = \"Weekly Active Accounts\";\n\nlet Style = styled.div`\n\n\n      .bar {\n        transition: fill 0.2s;\n      }\n\n      .bar:hover {\n        fill: #ffa726;\n      }\n\n      .bar-chart {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n\n        svg {\n          width: 80%;\n        }\n\n        rect {\n          shape-rendering: crispEdges;\n          fill: #61dafb;\n          stroke: #333;\n          stroke-width: 1;\n        }\n\n\n        `;\n\nconst monthNames = [\n  \"January\",\n  \"February\",\n  \"March\",\n  \"April\",\n  \"May\",\n  \"June\",\n  \"July\",\n  \"August\",\n  \"September\",\n  \"October\",\n  \"November\",\n  \"December\",\n];\n\nconst colorGenerator = () => {\n  const colors = [\n    \"rgb(255, 99, 132)\",\n    \"rgb(75, 192, 192)\",\n    \"rgb(153, 102, 255)\",\n    \"rgb(255, 159, 64)\",\n    \"rgb(54, 162, 235)\",\n    \"rgb(201, 203, 207)\",\n    \"rgb(255, 205, 86)\",\n    \"rgb(255, 99, 71)\",\n    \"rgb(147, 112, 219)\",\n    \"rgb(0, 128, 128)\",\n    \"rgb(100, 149, 237)\",\n    \"rgb(127, 255, 0)\",\n  ];\n\n  let index = 0;\n\n  return () => {\n    if (index >= colors.length) {\n      index = 0;\n    }\n\n    return colors[index++];\n  };\n};\n\nconst getBackgroundColor = colorGenerator();\n\nconst formattedDataWeek = [];\n\nconst months = [\n  \"January\",\n  \"February\",\n  \"March\",\n  \"April\",\n  \"May\",\n  \"June\",\n  \"July\",\n  \"August\",\n  \"September\",\n  \"October\",\n  \"November\",\n  \"December\",\n];\n\nconst getMonth = (date) => {\n  const monthIndex = new Date(date).getMonth();\n  return months[monthIndex];\n};\n\nconst processedData = [];\n\nrawData.body.forEach((datum) => {\n  const month = getMonth(datum.activity_date);\n  const day = new Date(datum.activity_date).getDate();\n  const dayLabel = `${day}st`;\n\n  let monthData = processedData.find((data) => data.label === month);\n  if (!monthData) {\n    monthData = {\n      label: month,\n      data: {},\n      backgroundColor: getBackgroundColor(),\n    };\n    processedData.push(monthData);\n  }\n\n  monthData.data[dayLabel] = datum.wau;\n});\n\nprocessedData.forEach((monthData) => {\n  const sortedData = {};\n  Object.keys(monthData.data)\n    .sort(\n      (a, b) => parseInt(a.replace(\"st\", \"\")) - parseInt(b.replace(\"st\", \"\"))\n    )\n    .forEach((day) => {\n      sortedData[day] = monthData.data[day];\n    });\n  monthData.data = sortedData;\n});\n\nconst v_bar_labels = monthNames;\n\nconst v_bar_data = {\n  v_bar_labels,\n  datasets: processedData,\n};\n\nconst v_bar_options = {\n  responsive: true,\n  plugins: {\n    legend: {\n      position: \"top\",\n    },\n    title: {\n      display: true,\n      text: \"Weekly Active Accounts\",\n    },\n  },\n};\n\nreturn (\n  <Style>\n    <div className=\"text-bg-light rounded-4 p-3 mb-4\">\n      {data !== null ? (\n        <p>\n          <div class=\"\">\n            <div class=\"\">\n              <div>\n                <h2>Metric: {METRIC_NAME}</h2>\n                <BarEl options={v_bar_options} data={v_bar_data} />\n              </div>\n            </div>\n          </div>\n\n          <div></div>\n        </p>\n      ) : (\n        <div>Loading ...</div>\n      )}\n    </div>\n  </Style>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/y3k.near/widget/WAU_PlayEmber"}