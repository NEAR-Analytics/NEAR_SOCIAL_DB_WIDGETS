{"tx_hash": "GCFso3RHJwifM8U5tuSSF9TV57jC8DxpBkKMHvR8twag", "action_id_social": "6dekiGGA7cx3VzECgGie1PhHSq2gE2EQ3gYVxWKhhivy-0-widget", "block_id": 88739084, "block_timestamp": "2023-04-03 17:31:26.415", "signer_id": "y3k.near", "widget_name": "NEART.ATLAS.DETAILED_PROJECT_DASHBOARD", "source_code": "// Monthly Active Accounts Example\n\nlet rawData = fetch(\n  \"https://api.flipsidecrypto.com/api/v2/queries/536ff291-995e-479c-8a45-8c77781aa329/data/latest\",\n  {\n    subscribe: true,\n    method: \"GET\",\n    headers: {\n      Accept: \"*/*\",\n    },\n  }\n);\nconst project_name = props.project_name || \"REF\";\n\nfunction filterByProjectName(arr, project_name) {\n  return arr.filter((obj) => obj.PROJECT_NAME === project_name);\n}\n\nconst METRIC_NAME = `\"${project_name}'s Weekly Active Accounts\"`;\n\nconst filteredData = filterByProjectName(rawData.body, project_name) || [];\n\nfunction sortByActivityDate(arr) {\n  return arr.sort(\n    (a, b) => new Date(a.ACTIVITY_DATE) - new Date(b.ACTIVITY_DATE)\n  );\n}\n\nconst filteredSortedData = sortByActivityDate(filteredData);\n\nconsole.log(filteredSortedData);\n\nlet Style = styled.div`\n        \n        \n              .bar {\n                transition: fill 0.2s;\n              }\n        \n              .bar:hover {\n                fill: #ffa726;\n              }\n        \n              .bar-chart {\n                display: flex;\n                align-items: center;\n                justify-content: center;\n              }\n        \n                svg {\n                  width: 80%;\n                }\n        \n                rect {\n                  shape-rendering: crispEdges;\n                  fill: #61dafb;\n                  stroke: #333;\n                  stroke-width: 1;\n                }\n        \n        \n                `;\n\nconst colorGenerator = () => {\n  const colors = [\n    \"rgb(255, 99, 132)\",\n    \"rgb(75, 192, 192)\",\n    \"rgb(153, 102, 255)\",\n    \"rgb(255, 159, 64)\",\n    \"rgb(54, 162, 235)\",\n    \"rgb(201, 203, 207)\",\n    \"rgb(255, 205, 86)\",\n    \"rgb(255, 99, 71)\",\n    \"rgb(147, 112, 219)\",\n    \"rgb(0, 128, 128)\",\n    \"rgb(100, 149, 237)\",\n    \"rgb(127, 255, 0)\",\n  ];\n\n  let index = 0;\n\n  return () => {\n    if (index >= colors.length) {\n      index = 0;\n    }\n\n    return colors[index++];\n  };\n};\n\nconst months = [\n  \"January\",\n  \"February\",\n  \"March\",\n  \"April\",\n  \"May\",\n  \"June\",\n  \"July\",\n  \"August\",\n  \"September\",\n  \"October\",\n  \"November\",\n  \"December\",\n];\n\n// logic start\nfunction parseUTCDate(dateString) {\n  const [year, month, day] = dateString\n    .split(\"-\")\n    .map((str) => parseInt(str, 10));\n  // Subtract 1 from the month, as JavaScript months are zero-based\n  const utcTimestamp = Date.UTC(year, month - 1, day);\n  return new Date(utcTimestamp);\n}\n\nconst getBackgroundColor = colorGenerator();\n\nlet processedData = [];\n\ntry {\n  filteredSortedData.forEach((datum) => {\n    if (!datum.ACTIVITY_DATE) {\n      return;\n    }\n\n    const activity_date = parseUTCDate(datum.ACTIVITY_DATE);\n\n    const month =\n      months[\n        parseInt(activity_date.toISOString().slice(0, 10).split(\"-\")[1]) - 1\n      ];\n\n    let monthData = processedData.find((data) => data.label === month);\n\n    if (!monthData) {\n      monthData = {\n        label: month,\n        data: {},\n        backgroundColor: getBackgroundColor(),\n      };\n      processedData.push(monthData);\n    }\n\n    monthData.data[activity_date.toISOString().slice(0, 10)] = datum.WAU;\n  });\n} catch (err) {\n  console.log(err);\n}\n\n// logic end\n\nconst v_bar_labels = months;\n\nconst v_bar_data = {\n  v_bar_labels,\n  datasets: processedData,\n};\n\nconst v_bar_options = {\n  responsive: true,\n  plugins: {\n    legend: {\n      position: \"top\",\n    },\n    title: {\n      display: true,\n      text: \"Weekly Active Accounts\",\n    },\n  },\n};\n\nreturn (\n  <Style>\n    <div className=\"text-bg-light rounded-4 p-3 mb-4\">\n      {data !== null ? (\n        <p>\n          <div class=\"\">\n            <div class=\"\">\n              <div>\n                <h2 className=\"text-black\">Metric: {METRIC_NAME}</h2>\n                <BarEl options={v_bar_options} data={v_bar_data} />\n              </div>\n            </div>\n          </div>\n\n          <div></div>\n        </p>\n      ) : (\n        <div>Loading ...</div>\n      )}\n    </div>\n  </Style>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/y3k.near/widget/NEART.ATLAS.DETAILED_PROJECT_DASHBOARD"}