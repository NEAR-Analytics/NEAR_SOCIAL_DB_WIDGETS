{"tx_hash": "HAo2B6KzXivuqYu5mne58HeBdgc8UtMqJX59udXQeaHk", "action_id_social": "NEKDDJCVs3XHv6ceCUPptrRjq92BqUn2e24SxerRsUd-0-widget", "block_id": 90025556, "block_timestamp": "2023-04-20 15:07:02.211", "signer_id": "y3k.near", "widget_name": "NEAR.ATLAS.SOCIAL_DB.DATA_1", "source_code": "let raw_data = fetch(\n  \"https://api.flipsidecrypto.com/api/v2/queries/d0794b08-2c4f-495a-b9f1-76ac0fdcdeef/data/latest\",\n  {\n    subscribe: true,\n    method: \"GET\",\n    headers: {\n      Accept: \"*/*\",\n    },\n  }\n);\n\nconst data = raw_data.body || [];\n\nlet Style = styled.div`\n                `;\n\n// logic start\n\nconst sortedData = data.sort((a, b) => {\n  return new Date(a[\"MONTH\"]) - new Date(b[\"MONTH\"]);\n});\n\nconst dates = data.map((entry) => entry[\"MONTH\"]);\n\n//\n\nconst colorGenerator = () => {\n  const colors = [\n    \"rgb(255, 99, 132)\",\n    \"rgb(75, 192, 192)\",\n    \"rgb(153, 102, 255)\",\n    \"rgb(255, 159, 64)\",\n    \"rgb(54, 162, 235)\",\n    \"rgb(201, 203, 207)\",\n    \"rgb(255, 205, 86)\",\n    \"rgb(255, 99, 71)\",\n    \"rgb(147, 112, 219)\",\n    \"rgb(0, 128, 128)\",\n    \"rgb(100, 149, 237)\",\n    \"rgb(127, 255, 0)\",\n  ];\n\n  let index = 0;\n\n  return () => {\n    if (index >= colors.length) {\n      index = 0;\n    }\n\n    return colors[index++];\n  };\n};\n\nconst getBackgroundColor = colorGenerator();\n\n// console.log(processedData);\n\nfunction convertData(data) {\n  const result = {};\n\n  data.forEach(({ YEAR, MONTH, COMMITS_COUNT }, index) => {\n    if (!result[YEAR.toString()]) {\n      result[YEAR.toString()] = {\n        label: YEAR.toString(),\n        backgroundColor: getBackgroundColor(),\n        data: {},\n      };\n    }\n\n    result[YEAR.toString()].data[MONTH] = COMMITS_COUNT;\n  });\n\n  return result;\n}\n\nconst convertedData = convertData(data);\n\nconst valuesOnly = Object.values(convertedData);\n// console.log(valuesOnly);\n\n// logic part-2\n\nconst stacked_options = {\n  scales: {\n    x: {\n      stacked: true,\n    },\n    y: {\n      stacked: true,\n    },\n  },\n};\n\nconst stacked_bar_data = {\n  dates,\n  datasets: valuesOnly,\n};\n\nreturn (\n  <Style>\n    <div className=\"text-bg-dark container\">\n      {data !== null ? (\n        <div className=\"rounded-4 p-3 mb-4\">\n          <div className=\"\">\n            <BarEl options={stacked_options} data={stacked_bar_data} />\n          </div>\n        </div>\n      ) : (\n        <div>Loading ...</div>\n      )}\n    </div>\n  </Style>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/y3k.near/widget/NEAR.ATLAS.SOCIAL_DB.DATA_1"}