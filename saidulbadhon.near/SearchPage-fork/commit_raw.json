{"tx_hash": "5iySRHMs85VTB8YWXj1LUGQGrbU7KxWoGVYD7n2Va9g4", "action_id_social": "CBfVLtP7YF68jFGamKx7jndBoavB27GbKtCXLzQzRcoV-0-widget", "block_id": 89882561, "block_timestamp": "2023-04-18 17:56:24.949", "signer_id": "saidulbadhon.near", "widget_name": "SearchPage-fork", "source_code": "const limitPerPage = 21;\nlet components = [];\nlet totalComponents = 0;\nconst componentsUrl = \"/adminalpha.near/widget/ComponentsPage\";\n\nState.init({\n  currentPage: 0,\n  selectedTab: props.tab || \"all\",\n});\n\nif (props.tab && props.tab !== state.selectedTab) {\n  State.update({\n    selectedTab: props.tab,\n  });\n}\n\nconst tagsData = Social.get(\"*/widget/*/metadata/tags/*\", \"final\");\n\nconst data = Social.keys(\"*/widget/*\", \"final\", {\n  return_type: \"BlockHeight\",\n});\n\nif (data) {\n  const result = [];\n\n  Object.keys(data).forEach((accountId) => {\n    return Object.keys(data[accountId].widget).forEach((widgetName) => {\n      totalComponents++;\n\n      if (state.selectedTab === \"apps\") {\n        const hasAppTag =\n          tagsData[accountId].widget[widgetName]?.metadata?.tags[\"app\"] === \"\";\n        if (!hasAppTag) return;\n      }\n\n      result.push({\n        accountId,\n        widgetName,\n        blockHeight: data[accountId].widget[widgetName],\n      });\n    });\n  });\n\n  result.sort((a, b) => b.blockHeight - a.blockHeight);\n  components = result.slice(0, state.currentPage * limitPerPage + limitPerPage);\n}\n\nfunction onSearchChange({ result, term }) {\n  console.log(result, term);\n  if (term.trim()) {\n    State.update({ searchResults: result || [] });\n  } else {\n    State.update({ searchResults: null });\n  }\n}\nconst items = state.searchResults || components;\n\nreturn (\n  <div\n    style={{\n      display: \"flex\",\n      flexDirection: \"column\",\n      alignItems: \"flex-start\",\n      gap: 4,\n      width: \"100%\",\n      paddingTop: 4,\n    }}\n  >\n    <div style={{ marginLeft: 4, width: \"calc(100% - 8px)\" }}>\n      <Widget\n        src=\"saidulbadhon.near/widget/SearchPage.Searchbar\"\n        props={{\n          limit: 21,\n          onChange: onSearchChange,\n          theme: props.theme,\n        }}\n      />\n    </div>\n    <div\n      style={{\n        width: \"100%\",\n        display: \"flex\",\n        flexDirection: \"column\",\n        gap: 1,\n      }}\n    >\n      {items.length > 0 &&\n        items?.map((component, index) => (\n          <div key={index}>\n            <Widget\n              src=\"saidulbadhon.near/widget/SearchPage.ComponentItem-fork\"\n              props={{\n                src: `${component.accountId}/widget/${component.widgetName}`,\n                blockHeight: component.blockHeight,\n                theme: props.theme,\n                onDetailsUrlClick: props?.onDetailsUrlClick,\n                onCopyButtonClick: props?.onCopyButtonClick,\n                selectedItem: props.selectedItem,\n              }}\n            />\n          </div>\n        ))}\n    </div>\n  </div>\n);\n", "metadata": null, "branch": NaN, "widget_modules_used": null, "widget_url": "https://near.social/#/saidulbadhon.near/widget/SearchPage-fork", "branch.draft": NaN}