{"tx_hash": "85itjwkxz8XFhTgPr3sef2CbrRAjkdAh9ZvHWeTE9Qaa", "action_id_social": "9Cx8RQ9k3JB7hXMeq8kFtCMGaM73p6HJc9tEv93nDWbw-1-widget", "block_id": 88293996, "block_timestamp": "2023-03-28 11:13:47.017", "signer_id": "jaswinder.near", "widget_name": "MusicPlayer-Harmonic", "source_code": "const accountId = props.accountId || context.accountId;\nconst marketId = \"simple.market.mintbase1.near\";\nconst AFFILIATE_ACCOUNT = props.affiliateAccount || \"jass.near\";\n\nconst data = fetch(\"https://graph.mintbase.xyz\", {\n  method: \"POST\",\n  headers: {\n    \"mb-api-key\": \"omni-site\",\n    \"Content-Type\": \"application/json\",\n    \"x-hasura-role\": \"anonymous\",\n  },\n  body: JSON.stringify({\n    query: `\n      query MyQuery {\n        mb_views_active_listings(limit: 100, order_by: {created_at: desc}, where: {market_id: {_eq: \"simple.market.mintbase1.near\"}, , nft_contract_id: {_eq: \"daorecords.mintbase1.near\"}}) {\n            listed_by\n            created_at\n            price\n            nft_contract_id\n            token_id\n            metadata_id\n            reference_blob(path: \"animation_url\")\n        }\n      }\n`,\n  }),\n});\n\n// const data = fetch(\"https://graph.mintbase.xyz\", {\n//   method: \"POST\",\n//   headers: {\n//     \"mb-api-key\": \"omni-site\",\n//     \"Content-Type\": \"application/json\",\n//     \"x-hasura-role\": \"anonymous\",\n//   },\n//   body: JSON.stringify({\n//     query: `\n//       query MyQuery {\n//         mb_views_nft_tokens(\n//           limit: 10\n//           distinct_on: metadata_id\n//           where: {nft_contract_id: {_eq: \"daorecords.mintbase1.near\"}, reference_blob: {_has_key: \"animation_url\"}}\n//           ) {\n//             nft_contract_id\n//             token_id\n//             metadata_id\n//             reference_blob(path: \"animation_url\")\n//           }\n//         }\n//         `,\n//   }),\n// });\n\n// const YoctoToNear = (amountYocto) =>\n//   new Big(amountYocto).div(new Big(10).pow(24)).toString();\n\n// let buy = (price, token_id, nft_contract_id) => {\n//   const gas = 200000000000000;\n//   const deposit = new Big(price).toFixed(0);\n\n//   Near.call(\n//     marketId,\n//     \"buy\",\n//     {\n//       nft_contract_id: nft_contract_id,\n//       token_id: token_id,\n//       referrer_id: AFFILIATE_ACCOUNT,\n//     },\n//     gas,\n//     deposit\n//   );\n// };\n\nif (!data.ok) {\n  return \"Loading\";\n}\n\nconst size = \"10em\";\nlet audioElem = new Audio();\nfunction playAudio() {\n  audioElem.play();\n}\n\nfunction pauseAudio() {\n  audioElem.pause();\n}\n\nreturn data !== null ? (\n  <>\n    <h1>Muti Marketplace</h1>\n    <p>Buying from this widget will redirect 1.25% of the sale to Jaswinder.</p>\n    <div className=\"d-flex gap-4 flex-wrap\">\n      {data.body.data?.mb_views_active_listings.map((listing, i) => {\n        //const priceYocto = listing.price.toLocaleString().replace(/,/g, \"\");\n        //const priceNear = YoctoToNear(priceYocto);\n        audioElem.src = listing.reference_blob;\n\n        return audioElem.src !== \"https://near.social/null\" ? (\n          <div className=\"d-flex flex-column gap-1\">\n            <a\n              href={`https://mintbase.xyz/meta/${listing.metadata_id}/`}\n              target=\"_blank\"\n            >\n              <Widget\n                src=\"mob.near/widget/NftImage\"\n                props={{\n                  nft: {\n                    tokenId: listing.token_id,\n                    contractId: listing.nft_contract_id,\n                  },\n                  style: {\n                    width: size,\n                    height: size,\n                    objectFit: \"cover\",\n                    minWidth: size,\n                    minHeight: size,\n                    maxWidth: size,\n                    maxHeight: size,\n                    overflowWrap: \"break-word\",\n                  },\n                  thumbnail: \"thumbnail\",\n                  className: \"\",\n                  fallbackUrl:\n                    \"https://ipfs.near.social/ipfs/bafkreihdiy3ec4epkkx7wc4wevssruen6b7f3oep5ylicnpnyyqzayvcry\",\n                }}\n              />\n            </a>\n            {audioElem.src}\n            <button onClick={playAudio}>Play</button>\n            <button onClick={pauseAudio}>Pause</button>\n          </div>\n        ) : (\n          <p>Audio not there</p>\n        );\n      })}\n    </div>\n  </>\n) : (\n  <p>loading...</p>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/jaswinder.near/widget/MusicPlayer-Harmonic"}