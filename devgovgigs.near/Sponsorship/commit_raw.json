{"tx_hash": "BJG8FQzGVwuu3paehUns4MhV7snSXz2dW3bBn5hKzg9s", "action_id_social": "9TqcAwMG6EhrtfePjn88vvCGRyT3wXy4LgXEd2PUWSWC-0-widget", "block_id": 80598879, "block_timestamp": "2022-12-14 02:03:37.604", "signer_id": "devgovgigs.near", "widget_name": "Sponsorship", "source_code": "const ownerId = \"devgovgigs.near\";\nconst sponsorship_id = props.sponsorship.id\n  ? parseInt(props.sponsorship.id)\n  : 0;\nconst sponsorship =\n  props.sponsorship ??\n  Near.view(ownerId, \"get_sponsorship\", { sponsorship_id });\n\nfunction readableDate(timestamp) {\n  var a = new Date(timestamp);\n  return a.toDateString() + \" \" + a.toLocaleTimeString();\n}\n\nconst timestamp = readableDate(\n  sponsorship.timestamp ? sponsorship.timestamp / 1000000 : Date.now()\n);\n\nconst onLike = () => {\n  Near.call(ownerId, \"like\", {\n    post_type: \"Sponsorship\",\n    post_id: sponsorship_id,\n  });\n};\n\nconst commentsUnordered =\n  Near.view(ownerId, \"get_comments\", {\n    post_type: \"Sponsorship\",\n    post_id: sponsorship_id,\n  }) ?? [];\n\nconst comments = props.isPreview ? [] : commentsUnordered.reverse();\nconst containsLike = props.isPreview\n  ? false\n  : sponsorship.likes.find((l) => l.author_id == context.accountId);\nconst likeBtnClass = containsLike ? \"bi bi-heart-fill\" : \"bi bi-heart\";\nconst containsComment = props.isPreview\n  ? false\n  : comments.find((c) => c.author_id == context.accountId);\nconst commentBtnClass = containsComment ? \"bi bi-chat-fill\" : \"bi bi-chat\";\n\nconst buttonsFooter = props.isPreview ? null : (\n  <div class=\"row\">\n    <div class=\"row\">\n      <div class=\"col-2\" onClick={onLike}>\n        <a class={likeBtnClass} role=\"button\">\n          {\" \"}\n          Like ({sponsorship.likes.length ?? 0})\n        </a>\n      </div>\n      <div class=\"col-3\">\n        <a\n          class=\"card-link\"\n          data-bs-toggle=\"collapse\"\n          href={`#collapseCommentEditorSponsorship${sponsorship_id}`}\n          role=\"button\"\n          aria-expanded=\"false\"\n          aria-controls={`collapseCommentEditorSponsorship${sponsorship_id}`}\n        >\n          <i class={commentBtnClass}> </i> Comment ({comments.length ?? 0})\n        </a>\n      </div>\n    </div>\n    <div\n      class=\"collapse\"\n      id={`collapseCommentEditorSponsorship${sponsorship_id}`}\n    >\n      <Widget\n        src={`${ownerId}/widget/CommentEditor`}\n        props={{\n          comment: { post_type: \"Sponsorship\", post_id: sponsorship_id },\n        }}\n      />\n    </div>\n  </div>\n);\n\nconst commentsList =\n  props.isPreview || comments.length == 0 ? null : (\n    <div class=\"row\">\n      <div class=\"row\">\n        <div class=\"col-4\">\n          <a\n            class=\"card-link\"\n            data-bs-toggle=\"collapse\"\n            href={`#collapseCommentsListSponsorship${sponsorship_id}`}\n            role=\"button\"\n            aria-expanded=\"false\"\n            aria-controls={`collapseCommentsListSponsorship${sponsorship_id}`}\n          >\n            <i class=\"bi bi-arrows-angle-expand\"> </i> Expand Comments\n          </a>\n        </div>\n      </div>\n      <div\n        class=\"collapse\"\n        id={`collapseCommentsListSponsorship${sponsorship_id}`}\n      >\n        {comments\n          ? comments.map((comment) => {\n              return (\n                <Widget src={`${ownerId}/widget/Comment`} props={{ comment }} />\n              );\n            })\n          : \"\"}\n      </div>\n    </div>\n  );\n\nconst Card = styled.div`\n  &:hover {\n    box-shadow: rgba(3, 102, 214, 0.3) 0px 0px 0px 3px;\n  }\n`;\n\nreturn (\n  <Card className=\"card my-2 border-success\">\n    <div className=\"card-header\">\n      <small class=\"text-muted\">\n        <div class=\"row justify-content-between\">\n          <div class=\"col-4\">\n            {\" \"}\n            <Widget\n              src={`mob.near/widget/ProfileLine`}\n              props={{ accountId: sponsorship.author_id }}\n            />\n          </div>\n          <div class=\"col-4\">\n            {\" \"}\n            <div class=\"d-flex justify-content-end\">{timestamp}</div>\n          </div>\n        </div>\n      </small>\n    </div>\n    <div className=\"card-body\">\n      <h5 class=\"card-title\">\n        <i class=\"bi bi-cash-coin\"> </i>Sponsorship: {sponsorship.name}\n      </h5>\n      <h6 class=\"card-subtitle mb-2 text-muted\">\n        Maximum amount: {sponsorship.amount} {sponsorship.sponsorship_token}\n      </h6>\n      <h6 class=\"card-subtitle mb-2 text-muted\">\n        Supervisor:{\" \"}\n        <Widget\n          src={`mob.near/widget/ProfileLine`}\n          props={{ accountId: sponsorship.supervisor }}\n        />\n      </h6>\n      <Markdown class=\"card-text\" text={sponsorship.description}></Markdown>\n      {buttonsFooter}\n      {commentsList}\n    </div>\n  </Card>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/devgovgigs.near/widget/Sponsorship"}