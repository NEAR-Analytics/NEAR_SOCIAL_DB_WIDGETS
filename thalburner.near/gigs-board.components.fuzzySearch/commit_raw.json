{"tx_hash": "ELow1sZK99P8z8MQFXS6AsA6PEPgr3N69UDQnoDeZbNj", "action_id_social": "3QShDVGLz6aJt6zViFeC87vbBxEDe4mnmgDXwFhDQKae-0-widget", "block_id": 86583648, "block_timestamp": "2023-03-05 03:21:16.945", "signer_id": "thalburner.near", "widget_name": "gigs-board.components.fuzzySearch", "source_code": "function widget(widgetName, widgetProps, key) {\n  widgetProps = {\n    ...widgetProps,\n    nearDevGovGigsContractAccountId: \"devgovgigs.near\",\n    nearDevGovGigsWidgetsAccountId: \"devgovgigs.near\",\n    referral: props.referral,\n  };\n  return (\n    <Widget\n      src={`devgovgigs.near/widget/gigs-board.${widgetName}`}\n      props={widgetProps}\n      key={key}\n    />\n  );\n}\n\nfunction fuzzySearch(items, keyword) {\n  if (keyword === \"\") {\n    return items;\n  }\n\n  // All common words to be removed from the filter\n  const exclude = [\n    \"a\",\n    \"an\",\n    \"the\",\n    \"and\",\n    \"or\",\n    \"not\",\n    \"is\",\n    \"are\",\n    \"was\",\n    \"were\",\n  ];\n\n  // turns all keywords to lowercase and splits it up into a list of all the words. Will thene xclude all the common words from above.\n  const keywords = keyword\n    .toLowerCase()\n    .split(\" \")\n    .filter((keyword) => !exclude.includes(keyword));\n\n  // Filter the items by searching for each keyword in the name or description fields\n  const filteredItems = items.filter((item) => {\n    const name = item.snapshot.name || \"\";\n    const description = item.snapshot.description || \"\";\n\n    // Check if any of the keywords match the name or description\n    return keywords.some((keyword) => {\n      return (\n        name.toLowerCase().includes(keyword) ||\n        description.toLowerCase().includes(keyword)\n      );\n    });\n  });\n\n  return filteredItems;\n}\n\nconst posts = Near.view(\"devgovgigs.near\", \"get_posts\");\n\nconst loader = (\n  <div className=\"loader\" key={\"loader\"}>\n    <span\n      className=\"spinner-grow spinner-grow-sm me-1\"\n      role=\"status\"\n      aria-hidden=\"true\"\n    />\n    Loading ...\n  </div>\n);\n\nif (posts === null) {\n  return loader;\n}\n\nState.init({\n  postIds: fuzzySearch(posts, \"\"),\n  searchTerm: \"\",\n});\n\nconst DivContainer = styled.div`\n  border: 3px solid #fff;\n    padding: 20px;\n    float: left;\n    width:100%;\n`;\n\nconst DivChild1 = styled.div`\n  width: 75%;\n    float: left;\n    padding: 10px;\n;`;\n\nconst DivChild2 = styled.div`\n  width: 25%;\n    float: left;\n    padding: 10px;\n;`;\n\nreturn (\n  <div>\n    <h1>Fuzzy Search on Gov Gigs Boards Posts by Thalasith and TealWarlock</h1>\n    <DivContainer>\n      <DivChild1>\n        <input\n          onChange={(e) => State.update({ searchTerm: e.target.value })}\n          placeholder=\"Search for keywords like funding or comments in a post's description or name. \"\n        />\n      </DivChild1>\n      <DivChild2>\n        <button\n          onClick={(e) =>\n            State.update({ postIds: fuzzySearch(posts, state.searchTerm) })\n          }\n        >\n          {\" \"}\n          Search\n        </button>\n      </DivChild2>\n    </DivContainer>\n    {state.postIds\n      ? state.postIds.map((item) => {\n          return widget(\n            `components.posts.Post`,\n            {\n              id: item.id,\n              expandable: true,\n              defaultExpanded: false,\n            },\n            item.id\n          );\n        })\n      : \"\"}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/thalburner.near/widget/gigs-board.components.fuzzySearch"}