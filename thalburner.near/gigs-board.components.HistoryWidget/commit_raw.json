{"tx_hash": "DrQ2h3qdGvrgoBgrsG3tgEy9vrXupfJH59CQgvQZ7Fch", "action_id_social": "HtJce9oQ28V1FtP2fS6oWUntyfETgxZbvu31Hc8HfFZu-0-widget", "block_id": 86590404, "block_timestamp": "2023-03-05 05:31:50.953", "signer_id": "thalburner.near", "widget_name": "gigs-board.components.HistoryWidget", "source_code": "function formatDate(timestamp) {\n  const date = new Date(timestamp);\n  const year = date.getFullYear();\n  const month = (date.getMonth() + 1).toString().padStart(2, \"0\");\n  const day = date.getDate().toString().padStart(2, \"0\");\n  const hours = date.getHours().toString().padStart(2, \"0\");\n  const minutes = date.getMinutes().toString().padStart(2, \"0\");\n\n  // Use template literal to construct the formatted string\n  const formatted = `${year}-${month}-${day} ${hours}:${minutes}`;\n\n  return formatted;\n}\n\nconst post = Near.view(\"devgovgigs.near\", \"get_post\", {\n  post_id: props.post_id,\n});\n\nconst history = post.snapshot_history;\n\nhistory.unshift(post.snapshot);\n\nState.init({\n  firstShownHistory: {},\n  secondShownHistory: {},\n  firstShown: false,\n  secondShown: false,\n  changes: [],\n});\n\nconst changeFirstShownHistory = (timestamp) => {\n  State.update({\n    firstShownHistory: history.filter(\n      (item) => item.timestamp === timestamp\n    )[0],\n    firstShown: true,\n  });\n  state.secondShownState &&\n    State.update({\n      changes: summaryOfChanges(),\n    });\n};\n\nconst changeSecondShownHistory = (timestamp) => {\n  console.log(timestamp);\n  console.log(\"before\", state);\n  State.update({\n    secondShownHistory: history.filter(\n      (item) => item.timestamp === timestamp\n    )[0],\n    secondShown: true,\n  });\n  state.firstShownState &&\n    State.update({\n      changes: summaryOfChanges(),\n    });\n};\n\nconst summaryOfChanges = () => {\n  summaryOfChanges = [];\n  if (state.firstShownHistory.editor_id != state.secondShownHistory.editor_id) {\n    summaryOfChanges.push(\"The editors are different.\");\n  }\n  if (state.firstShownHistory.name != state.secondShownHistory.name) {\n    summaryOfChanges.push(\"The names are different.\");\n  }\n  if (\n    state.firstShownHistory.description != state.secondShownHistory.description\n  ) {\n    summaryOfChanges.push(\"The descriptions are different.\");\n  }\n  return summaryOfChanges;\n};\n\nreturn (\n  <div>\n    <div className=\"row\">\n      <div className=\"col-sm row\">\n        <h5>Select a timestamp! </h5>\n        <div>\n          <select\n            className=\"form-select col-sm\"\n            name=\"history_data1\"\n            id=\"history_data1\"\n            form=\"history_data1\"\n            onChange={(e) => changeFirstShownHistory(e.target.value)}\n          >\n            <option>Select a time stamp!</option>\n          </select>\n        </div>\n      </div>\n      <div className=\"col-sm row\">\n        <h5>Select a second timestamp! </h5>\n        <div>\n          <select\n            className=\"form-select col-sm\"\n            name=\"history_data2\"\n            id=\"history_data2\"\n            form=\"history_data2\"\n            onChange={(e) => changeSecondShownHistory(e.target.value)}\n          >\n            <option value=\"\">Select a time stamp!</option>\n          </select>\n        </div>\n      </div>\n    </div>\n    <div className=\"container\" style={{ marginTop: \"24px\" }}>\n      <div className=\"row\">\n        <div className=\"col-lg\">\n          {state.firstShown === true ? (\n            <div>\n              <div style={{ justifyContent: \"space-between\" }}>\n                <div>\n                  <span style={{ fontWeight: \"bold\" }}>Editor:</span>{\" \"}\n                  {state.firstShownHistory.editor_id}\n                </div>\n                <div style={{ marginTop: \"4px\" }}>\n                  <span style={{ fontWeight: \"bold\" }}>Time of Edits: </span>{\" \"}\n                  {formatDate(\n                    parseInt(state.firstShownHistory.timestamp) / 1000000\n                  )}\n                </div>\n              </div>\n              <h4 style={{ marginTop: \"4px\" }}>\n                {state.firstShownHistory.name}\n              </h4>\n              <div style={{ marginTop: \"4px\" }}>\n                {state.firstShownHistory.description}\n              </div>\n              <div\n                style={{\n                  marginTop: \"4px\",\n                  padding: \"4px\",\n                  borderRadius: \"10px\",\n                  backgroundColor: \"lightblue\",\n                  display: \"inline-block\",\n                }}\n              >\n                {state.firstShownHistory.post_type}\n              </div>\n            </div>\n          ) : (\n            <div>Please select a timestamp above!</div>\n          )}\n        </div>\n        <div className=\"col-lg\">\n          {state.secondShown === true ? (\n            <div>\n              <div style={{ justifyContent: \"space-between\" }}>\n                <div>\n                  <span style={{ fontWeight: \"bold\" }}>Editor:</span>{\" \"}\n                  {state.secondShownHistory.editor_id}\n                </div>\n                <div style={{ marginTop: \"4px\" }}>\n                  <span style={{ fontWeight: \"bold\" }}>Time of Edits: </span>{\" \"}\n                  {formatDate(\n                    parseInt(state.secondShownHistory.timestamp) / 1000000\n                  )}\n                </div>\n              </div>\n              <h4 style={{ marginTop: \"4px\" }}>\n                {state.secondShownHistory.name}\n              </h4>\n              <div style={{ marginTop: \"4px\" }}>\n                {state.secondShownHistory.description}\n              </div>\n              <div\n                style={{\n                  marginTop: \"4px\",\n                  padding: \"4px\",\n                  borderRadius: \"10px\",\n                  backgroundColor: \"lightblue\",\n                  display: \"inline-block\",\n                }}\n              >\n                {state.secondShownHistory.post_type}\n              </div>\n            </div>\n          ) : (\n            <div>Please select a timestamp above!</div>\n          )}\n        </div>\n      </div>\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/thalburner.near/widget/gigs-board.components.HistoryWidget"}