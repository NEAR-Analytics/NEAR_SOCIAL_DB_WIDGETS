{"tx_hash": "XXt22mx2dyM64sCxtEtXbXmdScs8rSa1TK3uWDvGR8C", "action_id_social": "HN7W5XN4YXUhqccxynkiQQfbaTVfPSqpZPBhr8Y3cAjR-1-widget", "block_id": 95018997, "block_timestamp": "2023-06-25T19:19:37.147Z", "signer_id": "alantests.near", "widget_name": "Burrito-Virtual-Pet-Mint-2", "source_code": "const virtualPetContract = \"0xF7c0fd237B21a1c41277333C94d1B4a6DB5e0c3e\";\n\nconst virtualPetAbi = fetch(\n  \"https://indigo-fluttering-emu-841.mypinata.cloud/ipfs/QmcNGm5jYV5fp4KqUZ3ew7F5kkPP7tnr6xP8vx5hPmEjhA\"\n);\n\nif (!virtualPetAbi.ok) {\n  return \"Loading\";\n}\n\nconst iface = new ethers.utils.Interface(virtualPetAbi.body);\n\nState.init({\n  init: true,\n  mintedBurritos: 0,\n  burritoName: \"\",\n  minting: false,\n});\n\nif (state.sender === undefined) {\n  const accounts = Ethers.send(\"eth_requestAccounts\", []);\n  if (accounts.length) {\n    State.update({ sender: accounts[0] });\n  }\n}\n\nif (state.sender && state.init) {\n  console.log(\"getMintedTokens()\");\n  const contract = new ethers.Contract(\n    virtualPetContract,\n    virtualPetAbi.body,\n    Ethers.provider().getSigner()\n  );\n\n  // Consultar mascotas minadas\n  contract.getMintedTokens().then((res) => {\n    State.update({\n      mintedBurritos: res.toNumber(),\n    });\n  });\n}\n\n// Mint\nconst mint = () => {\n  const contract = new ethers.Contract(\n    virtualPetContract,\n    virtualPetAbi.body,\n    Ethers.provider().getSigner()\n  );\n\n  contract.mintPet(state.burritoName).then((res) => {\n    const lastId = (state.mintedBurritos += 1);\n    State.update({\n      init: false,\n      burritoName: \"\",\n      mintedBurritos: lastId,\n      minting: true,\n    });\n    setTimeout(() => {\n      contract.getMintedTokens().then((res) => {\n        State.update({\n          //mintedBurritos: res.toNumber(),\n          minting: false,\n        });\n      });\n    }, \"20000\");\n  });\n};\n\nconst ItemBackground = styled.div`\n        width: 100%;\n        //height: 100vh;\n        display: flex;\n        justify-content: center;\n        //background-image: url('https://pin.ski/3XjZcs8');\n        background-repeat: no-repeat;\n        background-size: cover;\n        margin-bottom: -50px;\n        `;\n\nconst ItemContainer = styled.div`\n        margin-top: 30px;\n        box-sizing: border-box;\n        min-width: 320px;\n        max-width: 560px;\n        width: 100%;\n        padding: 0px 32px;\n        position: relative;\n        `;\n\nconst ItemTitle = styled.h3`\n        text-align: center;\n        color: white;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        margin-bottom: 1rem;\n        `;\n\nconst ItemImage = styled.img`\n            width: 40px;\n            margin-right: 15px;\n        `;\n\nconst ItemSubTitle = styled.div`\n        text-shadow: 1px 1px 2px black, 0 0 1em blue, 0 0 0.2em blue;\n        text-align: center;\n        color: yellow;\n        margin-bottom: 5px;\n        `;\n\nconst ItemHeader = styled.div`\n        background: #64473f;\n        font-weight: 400;\n        font-size: 12px;\n        line-height: 1.6em;\n        border-radius: 20px;\n        margin: 0px;\n        padding: 20px;\n        box-shadow: none;\n        color: rgb(255, 255, 255);\n        `;\n\nconst ItemBody = styled.div`\n        font-weight: 400;\n        font-size: 1em;\n        line-height: 1.6em;\n        border-radius: 0px 0px 20px 20px;\n        margin: -20px 0px 0px;\n        padding: 32px;\n        box-shadow: none;\n        background: #feb75b;\n        color: black;\n        `;\n\nconst ItemMintNumber = styled.label`\n        font-size: 20px;\n        font-weight: 800;\n        color: black;\n        `;\n\nconst ItemMintButton = styled.button`\n        background: #f54866;\n        color: white;\n        font-weight: 700;\n        padding: 15px 20px;\n        border-radius: 1rem;\n        border: none;\n        &:hover {\n            background: rgb(146 0 0);\n        }\n        `;\n\n// FETCH CSS\nconst cssFont = fetch(\n  \"https://fonts.googleapis.com/css2?family=Lexend:wght@200;300;400;500;600;700;800\"\n).body;\nconst css = fetch(\n  \"https://indigo-fluttering-emu-841.mypinata.cloud/ipfs/QmRR5YSEY4ot49AGGTY5i7UoyH4FNx7KDRvVjDPuSbzEdn\"\n).body;\n\nif (!cssFont || !css) return \"\";\n\nif (!state.theme) {\n  State.update({\n    theme: styled.div`\n    font-family: Lexend;\n    ${cssFont}\n    ${css}\n`,\n  });\n}\nconst Theme = state.theme;\n\n// Render\nreturn (\n  <Theme>\n    <ItemBackground>\n      <ItemContainer>\n        <ItemHeader>\n          <ItemTitle>\n            <ItemImage src=\"https://pin.ski/3phJiSm\"></ItemImage>\n            <label\n              style={{\n                \"text-shadow\":\n                  \"1px 0px 0px black, 0px 1px 0px black, -1px 0px 0px black, 0px -1px 0px black\",\n              }}\n            >\n              Burrito Virtual Pets\n            </label>\n          </ItemTitle>\n        </ItemHeader>\n        <ItemBody>\n          {state.sender ? (\n            <div class=\"container text-center\">\n              <div>\n                <ItemMintNumber>\n                  Last Burrito Id: {state.mintedBurritos}\n                </ItemMintNumber>\n              </div>\n              <br />\n              {!state.minting ? (\n                <div>\n                  <div>\n                    <input\n                      placeholder=\"Burrito name\"\n                      value={state.burritoName}\n                      onChange={(e) =>\n                        State.update({ burritoName: e.target.value })\n                      }\n                    />\n                  </div>\n                  <br />\n                  <div>\n                    <ItemMintButton\n                      onClick={async () => {\n                        mint();\n                      }}\n                    >\n                      Mint Burrito\n                    </ItemMintButton>\n                    <br /> <br /> <br />\n                    <div>\n                      <a\n                        href=\"#/yairnava.near/widget/Burrito-Virtual-Pet-Interact\"\n                        style={{ color: \"black\" }}\n                      >\n                        Go to Play\n                      </a>\n                    </div>\n                  </div>\n                </div>\n              ) : (\n                <div>\n                  <img\n                    src=\"https://pin.ski/42XCmaZ\"\n                    style={{\n                      height: \"169px\",\n                      background: \"rgb(255, 229, 188)\",\n                      \"border-radius\": \"10px\",\n                    }}\n                  ></img>\n                  <br />\n                  <label style={{ \"font-size\": \"20px\", \"font-weight\": \"400\" }}>\n                    Minting...\n                  </label>\n                </div>\n              )}\n              <br />\n            </div>\n          ) : (\n            <div style={{ \"text-align\": \"center\" }}>\n              <Web3Connect\n                className=\"ConnectButton\"\n                connectLabel=\"Connect with Web3\"\n              />\n            </div>\n          )}\n        </ItemBody>\n      </ItemContainer>\n    </ItemBackground>\n  </Theme>\n);\n", "metadata": {"tags": {"ethdenver2023": ""}}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/alantests.near/widget/Burrito-Virtual-Pet-Mint-2", "__row_index": 0}