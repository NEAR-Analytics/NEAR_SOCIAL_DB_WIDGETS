{"tx_hash": "32Z1k8xsGRVhUbReznDi4pMbakv573UrTJB2y4rWxu1Z", "action_id_social": "HFEGXaAdCMVgNyR3uVkKYznTFXVkBbzRCzPVu6MxHkC3-0-widget", "block_id": 87878966, "block_timestamp": "2023-03-22 15:30:38.817", "signer_id": "rub3n.near", "widget_name": "NearNFTActivity", "source_code": "const query = `\n  query v2_omnisite_GetActivityByUser(\n    $contractAddress: String!\n    $limit: Int!\n  ) {\n    activities: mb_views_nft_activities(\n      order_by: { timestamp: desc }\n      limit: $limit\n      where: {action_sender: { _eq: $contractAddress }}\n    ) {\n      kind\n      description\n      media\n      title\n      timestamp\n      nft_contract_id\n      action_sender\n      receipt_id\n      action_receiver\n      token_id\n      price\n      nft_contract {\n        name\n        id\n        base_uri\n      }\n    }\n    totalItems: mb_views_nft_activities_aggregate(\n      where: { action_sender: { _eq: $contractAddress }}\n    ) {\n      aggregate {\n        count\n      }\n    }\n  }\n`;\nState.init({\n  contractAddress: null,\n  res: null,\n});\n\nfunction fetchService() {\n  asyncFetch(\"https://graph.mintbase.xyz/\", {\n    method: \"POST\",\n    body: JSON.stringify({\n      query: query,\n      variables: { contractAddress: state.contractAddress, limit: 50 },\n    }),\n    headers: {\n      \"content-type\": \"application/json\",\n      \"mb-api-key\": \"omni-site\",\n    },\n  }).then((res) => {\n    State.update({ res: res.body.data });\n  });\n}\n\nfunction handleClick() {\n  fetchService();\n}\n\nconst Pill = styled.div`\n  text-transform:uppercase;\n  color:#ccc;\n  padding:5px;\n  height:25px;\n  border-radius:5px;\n    justify-items:center;\n  align-items:center;\n`;\n\nconst Table = styled.div`\n  background: #1E2030;\n  display:flex;\n  flex-wrap:wrap;\n  border-bottom:1px solid #333;\n  padding:10px;\n    color:#ccc;\n`;\n\nconst Col = styled.div`\n  width: ${(props) => (props.width ? props.width : \"30%\")};\n  margin-right:10px;\n  justify-items:center;\n  align-items:center;\n`;\n\nreturn (\n  <div class=\"flex flex-col items-center justify-center mt-2\">\n    <div class=\"text-3xl\">Check User NFT Activity</div>\n    <div class=\"d-flex flex-column align-items-center\">\n      <input\n        class=\"form-control\"\n        id=\"activitycontract\"\n        type=\"text\"\n        placeholder=\"Type near username\"\n        onChange={(val) => {\n          State.update({ contractAddress: val.target.value });\n        }}\n      />\n      <div>\n        <button\n          onClick={handleClick}\n          class=\"btn btn-outline-secondary border mt-4\"\n          type=\"button\"\n        >\n          Check Activity\n        </button>\n      </div>\n    </div>\n    {state.res.activities ? (\n      <>\n        <br />\n        <Table>\n          {\" \"}\n          <Col width=\"80px\"> Kind </Col> <Col> Image </Col>\n          <Col> Link to MB Nft </Col>\n        </Table>\n        {state.res.activities.map((act) => {\n          const media = act.media.includes(\"https://arweave.net\")\n            ? act.media\n            : `https://image-cache-service-z3w7d7dnea-ew.a.run.app/media?url=https://arweave.net/${act.media}`;\n\n          const contractLink = `https://www.mintbase.xyz/contract/${act.nft_contract_id}/token/${act.token_id}`;\n\n          return (\n            <Table>\n              <Col width=\"80px\">\n                {\" \"}\n                <Pill>\n                  {\" \"}\n                  {act.kind === \"make_offer\" ? \"OFFER\" : act.kind}{\" \"}\n                </Pill>{\" \"}\n              </Col>\n              <Col>\n                <img src={media} width=\"50\" />{\" \"}\n              </Col>\n              <Col>\n                <p>\n                  <a href={contractLink}>{act.title} </a>{\" \"}\n                </p>{\" \"}\n              </Col>\n            </Table>\n          );\n        })}\n      </>\n    ) : null}\n\n    <div>\n      {\" \"}\n      Powered by:{\" \"}\n      <img src=\"https://www.mintbase.xyz/mintbase1.svg\" width=\"70\" />{\" \"}\n    </div>\n  </div>\n);\n", "metadata": NaN, "widget_modules_used": null, "widget_url": "https://near.social/#/rub3n.near/widget/NearNFTActivity", "branch.draft.": NaN, "branch.draft": NaN, "branch": NaN, "metadata.description": NaN, "metadata.image.ipfs_cid": NaN, "metadata.name": NaN, "metadata.tags.mintbase": NaN, "metadata.tags.nft": NaN}