{"tx_hash": "DE1BLq8qi5pTazW29BRampjrjBeVdGdBAnQhPnWfo7Ra", "action_id_social": "HRipDLmZqfeLNmfK8ZJ2Eyv1wsV27GGdfqViB4GJda4M-0-widget", "block_id": 94876929, "block_timestamp": "2023-06-23T23:02:50.513Z", "signer_id": "rubycop.near", "widget_name": "Kudos.Main", "source_code": "let data = Social.index(\"kudo\", \"answer\");\nif (!data) {\n  return \"Loading answers\";\n}\nconst upvotes = Social.index(\"kudo\", \"upvote\");\nif (!upvotes) {\n  return \"Loading upvotes\";\n}\nconst blackList = [\"webuidl.near\"];\ndata = data.filter((d) => !blackList.includes(d.accountId));\n\nlet upvotesMap = {};\nfor (let i = 0; i < upvotes.length; i++) {\n  const vote = upvotes[i];\n  const upvoteBlockHeight = vote.value.blockHeight;\n  if (!upvotesMap[upvoteBlockHeight]) {\n    upvotesMap[upvoteBlockHeight] = 0;\n  }\n  upvotesMap[upvoteBlockHeight] += 1;\n}\n\n// moving into contract in future\n// const fetchKudos = () => {\n//   const items = Near.view(conrtactName, contractMethod);\n//   State.update({ kudos: items });\n// };\n\nconst widgets = {\n  header: \"rubycop.near/widget/Kudos.Header\",\n  filter: \"rubycop.near/widget/Kudos.Filter\",\n  item: \"rubycop.near/widget/Kudos.Kudo.Item\",\n  itemNew: \"rubycop.near/widget/Kudos.Kudo.New\",\n  mintSBT: \"rubycop.near/widget/Kudos.MintSBT\",\n  //   kudoPage: \"rubycop.near/widget/Kudos.Kudo.Page\",\n  //   comment: \"rubycop.near/widget/Kudos.Comment\",\n  //   commentReply: \"rubycop.near/widget/Kudos.Comment.Reply\",\n};\n\nconst Container = styled.div`\n  margin: 20px;\n  padding: 16px;\n  background: #F8F8F9;\n`;\n\nreturn (\n  <>\n    <Widget src={widgets.header} />\n    <Container>\n      <Widget src={widgets.filter} />\n    </Container>\n    <Container className=\"d-grid gap-3\">\n      {data.map((kudo, index) => (\n        <Widget\n          key={index}\n          src={widgets.item}\n          props={{\n            accountId: kudo.accountId,\n            description: kudo.value.answer,\n            upvotes: upvotesMap[kudo.blockHeight]\n              ? upvotesMap[kudo.blockHeight]\n              : 0,\n            tags: kudo.tags ?? [],\n            createdAt: kudo.createdAt ?? 1687561302337,\n          }}\n        />\n      ))}\n    </Container>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/rubycop.near/widget/Kudos.Main", "__row_index": 8}