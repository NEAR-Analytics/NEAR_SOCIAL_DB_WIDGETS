{"tx_hash": "DMVGyRbsUg3cauGhaH1b1n2GQGCA5crRvt4M2ofqFgde", "action_id_social": "FkjQxNuLciUzZjtFZAyjFUGhW1TueEAmhooeRGWeTmcT-0-widget", "block_id": 95303408, "block_timestamp": "2023-06-29T12:32:10.238Z", "signer_id": "rubycop.near", "widget_name": "Kudos.Main", "source_code": "let data = Social.index(\"kudo\", \"answer\");\n\nif (!data) return \"Loading answers\";\n\nconst upvotes = Social.index(\"kudo\", \"upvote\");\nif (!upvotes) return \"Loading upvotes\";\n\nconst blackList = [\"webuidl.near\"];\ndata = data.filter((d) => !blackList.includes(d.accountId));\n\nlet upvotesMap = {};\nfor (let i = 0; i < upvotes.length; i++) {\n  const vote = upvotes[i];\n  const upvoteBlockHeight = vote.value.blockHeight;\n  if (!upvotesMap[upvoteBlockHeight]) {\n    upvotesMap[upvoteBlockHeight] = 0;\n  }\n  upvotesMap[upvoteBlockHeight] += 1;\n}\n\n// moving into contract in future\n// const fetchKudos = () => {\n//   const items = Near.view(conrtactName, contractMethod);\n//   State.update({ kudos: items });\n// };\n\nconst widgets = {\n  header: \"rubycop.near/widget/Kudos.Header\",\n  filter: \"rubycop.near/widget/Kudos.Filter\",\n  navigation: \"rubycop.near/widget/Kudos.Navigation\",\n  item: \"rubycop.near/widget/Kudos.Kudo.Item\",\n  itemNew: \"rubycop.near/widget/Kudos.Kudo.New\",\n  mintSBT: \"rubycop.near/widget/Kudos.MintSBT\",\n  kudoPage: \"rubycop.near/widget/Kudos.Kudo.Page\",\n  // comment: \"rubycop.near/widget/Kudos.Comment\",\n  // commentReply: \"rubycop.near/widget/Kudos.Comment.Reply\",\n};\n\nconst kudosContract = \"kudos-contract.near\";\nconst registryContract = \"registry-unstable.i-am-human.testnet\";\n\nState.init({\n  selectedItem: \"My\",\n  selectedKudo: null,\n});\n\nconst handleSelect = (itemType) => {\n  State.update({ selectedItem: itemType });\n};\n\nconst isIAmHuman = () => {\n  Near.view(registryContract, \"is_human\", { account: context.accountId });\n};\n\nconst Container = styled.div`\n  margin: 20px;\n`;\n\nconst Section = styled.div`\n  padding: 20px;\n  background: #F8F8F9;\n  border-radius: 10px;\n`;\n\nconst CenterSection = styled.div`\n  background: #fff;\n  padding: 20px;\n  border-radius: 10px;\n\n  @media (max-width: 768px) {\n    margin: 20px 0;\n    background: #F8F8F9;\n  }\n`;\n\nconst H5 = styled.h5`\n  margin-bottom: 20px;\n`;\n\nif (state.selectedKudo)\n  return (\n    <Widget\n      key={index}\n      src={widgets.kudoPage}\n      props={{ kudo: state.selectedKudo }}\n    />\n  );\n\nreturn (\n  <div>\n    <Widget src={widgets.header} props={{ isIAmHuman }} />\n    <Container className=\"d-flex row\">\n      <Section className=\"col-md-3\">\n        <H5>Home</H5>\n        <Widget\n          src={widgets.navigation}\n          props={{\n            selectedItem: state.selectedItem,\n            handleSelect,\n          }}\n        />\n      </Section>\n      <CenterSection className=\"col-md-9\">\n        <h4>{state.selectedItem} Kudos</h4>\n\n        <div className=\"d-flex flex-wrap\">\n          {data.map((kudo, index) => (\n            <div\n              onClick={() => State.update({ selectedKudo: kudo })}\n              className=\"col col-md-6 p-3\"\n            >\n              <Widget\n                key={index}\n                src={widgets.item}\n                props={{\n                  isIAmHuman,\n                  replyTo: kudo.id,\n                  accountId: kudo.accountId,\n                  description: kudo.value.answer,\n                  upvotes: upvotesMap[kudo.blockHeight]\n                    ? upvotesMap[kudo.blockHeight]\n                    : 0,\n                  tags: kudo.tags ?? [],\n                  createdAt: kudo.createdAt,\n                }}\n              />\n            </div>\n          ))}\n        </div>\n      </CenterSection>\n    </Container>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/rubycop.near/widget/Kudos.Main", "__row_index": 2}