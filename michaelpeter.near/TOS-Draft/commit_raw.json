{"tx_hash": "imcwL4R2F5MXeWgBzedwg9a95mMsDtqgsMPLUdbe2Rt", "action_id_social": "HVfFRPiusaKnUe8n5FJiUXD78iaCGwQgHfMKsEUaDeQY-0-widget", "block_id": 85740582, "block_timestamp": "2023-02-21 19:53:19.621", "signer_id": "michaelpeter.near", "widget_name": "TOS-Draft", "source_code": "const { tosName, targetComponent, targetProps } = props;\nconst acceptanceKey = `${context.accountId}/${tosName}`;\n\nState.init({ showTos: true });\n\n// find all instances of the user agreeing to some version of the desired TOS\nconst agreementsForUser = Social.index(\"tosAccept\", acceptanceKey);\n\nconst Backdrop = styled.div`\n  height: 100vh;\n  width: 100vw;\n  background-color: rgba(0, 0, 0, 0.5);\n  position: fixed;\n  left: 0;\n  top: 0;\n  z-index: 1001;\n`;\n\nconst Modal = styled.div`\n  height: 80vh;\n  width: 80vw;\n  background-color: white;\n  border-radius: 10px;\n  margin: auto;\n  padding: 3rem;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst ModalContent = styled.div`\nflex-grow:1\n`;\n\nconst ModalFooter = styled.div`\n  height: 3rem;\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n  background-color: aliceblue\n`;\n\nreturn (\n  <div>\n    {agreementsForUser.map((a) => (\n      <span key={a}>{JSON.stringify(a)}</span>\n    ))}\n    <p>hi</p>\n\n    <Backdrop\n      style={{ display: state.showTos ? \"flex\" : \"none\" }}\n      onClick={() => {\n        State.update({ showTos: false });\n      }}\n      className=\"flex\"\n    >\n      <Modal>\n        <ModalContent>\n          <Widget src=\"michaelpeter.near/widget/TosContentDraft\" />\n        </ModalContent>\n        <ModalFooter>\n          <CommitButton\n            data={{\n              tosAccept: {\n                genie: JSON.stringify({\n                  key: acceptanceKey,\n                  value: 1, // TODO blockheight of tos version\n                }),\n              },\n            }}\n          >\n            I Agree\n          </CommitButton>\n        </ModalFooter>\n      </Modal>\n    </Backdrop>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/michaelpeter.near/widget/TOS-Draft"}