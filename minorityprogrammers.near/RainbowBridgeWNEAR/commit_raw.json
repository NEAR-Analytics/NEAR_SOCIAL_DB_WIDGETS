{"tx_hash": "EmNKFMmcsUXZH86fR6gh3fsmkaWJj6hZjJ1QVW4iKEVK", "action_id_social": "A9EKW6KVFHYedgWp5uGzr35PLGc3NMR9A6JBwn5BRQmh-0-widget", "block_id": 87547338, "block_timestamp": "2023-03-18 05:27:45.777", "signer_id": "minorityprogrammers.near", "widget_name": "RainbowBridgeWNEAR", "source_code": "// Define the NEAR account and amount to bridge\nconst amount = \"10000000000000000000000\"; // 0.01 NEAR // maybe off\n// Define the Aurora address to receive the bridged NEAR\nconst accountId = context.accountId; // add check for context it\n\nconst receiver_id = \"aurora\";\nconst contract_name = \"wrap.near\";\nconst auroraAddress = \"0x97B882530830a10f07A9f9A733cB7d0491F808Dc\"; // minority programmersEth address\n\nfunction isEthereumAddress(address) {\n  // Check if the address is a hexadecimal string of 40 characters\n  if (!/^(0x)?[0-9a-f]{40}$/i.test(address)) {\n    return false;\n  }\n\n  // Check if the address has a valid checksum\n  const checksumAddress = toChecksumAddress(address);\n  return address === checksumAddress;\n}\n\nfunction toChecksumAddress(address) {\n  // Remove \"0x\" prefix if it exists\n  const addressWithoutPrefix = address.toLowerCase().replace(/^0x/, \"\");\n\n  // Compute the hash of the lowercase address\n  const hash = web3.utils.sha3(addressWithoutPrefix);\n\n  // Convert the hash to a hex string and compare characters of the address and the hash\n  let checksumAddress = \"0x\";\n  for (let i = 0; i < addressWithoutPrefix.length; i++) {\n    if (parseInt(hash[i], 16) >= 8) {\n      checksumAddress += addressWithoutPrefix[i].toUpperCase();\n    } else {\n      checksumAddress += addressWithoutPrefix[i];\n    }\n  }\n\n  return checksumAddress;\n}\ninitState({\n  amount: amount,\n  ethereum_receiver: auroraAddress,\n  valid_address: true,\n});\n\nconst onChangeAddress = (ethereum_receiver) => {\n  state.valid_address = isEthereumAddress(ethereum_receiver);\n  console.log(state.valid_address); // checking if i updated correctly\n  State.update({\n    ethereum_receiver,\n  });\n}; // add helper function for proper ethereum addresses\n\nconst onChangeAmount = (amount) => {\n  State.update({\n    amount,\n  });\n};\n\n// improve this so it shows in same transaction\nconst bridge = () => {\n  if (!(accountId && state.amount && state.ethereum_receiver)) {\n    return;\n  }\n  const gas = 200000000000000;\n  const deposit = 1; // exactly 1 yocto\n  Near.call([\n    {\n      contractName: \"wrap.near\",\n      methodName: \"near_deposit\",\n      args: {},\n      gas,\n      deposit: state.amount,\n    },\n    {\n      contractName: contract_name,\n      // need to wrap first with near_deposit\n      methodName: \"ft_transfer_call\",\n      args: {\n        receiver_id: \"aurora\",\n        amount: state.amount,\n        memo: null,\n        msg: state.ethereum_receiver,\n        //   msg: \"0x97B882530830a10f07A9f9A733cB7d0491F808Dc\",\n      },\n      gas: gas,\n      deposit: 1, // may take this out\n    },\n  ]);\n};\nreturn (\n  <div>\n    <h1>\ud83c\udf08 Send NEAR to Aurora Address </h1>\n    <div className=\" mb-2\">\n      Aurora Address to Bridge To\n      <input\n        type=\"text\"\n        placeholder={state.ethereum_receiver}\n        onChange={(e) => onChangeAddress(e.target.value)}\n      />\n    </div>{\" \"}\n    {(state.valid_address && (\n      <div className=\"alert alert-success\">\n        <i className=\"bi bi-x\"></i> Aurora (ETH) Address is valid\n      </div> // this conditional isnt working to check valid adress on the front end\n    )) || (\n      <div className=\"alert alert-danger\">\n        <i className=\"bi bi-x\"></i> Not an Aurora (ETH) Address\n      </div>\n    )}\n    <div className=\" mb-2\">\n      Enter Amount of NEAR to Bridge\n      <input\n        type=\"number\"\n        placeholder={state.amount / 1e24}\n        onChange={(e) => onChangeAmount(e.target.value * 1e24)} // maybe 1e24 degen match\n      />\n      <p>\n        * You will pay some extra gas in \u24c3 to bridge and the asset will be\n        wrapped NEAR on Aurora\n      </p>\n    </div>\n    <button className=\"btn btn-primary mt-3\" onClick={bridge}>\n      Bridge\n    </button>\n  </div>\n);\n", "metadata": NaN, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/minorityprogrammers.near/widget/RainbowBridgeWNEAR", "metadata.description": NaN, "metadata.image.ipfs_cid": NaN, "metadata.linktree.website": NaN, "metadata.name": NaN, "metadata.tags.app": NaN, "metadata.tags.aurora": NaN, "metadata.tags.bridge": NaN, "metadata.tags.ethereum": NaN, "metadata.tags.rainbow": NaN, "metadata.tags.rainbow-bridge": NaN, "metadata.tags.wnear": NaN, "metadata.tags.wrap-near": NaN}