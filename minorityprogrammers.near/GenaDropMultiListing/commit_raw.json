{"tx_hash": "C2C2PfJcBibaaaDbprGv815jL34coUtg6SFNTq63kRYb", "action_id_social": "s8YPqYUA1p2cnVwAXnBa5Yf13QYxsGi6XLsceqzKhsV-0-widget", "block_id": 87554716, "block_timestamp": "2023-03-18 07:48:49.722", "signer_id": "minorityprogrammers.near", "widget_name": "GenaDropMultiListing", "source_code": "// NEED TO ADD CONDITIONALS FOR MARKETPLACE LISITNG AND FEW AND FAR, NEED TO FIX SCIENTIFIC NOTION ON PRICE //  ADD ERROR CHECKING for nft contract but preview is enough\n// Define the NEAR amount to list at\nconst amount = \"10000000000000000000000\"; // 0.01 NEAR // maybe off\nconst accountId = context.accountId; // add check for context it\n\nconst nft = props.nft ?? {\n  contractId: props.contractId,\n  tokenId: props.tokenId,\n};\nconst contractId = \"genadrop-contract.nftgen.near\"; // pass as\n// error for serialization of reciever id, maybe need a buffer\nconst tokenId = \"1679119560198\"; // maybe condtional check if props is eempty\nconst fewfarmarket = \"market.fewandfar.near\";\nconst tradeportmarket = \"market.tradeport.near\";\nconst msg =\n  '{\"price\":' +\n  '\"' +\n  amount +\n  '\"' +\n  ',\"market_type\":\"sale\",\"ft_token_id\":\"near\"}';\n\ninitState({\n  contractId: contractId,\n  tokenId: tokenId,\n  fewfar: false,\n  tradeport: true,\n  amount: amount,\n  msg: msg,\n});\n\nconst onChangeAmount = (amount) => {\n  const msgConcat =\n    '{\"price\":' +\n    '\"' +\n    amount +\n    '\"' +\n    ',\"market_type\":\"sale\",\"ft_token_id\":\"near\"}';\n  console.log(msgConcat);\n  State.update({\n    amount,\n    msg: msgConcat,\n  });\n};\n\nconst onChangeMsg = () => {\n  State.update({\n    msg: msg,\n  });\n};\n\nconst onChangeContract = (contractId) => {\n  State.update({\n    contractId,\n  });\n};\n\nconst onChangeToken = (tokenId) => {\n  State.update({\n    tokenId,\n  });\n};\n\n// add conditions based on marketplace booleans\n// improve this so it shows in same transaction\nconst list = () => {\n  if (!accountId) {\n    return;\n  }\n  // need to buffer serialize arguments, add helper functions with state arguments\n  const gas = 100000000000000; // 100 tGas\n  //   const deposit = 1; // exactly 1 yocto\n  const deposit = 10000000000000000000000; // 0.01 near\n  Near.call([\n    {\n      contractName: tradeportmarket,\n      methodName: \"storage_deposit\",\n      args: {\n        receiver_id: context.accountId,\n      },\n      gas,\n      deposit: deposit,\n    },\n    {\n      contractName: state.contractId,\n      // need to wrap first with near_deposit\n      methodName: \"nft_approve\",\n      args: {\n        token_id: state.tokenId,\n        account_id: tradeportmarket,\n        msg: state.msg, // need to add the variables and buffer seerailize\n      },\n      gas: gas,\n      deposit: deposit, // may take this out\n    },\n  ]);\n};\nconst selectFewFar = () => {\n  State.update({\n    fewfar: !state.fewfar,\n  });\n};\nconst selectTradeport = () => {\n  State.update({\n    tradeport: !state.tradeport,\n  });\n};\n\n// nneed to add checkbox for which marketplaces\nreturn (\n  <div>\n    <h1> \ud83d\udecd\ufe0f List NFT to Multiple Marketplaces </h1>\n    <h3>\ud83d\udca7 by GenaDrop</h3>\n    <div className=\"row\">\n      <div className=\"col-lg-6 mb-2\">\n        ContractID\n        <input\n          type=\"text\"\n          placeholder={state.contractId}\n          onChange={(e) => onChangeContract(e.target.value)}\n        />\n      </div>\n      <div className=\"col-lg-6 mb-2\">\n        Token ID\n        <input\n          type=\"text\"\n          placeholder={state.tokenId}\n          onChange={(e) => onChangeToken(e.target.value)}\n        />\n      </div>\n    </div>\n    <Widget\n      src=\"mob.near/widget/NftImage\"\n      props={{\n        nft: { tokenId: state.tokenId, contractId: state.contractId },\n        className: \"img-fluid\",\n      }}\n    />\n    <div className=\"row\">\n      <div className=\"col-lg-6 mb-2\">\n        <div className=\"form-check\">\n          <input\n            className=\"form-check-input\"\n            type=\"checkbox\"\n            checked={state.fewfar}\n            onChange={selectFewFar}\n            id=\"fewfarbox\"\n          />\n          <label className=\"form-check-label\" htmlFor=\"myCheckbox\">\n            List to Few and Far\n          </label>\n        </div>\n        <p>\n          Listing to Few and Far is {state.fewfar ? \"checked\" : \"unchecked\"}.\n        </p>\n      </div>\n      <div className=\"col-lg-6 mb-2\">\n        <div className=\"form-check\">\n          <input\n            className=\"form-check-input\"\n            type=\"checkbox\"\n            checked={state.tradeport}\n            onChange={selectTradeport}\n            id=\"tradeportbox\"\n          />\n          <label className=\"form-check-label\" htmlFor=\"myCheckbox\">\n            List to Tradeport\n          </label>\n        </div>\n        <p>\n          Listing to Tradeport is {state.tradeport ? \"checked\" : \"unchecked\"}.\n        </p>\n      </div>\n    </div>\n    <div className=\" mb-2\">\n      Enter Price Your Want to List (In NEAR)\n      <input\n        type=\"number\"\n        placeholder={state.amount / 1e24}\n        onChange={(e) => onChangeAmount(e.target.value * 1e24)} // maybe 1e24 degen match\n      />\n      <p>\n        * You will pay some gas in \u24c3 to deposit NEAR to marketplace address then\n        list your NFT\n      </p>\n    </div>\n    <button className=\"btn btn-primary mt-3\" onClick={list}>\n      Bridge\n    </button>\n  </div>\n);\n", "branch": NaN, "widget_modules_used": null, "widget_url": "https://near.social/#/minorityprogrammers.near/widget/GenaDropMultiListing", "metadata.name": "GenaDrop NFT", "metadata": NaN, "metadata.description": "List a NFT you own to multiple marketplaces at the same time including Tradeport & Few and Far.\n\nReach out to GenaDrop or fork this widget to add additional markets.", "metadata.image.nft.contractId": "genadrop-contract.nftgen.near", "metadata.image.nft.tokenId": "1679119560198", "metadata.linktree.website": "genadrop.io", "metadata.tags.few-and-far": "", "metadata.tags.fewfar": "", "metadata.tags.genadrop": "", "metadata.tags.listing": "", "metadata.tags.nft": "", "metadata.tags.nft-approve": "", "metadata.tags.nft-listing": "", "metadata.tags.nft-marketplace": "", "metadata.tags.tradeport": "", "branch.draft": NaN}