{"tx_hash": "3kvPFMt5JYhe1rQTUoE2tFD1eGvo4xAU1t8kR6Vi19Ui", "action_id_social": "8fD2w6qPmxQaAcEWTdbLZHhTGP2DaBVnMnYHgosJyniU-0-widget", "block_id": 80891027, "block_timestamp": "2022-12-18 00:45:47.237", "signer_id": "zavodil.near", "widget_name": "owned-social-avatars", "source_code": "let appName = \"avtr\";\nlet ownerId = \"zavodil.near\";\nlet userId = context.accountId;\nlet contractId = \"avtr.near\";\n\nconst owned_tokens = Near.view(contractId, \"nft_tokens_for_owner\", {\n  account_id: userId,\n});\n\nconsole.log(owned_tokens);\n\nif (owned_tokens == undefined) {\n  return \"\";\n}\n\nif (!owned_tokens.length) {\n  return \"Loading\";\n}\n\nlet tokenImg = styled.img`\nwidth: 100px;\nheight: 100px;\n    `;\n\nlet previews = [];\nlet modals = [];\n\nowned_tokens.map((token) => {\n  let price = 0;\n  try {\n    price = new Big(JSON.parse(token.metadata.extra).mint_price)\n      .div(new Big(10).pow(24))\n      .toFixed(0);\n  } catch (e) {\n    console.log(e);\n  }\n\n  previews.push(\n    <tokenImg\n      src={token.metadata.media}\n      class=\"float-start\"\n      type=\"button\"\n      data-bs-toggle=\"modal\"\n      data-bs-target={`#token-${token.token_id}`}\n    />\n  );\n\n  modals.push(\n    <div\n      class=\"modal fade\"\n      id={`token-${token.token_id}`}\n      tabindex=\"-1\"\n      aria-labelledby={`token-${token.token_id}Label`}\n      aria-hidden=\"true\"\n    >\n      <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\" id={`token-${token.token_id}Label`}>\n              Token {token.token_id}\n              {price > 0 && (\n                <span class=\"ms-1 badge bg-success\">\n                  Mint Price: {price} NEAR\n                </span>\n              )}\n            </h5>\n            <button\n              type=\"button\"\n              class=\"btn-close\"\n              data-bs-dismiss=\"modal\"\n              aria-label=\"Close\"\n            ></button>\n          </div>\n          <div class=\"modal-body\">\n            <img src={token.metadata.media} />\n          </div>\n          <div class=\"modal-footer\">\n            <button\n              type=\"button\"\n              class=\"btn btn-secondary\"\n              data-bs-dismiss=\"modal\"\n            >\n              Close\n            </button>\n            <CommitButton\n              data={{\n                profile: {\n                  image: {\n                    url: null,\n                    nft: {\n                      contractId,\n                      tokenId: token.token_id,\n                    },\n                  },\n                },\n              }}\n            >\n              Set profile picture\n            </CommitButton>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n});\n\nreturn (\n  <>\n    <div class=\"text-center\">\n      <h4>Social Avatars you owned</h4>\n      <div>{previews}</div>\n    </div>\n    {modals}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/zavodil.near/widget/owned-social-avatars"}