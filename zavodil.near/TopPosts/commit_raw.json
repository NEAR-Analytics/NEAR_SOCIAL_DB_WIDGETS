{"tx_hash": "BhzxhbjTA25WFR9VrX2b2qYv8JgNQM7hsyGX3AQwoS1", "action_id_social": "GYCS3KqvPnuw63YZe5QGeEAk85z6a1iwud4Vfg2wmHk2-0-widget", "block_id": 90336103, "block_timestamp": "2023-04-24 17:03:32.845", "signer_id": "zavodil.near", "widget_name": "TopPosts", "source_code": "const limitForPosts = props.limitForPosts ?? 5000;\ninitState({ postsByReposts: [] });\n\nconst index = {\n  action: \"repost\",\n  key: \"main\",\n  options: {\n    subscribe: false,\n    limit: limitForPosts,\n    order: \"desc\",\n  },\n};\n\nif (!state.reposts) {\n  State.update({\n    reposts: Social.index(index.action, index.key, index.options),\n  });\n  return \"\";\n}\n\nlet postsByReposts = [];\nstate.reposts.map((repost) => {\n  const key = JSON.stringify(repost.value.item);\n  postsByReposts[key] = (postsByReposts[key] ?? 0) + 1;\n});\n\nconst sortedPosts = Object.keys(postsByReposts).sort(\n  (a, b) => postsByReposts[b] - postsByReposts[a]\n);\n\nconst topPosts = sortedPosts.map((postStringified) => {\n  const post = JSON.parse(postStringified);\n  return (\n    <div style={{ paddingBottom: \"10px\" }}>\n      <Widget\n        src=\"zavodil.near/widget/MainPage.Post\"\n        props={{\n          accountId: post.path.replace(\"/post/main\", \"\"),\n          blockHeight: post.blockHeight,\n          repostsNum: postsByReposts[postStringified],\n        }}\n      />\n    </div>\n  );\n});\n\nreturn (\n  <>\n    <h1>Top posts by reposts</h1>\n    {topPosts}\n  </>\n);\n", "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/zavodil.near/widget/TopPosts", "metadata.image.ipfs_cid": NaN, "metadata.name": NaN, "metadata.tags.app": NaN, "metadata": NaN}