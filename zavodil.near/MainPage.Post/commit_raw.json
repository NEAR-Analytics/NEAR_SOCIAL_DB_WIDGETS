{"tx_hash": "2Ru88aDVyDKfvuJA4TpJcKTjPP2CX9FnNqHDdrpV4iuB", "action_id_social": "Di1D1d3GT1Nzro1prA4evEjTwANRJ6JuWDYcEyPnxkhW-0-widget", "block_id": 88431028, "block_timestamp": "2023-03-30 10:10:24.151", "signer_id": "zavodil.near", "widget_name": "MainPage.Post", "source_code": "const accountId = props.accountId;\nconst blockHeight = parseInt(props.blockHeight);\nconst hideComments = props.hideComments ?? true;\nconst repostsNum = props.repostsNum ?? 0;\nconst content =\n  props.content ??\n  JSON.parse(Social.get(`${accountId}/post/main`, blockHeight) ?? \"null\");\nconst subscribe = !!props.subscribe;\nconst raw = !!props.raw;\n\nconst notifyAccountId = accountId;\nconst item = {\n  type: \"social\",\n  path: `${accountId}/post/main`,\n  blockHeight,\n};\n\nconst link = `#/mob.near/widget/MainPage.Post.Page?accountId=${accountId}&blockHeight=${blockHeight}`;\n\nconst renderPostHeader = (\n  accountId,\n  blockHeight,\n  link,\n  postType,\n  flagItem,\n  repostsNum\n) => {\n  return (\n    <div className=\"d-flex flex-row align-items-center\">\n      <div className=\"flex-grow-1 text-truncate\">\n        <a\n          className=\"text-dark text-decoration-none text-truncate\"\n          href={`#/mob.near/widget/ProfilePage?accountId=${accountId}`}\n        >\n          <Widget\n            src=\"mob.near/widget/Profile.ShortInlineBlock\"\n            props={{ accountId, tooltip: true }}\n          />\n        </a>\n      </div>\n      <div className=\"flex-grow-1 text-truncate\">\n        <span className=\"text-center text-muted\">\n          {`${repostsNum} repost${repostsNum == 1 ? \"\" : \"s\"}`}\n        </span>\n      </div>\n      <span className=\"text-nowrap text-muted\">\n        <small>\n          {blockHeight === \"now\" ? (\n            \"now\"\n          ) : (\n            <a className=\"text-muted\" href={link}>\n              <Widget src=\"mob.near/widget/TimeAgo\" props={{ blockHeight }} />\n            </a>\n          )}\n        </small>\n        {blockHeight !== \"now\" && (\n          <span>\n            <a\n              href=\"javascript:void\"\n              className=\"link-secondary ms-2\"\n              data-bs-toggle=\"dropdown\"\n              aria-expanded=\"false\"\n            >\n              <i className=\"fs-6 bi bi-three-dots\" />\n            </a>\n            <ul className=\"dropdown-menu\">\n              <li className=\"dropdown-item\">\n                <a\n                  className=\"link-dark text-decoration-none\"\n                  href={`${link}&raw=true`}\n                >\n                  <i className=\"bi bi-filetype-raw\" /> View raw markdown source\n                </a>\n              </li>\n              <li>\n                <Widget\n                  src=\"mob.near/widget/MainPage.Common.HideAccount\"\n                  props={{ accountId }}\n                />\n              </li>\n              {props.flagItem && (\n                <li>\n                  <Widget\n                    src=\"mob.near/widget/MainPage.Common.FlagContent\"\n                    props={{\n                      item: flagItem,\n                      label: `Flag ${postType} for moderation`,\n                    }}\n                  />\n                </li>\n              )}\n            </ul>\n          </span>\n        )}\n      </span>\n    </div>\n  );\n};\n\nreturn (\n  <div className=\"border rounded-4 p-3 pb-1\">\n    {renderPostHeader(accountId, blockHeight, link, \"post\", item, repostsNum)}\n    <div className=\"mt-3 text-break\">\n      <Widget\n        src=\"mob.near/widget/MainPage.Post.Content\"\n        props={{ content, raw }}\n      />\n    </div>\n    {blockHeight !== \"now\" && (\n      <div className=\"mt-1 d-flex justify-content-between\">\n        <div className=\"me-4\">\n          <Widget\n            src=\"mob.near/widget/CommentButton\"\n            props={{\n              onClick: () =>\n                !state.showReply && State.update({ showReply: true }),\n            }}\n          />\n        </div>\n        <div className=\"me-4\">\n          <Widget\n            src=\"mob.near/widget/RepostButton\"\n            props={{\n              notifyAccountId,\n              item,\n            }}\n          />\n        </div>\n        <div className=\"me-4\">\n          <Widget\n            src=\"mob.near/widget/LikeButton\"\n            props={{\n              notifyAccountId,\n              item,\n            }}\n          />\n        </div>\n        <div>\n          <Widget\n            src=\"mob.near/widget/MainPage.Post.ShareButton\"\n            props={{ accountId, blockHeight, postType: \"post\" }}\n          />\n        </div>\n      </div>\n    )}\n    <div className=\"mt-3 ps-5\">\n      {state.showReply && (\n        <div className=\"mb-2\">\n          <Widget\n            src=\"mob.near/widget/MainPage.Comment.Compose\"\n            props={{\n              notifyAccountId,\n              item,\n              onComment: () => State.update({ showReply: false }),\n            }}\n          />\n        </div>\n      )}\n      {!hideComments && (\n        <Widget\n          src=\"mob.near/widget/MainPage.Comment.Feed\"\n          props={{\n            item,\n            highlightComment: props.highlightComment,\n            limit: props.commentsLimit,\n            subscribe,\n            raw,\n          }}\n        />\n      )}\n    </div>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/zavodil.near/widget/MainPage.Post"}