{"tx_hash": "7eMo1B5qr78uGheJLyiNPs1TJ3VqkkmqVHNBVQPzAkDA", "action_id_social": "HP89hWwh1oK4Q8Aes4YVPfdzEs7QjTTSRHx8qjYLtZBD-0-widget", "block_id": 87303015, "block_timestamp": "2023-03-14 21:32:30.214", "signer_id": "wendersonpires.near", "widget_name": "ConnectToExternalApp", "source_code": "const requestHandlers = props.requestHandlers || []; // [[\"get-updated-user-info\", sendUpdatedUserInfo]]\nconst externalAppURL = props.externalAppURL; // string\nconst initialPayload = props.initialPayload || {}; // object (optional)\n\n// SETUP: message sender (it will re-send the message to the iframe source)\nconst sendMessage = (message) => {\n  State.update({ currentMessage: message });\n};\n\n// ON MESSAGE HANDLER: On get message handler (from the External App)\nconst onMessageHandler = (message) => {\n  console.log(\"debug:\", message);\n  const handler = requestHandlers.find((handler) => handle[0] === message.type);\n  if (handler) {\n    // Call method handler\n    handler[1](message.type, message.payload);\n  }\n\n  //   switch (message.type) {\n  //     case \"get-updated-user-info\":\n  //       sendUpdatedUserInfo(message.type, message.payload);\n  //       break;\n  //   }\n};\n\n// CONNECTION: connection request\nconst connectMessage = {\n  type: \"connect\",\n  payload: initialPayload,\n};\n\nState.init({\n  currentMessage: connectMessage,\n});\n\nreturn (\n  <div>\n    {externalAppURL && (\n      <iframe\n        id=\"main-iframe\"\n        className=\"w-100\"\n        style={{ height: \"600px\" }}\n        // Load external app\n        src={externalAppURL}\n        // Data the Near Social View is going to send to the External App\n        message={state.currentMessage}\n        // When the external app send a message back to the NS View\n        onMessage={onMessageHandler}\n      />\n    )}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/wendersonpires.near/widget/ConnectToExternalApp"}