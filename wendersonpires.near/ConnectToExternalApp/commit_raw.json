{"tx_hash": "8GnswFKjQ2CirF2DfoPUMa2hfYiySoJUrjP7WSvUqykD", "action_id_social": "E59rRf7T4KqgS8Sx6QVVZGkbsSBfH8gLu8sq6tRdfG1C-0-widget", "block_id": 87303351, "block_timestamp": "2023-03-14 21:38:48.346", "signer_id": "wendersonpires.near", "widget_name": "ConnectToExternalApp", "source_code": "// DO NOT USE IT. IT'S NOT WORKING\n\nconst requestHandlers = props.requestHandlers || []; // [[\"get-updated-user-info\", sendUpdatedUserInfo]]\nconst externalAppURL = props.externalAppURL; // string\nconst initialPayload = props.initialPayload || {}; // object (optional)\n\n// SETUP: message sender (it will re-send the message to the iframe source)\nconst sendMessage = (message) => {\n  State.update({ currentMessage: message });\n};\n\n// ON MESSAGE HANDLER: On get message handler (from the External App)\nconst onMessageHandler = (message) => {\n  console.log(\"debug:\", message);\n  // NOTE: Doesn't work because it's not possible to send function as prop\n  const handler = requestHandlers.find((handler) => handle[0] === message.type);\n  if (handler) {\n    // Call method handler\n    handler[1](message.type, message.payload);\n  }\n};\n\n// CONNECTION: connection request\nconst connectMessage = {\n  type: \"connect\",\n  payload: initialPayload,\n};\n\nState.init({\n  currentMessage: connectMessage,\n});\n\nreturn (\n  <div>\n    {externalAppURL && (\n      <iframe\n        id=\"main-iframe\"\n        className=\"w-100\"\n        style={{ height: \"600px\" }}\n        // Load external app\n        src={externalAppURL}\n        // Data the Near Social View is going to send to the External App\n        message={state.currentMessage}\n        // When the external app send a message back to the NS View\n        onMessage={onMessageHandler}\n      />\n    )}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/wendersonpires.near/widget/ConnectToExternalApp"}