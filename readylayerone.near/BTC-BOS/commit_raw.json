{"tx_hash": "CvDyUFr5jSXLSzQbe46DBmpSuyfGPwiVL54jBX7ijzJB", "action_id_social": "BhcAvimbbpi2PhKBKcVyCzXCXZLLzcm6ZreqRC4rT7vp-0-widget", "block_id": 94513991, "block_timestamp": "2023-06-19T04:45:15.072Z", "signer_id": "readylayerone.near", "widget_name": "BTC-BOS", "source_code": "State.init({\n  query: \"getmempoolinfo\",\n  result: \"Push the button!\",\n});\n\nconst MyButton = styled.button`\n  background: ${(props) => (props.primary ? \"#f2a900\" : \"white\")};\n  color: ${(props) => (props.primary ? \"white\" : \"#f2a900\")};\n  font-size: 1em;\n  margin: 1em;\n  padding: 0.25em 1em;\n  border: 2px solid #f2a900;\n  border-radius: 3px;\n`;\n\nconst StyledTable = styled.table`\n  width: 100%;\n  border-collapse: collapse;\n\n  th, td {\n    border: 1px solid #ddd;\n    padding: 8px;\n  }\n\n  tr:nth-child(even) {\n    background-color: #f2f2f2;\n  }\n\n  th {\n    padding-top: 12px;\n    padding-bottom: 12px;\n    text-align: left;\n    background-color: #f2a900;\n    color: white;\n  }\n`;\n\nfunction updateQuery(value) {\n  State.update({\n    query: value,\n  });\n}\n\nfunction sendQueryToBackend() {\n  const options = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      jsonrpc: \"1.0\",\n      id: \"curltest\",\n      method: state.query,\n      params: [],\n    }),\n  };\n\n  State.update({\n    result: \"Querying...\",\n  });\n\n  asyncFetch(\n    \"https://nd-980-296-237.p2pify.com/61f167b3136c7b2a137bfda10f541a94\",\n    options\n  ).then((res) => {\n    State.update({\n      result: \"Results are here\",\n    });\n    if (!res.ok) {\n      State.update({\n        result: `Bitcoin node issue with fetch: ${JSON.stringify(res)}`,\n      });\n      return;\n    }\n    if (res.body.error) {\n      State.update({\n        result: `Bitcoin node issue: ${JSON.stringify(res.body)}`,\n      });\n      return;\n    }\n\n    State.update({\n      result: res.body.result,\n    });\n  });\n}\n\nconst keyMapping = {\n  size: \"Current Tx Amount\",\n  mempoolminfee: \"Minimum Mempool Fee\",\n  minrelaytxfee: \"Minimum Relay Transaction Fee\",\n};\n\nreturn (\n  <div>\n    <h5>What's the current status of BTC?</h5>\n    <MyButton onClick={() => sendQueryToBackend()}>Let's See It</MyButton>\n    {state.result && (\n      <StyledTable>\n        <tbody>\n          {Object.entries(state.result)\n            .filter(([key]) => keyMapping[key])\n            .map(([key, value]) => (\n              <tr key={key}>\n                <td>{keyMapping[key]}</td>\n                <td>{value}</td>\n              </tr>\n            ))}\n        </tbody>\n      </StyledTable>\n    )}\n  </div>\n);\n", "metadata": {"description": "Just a POC of connecting to a Bitcoin RPC and querying current statuses.", "image": {"ipfs_cid": "bafkreifp5vx5vt4pppm2evz4yr6hgxv25dxi4wfa6ry3u3yy2q6sw744gu"}, "name": "BTC-BOS", "tags": {"bitcoin": "", "data": ""}}, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/readylayerone.near/widget/BTC-BOS", "__row_index": 0}