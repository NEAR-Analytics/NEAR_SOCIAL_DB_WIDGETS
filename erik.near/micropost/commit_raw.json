{"tx_hash": "DufSTM38woxWGgcD8z7jHtDRD8JbiFpT6nPWGNyKwLUR", "action_id_social": "8d241SEMtdNMcPtzku3B5xDvwtY1B2E5AqE4HdH8QsN1-0-widget", "block_id": 80732923, "block_timestamp": "2022-12-15 21:49:10.324", "signer_id": "erik.near", "widget_name": "micropost", "source_code": "// A simple form for creating a post that does NOT follow standards at\n// https://github.com/NearSocial/standards/blob/main/types/Root.md\n// because I'm just trying to get it to work\n// There is no index because microposts are sorted by block height.\nconst accountId = context.accountId;\n\nif (!accountId) {\n  return \"Please sign in with NEAR wallet to post\";\n}\n\nState.init({ postbody: null });\n\n// Display microposts already made\nconst data = Social.get(`${accountId}/micropost/**`);\n\nconsole.log(\"data\", data);\nif (!data) {\n  return \"No data to see here...\";\n}\n\n// just get our index\n// TODO: Filter out the not string numbers and create a clean array\nconst cleanPosts = Math.max(Object.keys(data));\nconsole.log(\"cleanPosts\", cleanPosts);\n\n// return the rendering of posts\nconst fixMicropostData = (microposts) => {\n  return Object.keys(microposts).map((key) => {\n    console.log(microposts[key]);\n    if (microposts[key].body) {\n      return (\n        <div class=\"row\">\n          <p key={key}>{microposts[key].body}</p>\n        </div>\n      );\n    }\n  });\n};\n\nreturn (\n  <div>\n    <div className=\"mb-3\">\n      <label for=\"exampleFormControlTextarea1\" className=\"form-label\">\n        Write a short post and it'll show up in the timeline of your followers\n      </label>\n      <textarea\n        className=\"form-control\"\n        id=\"exampleFormControlTextarea1\"\n        rows=\"2\"\n        style={{ maxWidth: \"30em\" }}\n        onChange={(event) => State.update({ postbody: event.target.value })}\n      ></textarea>\n    </div>\n\n    <div>\n      <CommitButton\n        disabled={state.memo === null}\n        data={{\n          micropost: {\n            1: {\n              body: state.postbody,\n            },\n          },\n        }}\n      >\n        Submit\n      </CommitButton>\n    </div>\n    <hr />\n    {state.done && <div className=\"alert alert-success\">Success!</div>}\n    <h3>Micropost feed</h3>\n    {fixMicropostData(data)}\n  </div>\n);\n", "metadata": NaN, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/erik.near/widget/micropost", "metadata.name": NaN}