{"tx_hash": "94t8bGtRbBStcb5HL62emhxFciij3NU2haQESpCq55Hr", "action_id_social": "FTQgA4ziMr9HL9CP3cqRAfXgBULvZtCc4vuTGeujdGqT-0-widget", "block_id": 80714618, "block_timestamp": "2022-12-15 15:49:20.063", "signer_id": "erik.near", "widget_name": "dTweeter", "source_code": "// dTweeter, a derivative of QuickSocial\nlet accountId = context.accountId;\nlet targetId = props.accountId ?? accountId;\n\nif (context.loading) {\n  return \"Loading\";\n}\n\n// Get all the users who actually post statuses\nlet allUsersBlock = (\n  <div className=\"mt-3 mb-5\">\n    <a\n      className=\"btn btn-outline-primary\"\n      href=\"/#/zavodil.near/widget/QuickSocialUsers\"\n    >\n      All Users\n    </a>\n  </div>\n);\n\n// Generic sign-in\nif (!props.accountId && !accountId) {\n  return (\n    <div>\n      <div>Please sign in with NEAR wallet to use QuickSocial</div>\n      {allUsersBlock}\n    </div>\n  );\n}\n\nlet followed = []; // what is this?\nlet following = Social.keys(`${targetId}/graph/follow/*`, \"final\", {\n  values_only: true,\n});\n\nif (!following) {\n  return \"Loading\";\n}\n\nif (typeof following === \"object\" && Object.keys(following).length) {\n  followed = Object.keys(following[targetId][\"graph\"][\"follow\"]);\n}\n\n// Just grabbing the single status memo, rather than any ongoing posts.\nconst targetStatus = Social.get(`${targetId}/memo`, \"final\");\n\n// TODO: create a simple graph with an ongoing series of posts.  See idea picker for examples.\n// ***\n// ***\n\nif (targetStatus === null) {\n  return \"Loading\";\n}\n\nconst allStatuses = [];\n\n// TODO: Fix this so it's not the status widget but rather a microblog widget.\nlet currentAccountBlock = (\n  <>\n    <h1>dTweeter</h1>\n    <div className=\"me-4 mb-4\">\n      <Widget src=\"zavodil.near/widget/Status\" props={{ accountId }} />\n    </div>\n\n    <div class=\"alert alert-primary\" role=\"alert\">\n      <div className=\"d-flex justify-content-between mb-3\">\n        <div className=\"me-4\">\n          <Widget\n            src=\"mob.near/widget/Profile\"\n            props={{ accountId: targetId }}\n          />\n        </div>\n        <div>\n          <Widget\n            src=\"mob.near/widget/FollowButton\"\n            props={{ accountId: targetId }}\n          />\n        </div>\n      </div>\n      {targetStatus}\n    </div>\n  </>\n);\n\n// Output all the followed accounts and their statuses\n// TODO: Make these statuses into actual microblog posts.\nfor (let i = 0; i < followed.length; ++i) {\n  const accountId = followed[i];\n\n  const dataFollowed = Social.get(`${accountId}/memo`, \"final\");\n\n  if (dataFollowed) {\n    allStatuses.push(\n      <div className=\"mb-2\">\n        <div class=\"card\">\n          <div class=\"card-header\">\n            <Widget\n              src=\"zavodil.near/widget/ProfileLine\"\n              props={{ accountId }}\n            />\n\n            <Widget src=\"mob.near/widget/FollowButton\" props={{ accountId }} />\n          </div>\n          <div class=\"card-body\">{dataFollowed}</div>\n        </div>\n      </div>\n    );\n  }\n}\n\nlet title = allStatuses.length\n  ? `Feed of ${targetId}:`\n  : `Feed of ${targetId} is empty`;\n\nreturn (\n  <div>\n    {currentAccountBlock}\n\n    <h4>{title}</h4>\n\n    <div>{allStatuses}</div>\n\n    <hr />\n\n    {allUsersBlock}\n  </div>\n);\n", "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/erik.near/widget/dTweeter", "metadata.image.ipfs_cid": NaN, "metadata.name": NaN, "metadata": NaN}