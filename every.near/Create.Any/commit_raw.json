{"tx_hash": "BTk4TPpDCLDBdkJwjeRmz2GpusebmWWGXxw6YHrg2dRZ", "action_id_social": "7786w7aK4ELfonKnXRkD5LwBjLSD8ziqLXLPQdtp8eUU-0-widget", "block_id": 92394455, "block_timestamp": "2023-05-21T19:19:06.188Z", "signer_id": "every.near", "widget_name": "Create.Any", "source_code": "const accountId = props.accountId ?? context.accountId;\n\nconst src = Social.get(`${accountId}/settings/dev/src`);\n\nif (src === null) {\n  return \"Loading...\";\n}\n\nconst defaultSource = props.src ?? \"mob.near/widget/Hashtag.Feed\";\n\nState.init({\n  src: src ?? defaultSource,\n  prop: state.prop,\n  value: state.value,\n  isTemplate: false,\n});\n\nconst handleSave = () =>\n  Social.set({\n    settings: {\n      dev: {\n        src: state.src,\n      },\n    },\n  });\n\nconst handleCreate = () =>\n  Social.set({\n    widget: {\n      [`${state.value}.${widgetName}`]: {\n        \"\": `const ${state.prop} = props.${state.prop} ?? \"${state.value}\"; return (<Widget src=\"${state.src}\" props={{${state.prop}: ${state.prop}}} />);`,\n        metadata: {\n          tags: {\n            build: \"\",\n          },\n        },\n      },\n    },\n  });\n\nconst addWidget = ({ widgetPath: src, onHide }) => {\n  return (\n    <button\n      className=\"btn btn-primary\"\n      onClick={() => {\n        State.update({\n          src,\n        });\n        onHide();\n      }}\n    >\n      <i className=\"bi bi-plus-lg\" /> Add\n    </button>\n  );\n};\n\nconst current_src = state.src;\nconst current_prop = state.prop;\nconst current_value = state.value;\n\nlet string = \".near/widget/\";\n\nconst checkSource = (src) => {\n  if (src.indexOf(string) !== -1) {\n    return State.update({ isTemplate: true });\n  }\n};\n\nconst validTemplate = checkSource(state.src);\n\nconst [ownerId, widget, widgetName] = current_src.split(\"/\");\n\nconst metadata = Social.get(\n  `${ownerId}/widget/${widgetName}/metadata/**`,\n  \"final\"\n);\n\nreturn (\n  <>\n    <h3>Create Anything</h3>\n    <div className=\"mb-2 mt-3\">\n      <h4>Explore Templates</h4>\n      <Widget\n        src=\"hack.near/widget/dev.Widget.Search\"\n        props={{ extraButtons: addWidget }}\n      />\n    </div>\n    <hr />\n    <div className=\"mt-3\">\n      <h5>\n        <b>Template Source</b>\n      </h5>\n      {!validTemplate ? (\n        <p>\n          <i>not a valid component</i>\n        </p>\n      ) : (\n        <p>\n          <i>\u21b3 make something based on this component:</i>\n        </p>\n      )}\n      <input\n        type=\"text\"\n        value={state.src}\n        placeholder=\"efiz.near/widget/Community.Posts\"\n      />\n    </div>\n    {validTemplate && (\n      <div className=\"mt-3\">\n        <h5>Main Prop \ud83c\udfad</h5>\n        <p>\n          <i>\n            \u21b3 read the documentation about{\" \"}\n            <a href=\"https://docs.near.org/bos/home#props-receiving-input\">\n              props\n            </a>\n          </i>\n        </p>\n        <input type=\"text\" placeholder=\"hashtag\" value={state.prop} />\n      </div>\n    )}\n    {validTemplate && (\n      <div className=\"mt-3\">\n        <h5>Default Value</h5>\n        <p>\n          <i>\u21b3 passed into template via props.{state.prop ?? \"id\"}</i>\n        </p>\n        <input type=\"text\" placeholder=\"near\" value={state.value} />\n      </div>\n    )}\n\n    <div className=\"mt-3\">\n      <button\n        className=\"btn btn-primary mx-1\"\n        disabled={!validTemplate}\n        onClick={handleSave}\n      >\n        Save Template\n      </button>\n      {state.src && (\n        <button\n          disabled={!state.prop || !state.value}\n          className=\"btn btn-outline-success mx-1\"\n          onClick={handleCreate}\n        >\n          Create\n        </button>\n      )}\n    </div>\n    <hr />\n    <h3>Preview</h3>\n    <div className=\"mb-2\">\n      <Widget src={state.src} props={{ [state.prop]: state.value }} />\n    </div>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/every.near/widget/Create.Any", "__row_index": 1}