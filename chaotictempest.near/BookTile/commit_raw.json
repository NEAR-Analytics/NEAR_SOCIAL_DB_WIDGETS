{"tx_hash": "2jFnFG2ZFykbbJsGSqkf8gLccrZ6ckZoTPiTkL8SDGKw", "action_id_social": "CQgT4YkA7d8sTZQUMR6Num6hTVd1wyGBHo25mc7SdwEx-0-widget", "block_id": 80737314, "block_timestamp": "2022-12-15 23:15:31.677", "signer_id": "chaotictempest.near", "widget_name": "BookTile", "source_code": "const book = props.book ?? {};\n\nconst title = book.title ?? \"No title\";\nconst author = book.author ?? \"No author\";\nconst cover = book.cover ?? \"\";\nconst rating = book.rating ?? 0;\nconst id = book.id ?? 0;\nconst desc = book.desc ?? \"No description\";\n\nconst bookdbContractId =\n  props.bookdbContractId ?? \"v1bookdb.chaotictempest.near\";\nconst showAddToRead = props.showAddToRead ?? false;\nconst showAddToWantToRead = props.showAddToWantToRead ?? false;\nconst onCommitAdd =\n  props.onCommitAdd ??\n  ((buttonName, bookId) => {\n    console.log(`Committing book_isbn=${bookId} via ${buttonName}`);\n\n    let bookEntry = Near.view(bookdbContractId, \"get\", {\n      isbn: bookId,\n    });\n    if (bookEntry) {\n      console.log(`${bookId} already indexed in bookdb`);\n      return;\n    }\n\n    Near.call(bookdbContractId, \"add_book\", {\n      isbn: id,\n      title: title,\n      author: author,\n      desc: desc,\n    });\n  });\n\n// TODO: why do we need index here?\nconst dataForRead = {\n  books: { read: { [id]: book } },\n  index: {\n    books: JSON.stringify({\n      key: \"read\",\n      value: {\n        book,\n      },\n    }),\n  },\n};\n\nconst datarForToRead = {\n  books: { toRead: { [id]: book } },\n  index: {\n    books: JSON.stringify({\n      key: \"toRead\",\n      value: {\n        book,\n      },\n    }),\n  },\n};\n\nconst BookTyle = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: left;\n  padding: 10px;\n  margin: 10px;\n  border: 1px solid #ccc;\n  border-radius: 10px;\n  width: \"100%\";\n  height: \"100%\";\n`;\n\nconst BookTitle = styled.p`\n  margin: 10px;\n  font-size: 15px;\n  font-weight: bold;\n  text-align: left;\n`;\n\nconst BookAuthors = styled.p`\n  margin: 10px;\n  font-size: 14px;\n  text-align: left;\n`;\n\nconst BookRating = styled.p`\n  margin: 10px;\n  font-size: 14px;\n  font-weight: bold;\n  color: #3c763d;\n`;\n\nconst ButtonsBox = styled.p`\n  margin: 10px;  \n`;\n\nconst InfoContaier = styled.p`\n  height: '100%';\n  display: 'flex';\n  flexDirection: 'column';\n  alignItems: 'stretch',\n  justifyContent: 'space-between';\n`;\n\nreturn (\n  <BookTyle>\n    <a\n      href={`#/serhii.near/widget/BookPage?id=${id}`}\n      className=\"text-decoration-none link-dark\"\n    >\n      <Widget\n        src=\"serhii.near/widget/BookCover\"\n        props={{\n          book,\n        }}\n      />\n    </a>\n    <InfoContaier>\n      <a\n        href={`#/serhii.near/widget/BookPage?id=${id}`}\n        className=\"text-decoration-none link-dark\"\n      >\n        <div>\n          <BookTitle className=\"BookTitle\">{title}</BookTitle>\n          <BookAuthors className=\"BookAuthors\">{author}</BookAuthors>\n          <BookRating className=\"BookRating\">{rating}</BookRating>\n        </div>\n      </a>\n\n      <ButtonsBox>\n        {showAddToRead && (\n          <CommitButton\n            data={dataForRead}\n            onCommit={() => onCommitAdd(\"AddToRead\", id)}\n          >\n            Add to Read\n          </CommitButton>\n        )}\n        {showAddToWantToRead && (\n          <CommitButton\n            data={datarForToRead}\n            onCommit={() => onCommitAdd(\"WantToRead\", id)}\n          >\n            Want To Read\n          </CommitButton>\n        )}\n      </ButtonsBox>\n    </InfoContaier>\n  </BookTyle>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/chaotictempest.near/widget/BookTile"}