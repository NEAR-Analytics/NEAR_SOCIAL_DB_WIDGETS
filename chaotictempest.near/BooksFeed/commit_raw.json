{"tx_hash": "Az1bQPbVr9SaRAaaGTnDQ3MSg1R1HR1YHLAigM3T9sEC", "action_id_social": "7xaKekMw1AnmLD92Y7HWeCFaZgb47M3eD8DqbmjCvX6Q-0-widget", "block_id": 80741755, "block_timestamp": "2022-12-16 00:40:16.938", "signer_id": "chaotictempest.near", "widget_name": "BooksFeed", "source_code": "const accountId = context.accountId;\nconst defaultDate = new Date(\"Dec 15 2022 10:00:00 AM\");\n\nif (!accountId) {\n  return \"\";\n}\n\nconst peopleIFollow = Social.get(`${accountId}/graph/follow/**`) ?? {};\n\nif (!peopleIFollow) {\n  return \"You are not following anybody\";\n}\n\nconst peopleIFollowWithBooks = {};\nObject.keys(peopleIFollow).map((follow) => {\n  const followBooks = Social.get(`${follow}/books/read/**`);\n  if (followBooks) {\n    peopleIFollowWithBooks[follow] = followBooks;\n  }\n});\n\nconsole.log(\"followBooks\", peopleIFollowWithBooks);\n\nif (!peopleIFollowWithBooks) {\n  return \"Your friend does not have any books\";\n}\n\nconst timeline = Object.entries(peopleIFollowWithBooks).flatMap(\n  ([acc, books]) => {\n    let values = Object.values(books);\n    // let date = defaultDate;\n    // if (acc === \"bo.near\") {\n    //   // values[0][\"createdAt\"] = new Date(\"Dec 15 2022 11:00:00 AM\");\n    //   // console.log(\"V0\", values[0][\"createdAt\"]);\n    //   date = new Date(\"Dec 15 2022 11:00:00 AM\");\n    // }\n    // return values.map((book) => [acc, book]);\n    return values.map((book) => {\n      if (book.author === \"Umberto Eco\") {\n        book.createdAt = new Date(\"Dec 21 2022 11:00:00 AM\");\n      } else {\n        book.createdAt = defaultDate;\n      }\n\n      // return [acc, book.createdAt ?? defaultDate];\n      return [acc, book];\n    });\n  }\n);\ntimeline.sort(\n  ([_accA, bookA], [_accB, bookB]) =>\n    // (bookB.createdAt ?? defaultDate) - (bookA.createdAt ?? defaultDate)\n    bookB.createdAt - bookA.createdAt\n);\nconsole.log(\"timeline\", timeline);\n\nconst BookRows = styled.p`{\n  display: \"flex\",\n  flexDirection: \"column\",\n  alignItems: \"left\",\n  justifyContent: \"space-between\",\n  width: \"100%\",\n  height: \"100%\",\n  padding: \"1rem\",\n}`;\n\n// return (\n//   <BookRows>\n//     {timeline.map(([acc, book]) => {\n//       return (\n//         <div>\n//           <div>{acc}</div>\n//           <div>\n//             <Widget\n//               key={i}\n//               src={\"serhii.near/widget/BookTile\"}\n//               props={{ book }}\n//             />\n//           </div>\n//         </div>\n//       );\n//     })}\n//   </BookRows>\n// );\n\nreturn <div>Hello</div>;\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/chaotictempest.near/widget/BooksFeed"}