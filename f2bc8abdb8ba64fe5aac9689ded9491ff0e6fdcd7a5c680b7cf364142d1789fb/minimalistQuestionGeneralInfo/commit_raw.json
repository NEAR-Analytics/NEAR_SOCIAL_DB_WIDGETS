{"tx_hash": "6fjRSMxAz6pUGAbfAuqae7otYGkigNYCdjZcKvBDgncK", "action_id_social": "6V7VbV7rMyNtQeXatBmpetvT2F1WD6fCW8viCh43Ej6b-0-widget", "block_id": 83789592, "block_timestamp": "2023-01-25 21:34:38.511", "signer_id": "f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb", "widget_name": "minimalistQuestionGeneralInfo", "source_code": "let poll = props;\r\n\r\nlet dateFormatOptions = {\r\n  month: \"short\",\r\n  day: \"numeric\",\r\n  year: \"numeric\",\r\n  hour: \"numeric\",\r\n  minute: \"numeric\",\r\n  hour12: \"false\",\r\n};\r\n\r\nif (!poll) {\r\n  return \"Prop passed wrongly to minimalistQuestionHeader\";\r\n}\r\n\r\nfunction makeAccountIdShorter(accountId) {\r\n  if (accountId.length > 12) {\r\n    return accountId.slice(0, 12) + \"...\";\r\n  }\r\n  return accountId;\r\n}\r\n\r\nState.init({\r\n  answers: {},\r\n});\r\n\r\nfunction getValidAnswersQtyFromQuestion() {\r\n  let questionBlockHeight = poll.blockHeight;\r\n\r\n  const answers = Social.index(\"poll_question\", \"answer-v3.1.1\");\r\n\r\n  if (JSON.stringify(answers) != JSON.stringify(state.answers)) {\r\n    State.update({ answers: answers });\r\n  }\r\n  if (!answers) {\r\n    return \"Loading...\";\r\n  }\r\n  const answersFromThisPoll = state.answers.filter(\r\n    (a) => a.value.questionBlockHeight == questionBlockHeight\r\n  );\r\n  const usersWithAnswers = answersFromThisPoll.map((a) => a.accountId);\r\n  const usersWithAnswersWithoutDuplicates = usersWithAnswers.filter(\r\n    (u, index) => usersWithAnswers.indexOf(u) == index\r\n  );\r\n  return usersWithAnswersWithoutDuplicates.length;\r\n}\r\n\r\nfunction isActive() {\r\n  return (\r\n    poll.value.startTimestamp < Date.now() &&\r\n    Date.now() < poll.value.endTimestamp\r\n  );\r\n}\r\n\r\nfunction isUpcoming() {\r\n  return poll.value.startTimestamp > Date.now();\r\n}\r\n\r\nreturn (\r\n  <div className=\"mt-2 pt-2\">\r\n    <div\r\n      className=\"d-flex justify-content-around\"\r\n      style={{\r\n        border: \"1.5px solid #F2F6FA\",\r\n        borderRadius: \"16px\",\r\n      }}\r\n    >\r\n      <div className=\"px-2 my-2\">\r\n        <p style={{ margin: \"0\" }}>Created by</p>\r\n        <p\r\n          style={{\r\n            fontWeight: \"600\",\r\n            color: \"#4B516A\",\r\n            margin: \"0\",\r\n          }}\r\n        >\r\n          {makeAccountIdShorter(poll.accountId)}\r\n        </p>\r\n      </div>\r\n\r\n      <div\r\n        className=\"px-2 my-2\"\r\n        style={{\r\n          borderLeft: \"1.5px solid #F2F6FA\",\r\n          borderRight: \"1.5px solid #F2F6FA\",\r\n        }}\r\n      >\r\n        {Date.now() > poll.value.startTimestamp ? (\r\n          <p style={{ margin: \"0\" }}>Started</p>\r\n        ) : (\r\n          <p style={{ margin: \"0\" }}>Start</p>\r\n        )}\r\n        <p\r\n          style={{\r\n            fontWeight: \"600\",\r\n            color: \"#4B516A\",\r\n            margin: \"0\",\r\n          }}\r\n        >\r\n          {new Date(poll.value.startTimestamp).toLocaleDateString(\r\n            [],\r\n            dateFormatOptions\r\n          )}\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"px-2 my-2\">\r\n        {Date.now() > poll.value.endTimestamp ? (\r\n          <p style={{ margin: \"0\" }}>Ended</p>\r\n        ) : (\r\n          <p style={{ margin: \"0\" }}>Ends</p>\r\n        )}\r\n        <p\r\n          style={{\r\n            fontWeight: \"600\",\r\n            letterSpacing: \"-0.1em\",\r\n            color: \"#4B516A\",\r\n            margin: \"0\",\r\n          }}\r\n        >\r\n          {new Date(poll.value.endTimestamp).toLocaleDateString(\r\n            [],\r\n            dateFormatOptions\r\n          )}\r\n        </p>\r\n      </div>\r\n    </div>\r\n    <div className=\"d-flex justify-content-between mt-3\">\r\n      <div className=\"d-flex\">\r\n        <i className=\"bi bi-people\" style={{ marginRight: \"0.3rem\" }}></i>\r\n        <span>{getValidAnswersQtyFromQuestion(poll.blockHeight)} votes</span>\r\n      </div>\r\n      <span\r\n        style={{\r\n          backgroundColor: isUpcoming()\r\n            ? \"#FFF3B4\"\r\n            : isActive()\r\n            ? \"#D9FCEF\"\r\n            : \"#FFE5E5\",\r\n\r\n          height: \"1.5rem\",\r\n          width: \"4rem\",\r\n          textAlign: \"center\",\r\n          borderRadius: \"16px\",\r\n          marginRight: \"1rem\",\r\n          lineHeight: \"1.5rem\",\r\n          fontSize: \"0.8rem\",\r\n          letterSpacing: \"-0.025rem\",\r\n          color: isUpcoming() ? \"#FFC905\" : isActive() ? \"#00B37D\" : \"#FF4747\",\r\n          fontWeight: \"500\",\r\n        }}\r\n      >\r\n        {isUpcoming() ? \"Upcoming\" : isActive() ? \"Active\" : \"Closed\"}\r\n      </span>\r\n    </div>\r\n  </div>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/minimalistQuestionGeneralInfo"}