{"tx_hash": "QoapwE953GQVjN5LTtRVsnftAjxe81ypEQJ8nv8cZvJ", "action_id_social": "6KNwjL7Sz1wExMyGND1uDkFWuBhFTPZwco3EggPs49tX-0-widget", "block_id": 80522121, "block_timestamp": "2022-12-13 01:09:54.952", "signer_id": "f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb", "widget_name": "newMiniMultipleChoiceInterface", "source_code": "let blockHeight = props.blockHeight;\n// let question = Social.index(\"poll_question\", \"question-v3.0.1\");\nlet question = props.value;\nconsole.log(props);\n\nfunction calculatePercentage(votesToThisOption) {\n  if (question.answers.length == 0) return 0;\n  return (votesToThisOption / question.answers.length) * 100;\n}\n\nlet countVotes = [];\nfor (let i = 0; i < question.choicesOptions.length; i++) {\n  countVotes.push(0);\n}\n\nfor (let i = 0; i < question.answers.length; i++) {\n  // Any user can post any answer they want. They might post \"yes\" for example\n  const option = Number(question.answers[i].value.answer);\n  if (option >= 0 && option < countVotes.length) countVotes[option] += 1;\n}\n\nfunction displayableOptionName(option) {\n  if (option.length > 12) {\n    return option.slice(0, 12) + \"...\";\n  }\n  return option;\n}\n\nconsole.log(\"in\");\n\nconst renderOption = (option, index) => {\n  return (\n    <div className=\"d-flex\">\n      <div style={{ color: \"#000\", width: \"90%\" }}>\n        {/* Set the width of the next div to make the bar grow. At the same, use the same value to fill the span tag */}\n        <div\n          style={{\n            margin: \"0.3rem 0px\",\n            content: \"\",\n            display: \"table\",\n            clear: \"both\",\n            padding: \"0.01em 16px\",\n            display: \"inline-block\",\n            width: `${calculatePercentage(countVotes[index])}%`,\n            textAlign: \"center\",\n            overflow: \"visible\",\n            whiteSpace: \"nowrap\",\n            textAlign: \"left\",\n            backgroundColor: \"lightgray\",\n          }}\n        >\n          <span style={{ overflow: \"visible\", fontWeight: \"500\" }}>\n            {displayableOptionName(option)}\n            <span\n              className=\"text-secondary\"\n              style={{ marginLeft: \"1rem\", fontWeight: \"400\" }}\n            >\n              ({countVotes[index]} votes)\n            </span>\n          </span>\n        </div>\n      </div>\n      <span\n        style={{\n          minWidth: \"max-content\",\n          marginLeft: \"0.3rem\",\n          fontWeight: \"500\",\n        }}\n      >\n        {calculatePercentage(countVotes[index])}%\n      </span>\n    </div>\n  );\n};\n\nreturn (\n  <div className=\"m-2\">\n    {question.choicesOptions.map((option, index) => {\n      return renderOption(option, index);\n    })}\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/newMiniMultipleChoiceInterface"}