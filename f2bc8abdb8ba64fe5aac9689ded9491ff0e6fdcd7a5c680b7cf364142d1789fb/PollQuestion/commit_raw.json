{"tx_hash": "3G8SKcN2bbdxvqtsd2n3DHr1oRnRdBoXBYrXrVBuepjc", "action_id_social": "5bsb1An1DVdcXpp3sPFZsn9ocrrN2ZA2e7F82ZxV8K8U-0-widget", "block_id": 79618556, "block_timestamp": "2022-11-30 18:38:11.577", "signer_id": "f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb", "widget_name": "PollQuestion", "source_code": "const accountId = context.accountId;\n\nif (!accountId) {\n  return \"Please sign in with NEAR wallet to add a new blog entry\";\n}\n\ninitState({\n  question: \"\",\n  typeOfAnswer: \"\",\n  amountOfChoices: \"1\",\n  choices: [],\n});\n\nconst entry = {\n  question: state.question,\n  typeOfAnswer: state.typeOfAnswer,\n  amountOfChoices: state.amountOfChoices,\n  choices: state.choices,\n};\n\nconst handleMakeQuestionInputChange = (event) => {\n  State.update({\n    question: event.target.value,\n  });\n};\n\nconst handleWriteChoiceInputChange = (choiceNumber) => {\n  return (event) => {\n    const choices = state.choices;\n\n    let newChoices = [];\n    if (event.target.value == \"\" && choices.length == choiceNumber + 1) {\n      for (let i = 0; i < choices.length; i++) {\n        if (i != choiceNumber) {\n          newChoices.push(choices[i]);\n        }\n      }\n    } else {\n      choices[Number(choiceNumber)] = event.target.value;\n      newChoices = choices;\n    }\n    State.update({\n      choices: newChoices,\n    });\n    a;\n\n    if (\n      newChoices[state.amountOfChoices] != \"\" &&\n      Number(state.amountOfChoices) == choiceNumber + 1\n    ) {\n      changeAmountOfChoices(1);\n    } else if (\n      (newChoices[Number(state.amountOfChoices) - 2] == \"\" ||\n        newChoices[Number(state.amountOfChoices) - 2] == undefined) &&\n      Number(state.amountOfChoices - 1) == choiceNumber + 1\n    ) {\n      changeAmountOfChoices(-1);\n    }\n  };\n};\n\nfunction deleteChoiceHandler(choiceNumber) {\n  return () => {\n    let choices = state.choices;\n    let newChoices = [];\n    let countDeleted = 0;\n    for (let i = 0; i < choices.length; i++) {\n      if (i != choiceNumber) {\n        newChoices.push(choices[i]);\n      } else {\n        countDeleted++;\n      }\n    }\n    newChoices.push(\"\");\n\n    State.update({\n      amountOfChoices: Number(state.amountOfChoices) - countDeleted,\n      choices: newChoices,\n    });\n  };\n}\n\nfunction onChangeTypeOfAnswer(e) {\n  const typeOfAnswer = e.target.value;\n\n  State.update({\n    typeOfAnswer: typeOfAnswer,\n  });\n}\n\nfunction changeAmountOfChoices(changeValue) {\n  State.update({\n    amountOfChoices: Number(state.amountOfChoices) + changeValue + \"\",\n  });\n}\n\nfunction renderTextInputsForChoices() {\n  let amountOfChoices = [];\n  for (let i = 0; i < state.amountOfChoices; i++) {\n    amountOfChoices.push(i);\n  }\n\n  return (\n    <>\n      {amountOfChoices.map((choiceNumber) => {\n        return (\n          <div className=\"my-1\" key={`choice-input-${choiceNumber}`}>\n            <h6>Choice numer {choiceNumber + 1}</h6>\n            <div className=\"d-flex\">\n              <input\n                type=\"text\"\n                className=\"w-100 mx-2\"\n                value={state.choices[choiceNumber]}\n                onChange={handleWriteChoiceInputChange(choiceNumber)}\n              />\n              <button\n                type=\"button\"\n                className=\"btn btn-outline-danger\"\n                onClick={deleteChoiceHandler(choiceNumber)}\n              >\n                <i className=\"bi bi-x-octagon\"></i>\n              </button>\n            </div>\n          </div>\n        );\n      })}\n    </>\n  );\n}\n\nfunction deleteEmptyChoices() {\n  let filteredChoices = state.choices.filter((choice) => choice != \"\");\n\n  return filteredChoices;\n}\na;\n\nfunction renderCommitButton() {\n  if (state.typeOfAnswer == \"2\") {\n    return (\n      <CommitButton\n        data={{\n          index: {\n            poll_question: JSON.stringify(\n              {\n                key: \"question-v2\",\n                value: {\n                  data: {\n                    question: state.question,\n                    questionType: state.typeOfAnswer,\n                    choicesOptions: deleteEmptyChoices(),\n                    timestamp: Date.now(),\n                  },\n                },\n              },\n              undefined,\n              0\n            ),\n          },\n        }}\n      >\n        Submit\n      </CommitButton>\n    );\n  } else {\n    return (\n      <CommitButton\n        data={{\n          index: {\n            poll_question: JSON.stringify(\n              {\n                key: \"question-v2\",\n                value: {\n                  data: {\n                    question: entry.question,\n                    questionType: state.typeOfAnswer,\n                    timestamp: Date.now(),\n                  },\n                },\n              },\n              undefined,\n              0\n            ),\n          },\n        }}\n      >\n        Submit\n      </CommitButton>\n    );\n  }\n}\n\n// function renderChoicesInputs() {\n//   return (\n//     <>\n//       <h5>Select amount of choices</h5>\n//       <div className=\"d-flex\">\n//         <div className=\"form-check mx-2\">\n//           <input\n//             key={state.amountOfChoices}\n//             className=\"form-check-input\"\n//             type=\"radio\"\n//             name=\"choicesRadio\"\n//             id=\"twoChoices\"\n//             value=\"2\"\n//             onChange={onChangeAmountOfChoices}\n//             checked={state.amountOfChoices == \"2\"}\n//           />\n//           <label className=\"form-check-label\" for=\"twoChoices\">\n//             2\n//           </label>\n//         </div>\n//         <div className=\"form-check mx-2\">\n//           <input\n//             key={state.amountOfChoices}\n//             className=\"form-check-input\"\n//             type=\"radio\"\n//             name=\"choicesRadio\"\n//             id=\"threeChoices\"\n//             value=\"3\"\n//             onChange={onChangeAmountOfChoices}\n//             checked={state.amountOfChoices == \"3\"}\n//           />\n//           <label className=\"form-check-label\" for=\"threeChoices\">\n//             3\n//           </label>\n//         </div>\n//         <div className=\"form-check mx-2\">\n//           <input\n//             key={state.amountOfChoices}\n//             className=\"form-check-input\"\n//             type=\"radio\"\n//             name=\"choicesRadio\"\n//             id=\"fourChoices\"\n//             value=\"4\"\n//             onChange={onChangeAmountOfChoices}\n//             checked={state.amountOfChoices == \"4\"}\n//           />\n//           <label className=\"form-check-label\" for=\"fourChoices\">\n//             4\n//           </label>\n//         </div>\n//         <div className=\"form-check mx-2\">\n//           <input\n//             key={state.amountOfChoices}\n//             className=\"form-check-input\"\n//             type=\"radio\"\n//             name=\"choicesRadio\"\n//             id=\"fiveChoices\"\n//             value=\"5\"\n//             onChange={onChangeAmountOfChoices}\n//             checked={state.amountOfChoices == \"5\"}\n//           />\n//           <label className=\"form-check-label\" for=\"fiveChoices\">\n//             5\n//           </label>\n//         </div>\n//       </div>\n//       {renderTextInputsForChoices()}\n//     </>\n//   );\n// }\n\nreturn (\n  <div className=\"row mb-3\">\n    <div>\n      <h4>Make question</h4>\n    </div>\n    <input className=\"mb-2\" value={state.question} />\n\n    <h4>Choose type of answers</h4>\n\n    <div className=\"form-check\">\n      <input\n        key={state.typeOfAnswer}\n        className=\"form-check-input\"\n        type=\"radio\"\n        name=\"flexRadioDefault\"\n        id=\"voteYesNo\"\n        value=\"0\"\n        onChange={onChangeTypeOfAnswer}\n        checked={state.typeOfAnswer == \"0\"}\n      />\n      <label className=\"form-check-label\" for=\"voteYesNo\">\n        Vote yes/no\n      </label>\n    </div>\n\n    <div className=\"form-check\">\n      <input\n        key={state.typeOfAnswer}\n        className=\"form-check-input\"\n        type=\"radio\"\n        name=\"flexRadioDefault\"\n        id=\"text\"\n        value=\"1\"\n        onChange={onChangeTypeOfAnswer}\n        checked={state.typeOfAnswer == \"1\"}\n      />\n      <label className=\"form-check-label\" for=\"text\">\n        Text\n      </label>\n    </div>\n\n    <div className=\"form-check\">\n      <input\n        key={state.typeOfAnswer}\n        className=\"form-check-input\"\n        type=\"radio\"\n        name=\"flexRadioDefault\"\n        id=\"multipleChoice\"\n        value=\"2\"\n        onChange={onChangeTypeOfAnswer}\n        checked={state.typeOfAnswer == \"2\"}\n      />\n      <label className=\"form-check-label\" for=\"multipleChoice\">\n        Multiple choice\n      </label>\n    </div>\n\n    {state.typeOfAnswer == \"2\" && renderTextInputsForChoices()}\n\n    {renderCommitButton()}\n  </div>\n);\n", "metadata": NaN, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/PollQuestion", "metadata.image.ipfs_cid": NaN, "metadata.linktree.website": NaN, "metadata.name": NaN, "metadata.tags.thing": NaN}