{"tx_hash": "BQ2Aqi4CVnk96GfmrLtka5CEQPNWm4yGXecKoxRQxwqJ", "action_id_social": "GvVJxYmF6JaiSmQZXkSZUB1CnLt6SKn64brhR1L8Eb4t-0-widget", "block_id": 80388387, "block_timestamp": "2022-12-11 05:54:20.032", "signer_id": "f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb", "widget_name": "voteMultipleChoice", "source_code": "let question = props.question;\r\nlet option = props.option;\r\nlet index = props.index;\r\n\r\nState.init({\r\n  vote: \"\",\r\n});\r\n\r\n//TODO get this data\r\nlet countVotes = [1, 0, 0];\r\n\r\nfunction calculatePercentage(votesToThisOption) {\r\n  return (votesToThisOption / question.value.answers.length) * 100;\r\n}\r\n\r\nlet styles = userHaveVoted()\r\n  ? { color: \"#000\", width: \"90%\" }\r\n  : { color: \"#000\", width: \"100%\" };\r\n\r\nlet thisUserVote = 0;\r\nfunction userHaveVoted() {\r\n  //TODO validate this to return boolean and if it's true set value to thisUserVote\r\n  return false;\r\n}\r\n\r\nreturn (\r\n  <div>\r\n    <div className=\"d-flex\">\r\n      <div style={styles}>\r\n        {/* Set the width of the next div to make the bar grow. At the same, use the same value to fill the span tag */}\r\n        <div\r\n          style={{\r\n            margin: \"0.3rem 0px\",\r\n            content: \"\",\r\n            display: \"table\",\r\n            clear: \"both\",\r\n            padding: \"0.01em 16px\",\r\n            display: \"inline-block\",\r\n            width: `${\r\n              userHaveVoted() ? calculatePercentage(countVotes[index]) : 100\r\n            }%`,\r\n            textAlign: \"center\",\r\n            overflow: \"visible\",\r\n            whiteSpace: \"nowrap\",\r\n            textAlign: \"left\",\r\n            backgroundColor: `${\r\n              (userHaveVoted() && thisUserVote == index) ||\r\n              state.vote == index + \"\"\r\n                ? \"rgb(153, 255, 153)\"\r\n                : \"lightgray\"\r\n            }`,\r\n          }}\r\n          onClick={() => !userHaveVoted && State.update({ vote: index + \"\" })}\r\n        >\r\n          <span style={{ overflow: \"visible\", fontWeight: \"500\" }}>\r\n            {option}\r\n            {userHaveVoted() && (\r\n              <span\r\n                className=\"text-secondary\"\r\n                style={{ marginLeft: \"1rem\", fontWeight: \"400\" }}\r\n              >\r\n                ({question.answers.length} votes)\r\n              </span>\r\n            )}\r\n          </span>\r\n        </div>\r\n      </div>\r\n      {userHaveVoted() && (\r\n        <span\r\n          style={{\r\n            minWidth: \"max-content\",\r\n            margin: \"0.3rem 0px 0.3rem 0.3rem\",\r\n            fontWeight: \"500\",\r\n          }}\r\n        >\r\n          {calculatePercentage(countVotes[index])}%\r\n        </span>\r\n      )}\r\n    </div>\r\n\r\n    {userHaveVoted() ? (\r\n      <p\r\n        className=\"text-primary\"\r\n        style={{ textAlign: \"center\", fontWeight: \"500\" }}\r\n      >\r\n        Voted\r\n      </p>\r\n    ) : (\r\n      <>{/*TODO replace with commit button*/}</>\r\n    )}\r\n  </div>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/voteMultipleChoice"}