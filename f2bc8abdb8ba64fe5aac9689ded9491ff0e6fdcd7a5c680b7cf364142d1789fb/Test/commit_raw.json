{"tx_hash": "6ij5XZCZHma5r8ypE6G2FG4j1c6bMka239PTqv9vZSnS", "action_id_social": "5D1PX3eSk7R1ahs9EmZ2cmBPLAUcyKn4aXTKrPpEMdaL-0-widget", "block_id": 78461038, "block_timestamp": "2022-11-15 00:46:00.127", "signer_id": "f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb", "widget_name": "Test", "source_code": "// Returns the account Id from the logged person\r\nconst accountId = context.accountId;\r\n\r\n// Returns JSON with profile data from the accountId\r\nconst profile = Social.getr(`${accountId}/profile`);\r\n\r\n// Returns the widgets contents (not committed data) from the user in accountId\r\nconst widgets = Social.get(`${accountId}/widget/*`);\r\n\r\n// Returns the Test widget contents (not committed data) from the user in accountId\r\nconst testWidget = Social.getr(`${accountId}/widget/Test`);\r\n\r\n// Returns a JSON object with only one key that is accountId\r\n// After that, contains many keys, containing an array of blockHeights. Examples for silkking.near are \"widgets\", \"post\", \"profile\", \"test\"\r\nconst allBlockHeights = Social.keys(`${accountId}/*`, \"final\", {\r\n  return_type: \"History\",\r\n});\r\n\r\n// Returns a JSON object with only one key that is accountId\r\n// That key will only contain one key names test and the blockHeights associated\r\nconst testBlockHeights = Social.keys(`${accountId}/post/test`, \"final\", {\r\n  return_type: \"History\",\r\n});\r\n\r\n//Returns Object with user account containing only the key post. At the same time post contains the key test.\r\n//test value is boolean\r\nconst existentObjectsFromAccountId = Social.keys(`${accountId}/post/test`);\r\n\r\n//Returns the text you have posted with the commitButton. Documentation says\r\n//that it will return the lastest blockheigt of that key\r\nconst valueFromGivenKeys = Social.get(`${accountId}/post/test`);\r\n\r\nconst blockHeight = testBlockHeights[accountId].post.test;\r\n\r\n// Brings the value from key accountId, then post and finally test that is located in the blockHeight provided\r\nconst valueFromGivenKeysInGivenBlockHeight = Social.get(\r\n  `${accountId}/post/test`,\r\n  blockHeight[1]\r\n);\r\n\r\n//You can access to all post/test blockheights of all users\r\nconst blockHeightsInGivenKeys = Social.keys(`*/post/test`, \"final\", {\r\n  return_type: \"History\",\r\n});\r\n\r\nlet mapped = Object.keys(blockHeightsInGivenKeys).map((key) => {\r\n  return {\r\n    accountId: key,\r\n    blockHeightArray: blockHeightsInGivenKeys[key].post.test[0],\r\n  };\r\n});\r\nmapped.reduce(\r\n  (acc, curr) => {\r\n    let answer = Social.get(\r\n      `${curr.accountId}/post/test`,\r\n      curr.blockHeightArray\r\n    );\r\n    return answer == 1 ? [acc[0] + 1, acc[1]] : [acc[0], acc[1] + 1];\r\n  },\r\n  [0, 0]\r\n);\r\n\r\nreturn (\r\n  <div>\r\n    {JSON.stringify(mapped)}\r\n    <CommitButton data={{ post: { test: \"probando2\" } }}>\r\n      Post this\r\n    </CommitButton>\r\n  </div>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/Test"}