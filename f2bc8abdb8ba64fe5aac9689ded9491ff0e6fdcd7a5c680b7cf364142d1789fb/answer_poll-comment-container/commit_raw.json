{"tx_hash": "DvS14iagC49tP75ZMPkpjyzPnjfrGfDSZKvfPU55n9aS", "action_id_social": "4ojcdjGUJ1Q4ntE4Z45bZrTsDjWrjLSzm8DMx3dneHMx-0-widget", "block_id": 82329040, "block_timestamp": "2023-01-06 12:21:03.992", "signer_id": "f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb", "widget_name": "answer_poll-comment-container", "source_code": "if (!props.blockHeight) {\r\n  return \"Prop blockHeight not set\";\r\n}\r\n\r\n// Utility function. Consider moving it to an utility widget\r\nfunction getBlockTimestamp(blockHeight) {\r\n  // It is stored in nanoseconds which is 1e-6 miliseconds\r\n  return Near.block(blockHeight).header.timestamp / 1e6;\r\n}\r\n\r\nconst answerBlockHeight = props.blockHeight;\r\nconst answers = Social.index(\"poll_question\", \"answer-v3.0.1\");\r\nif (!answers) {\r\n  return \"Loading\";\r\n}\r\nconst answerParams = answers.find((a) => a.blockHeight == answerBlockHeight);\r\n\r\nconsole.log(1, answers);\r\nconst comment = answerParams.value.answer;\r\nconst answerTimeStamp = getBlockTimestamp(answerBlockHeight);\r\nconst accountId = answerParams.accountId;\r\n\r\nconst profile = Social.getr(`${accountId}/profile`);\r\n// if (!profile) {\r\n//   return \"Loading\";\r\n// }\r\n\r\nconst timeAgo = (diffSec) =>\r\n  diffSec < 60000\r\n    ? `${(diffSec / 1000) | 0} seconds ago`\r\n    : diffSec < 3600000\r\n    ? `${(diffSec / 60000) | 0} minutes ago`\r\n    : diffSec < 86400000\r\n    ? `${(diffSec / 3600000) | 0} hours ago`\r\n    : `${(diffSec / 86400000) | 0} days ago`;\r\n\r\nconst profileLink = (c) => (\r\n  <a\r\n    className=\"text-decoration-none link-dark\"\r\n    href={`#/mob.near/widget/ProfilePage?accountId=${accountId}`}\r\n  >\r\n    {c}\r\n  </a>\r\n);\r\n\r\nreturn (\r\n  <div className=\"flex-column my-2 border border-primary p-2\">\r\n    <small className=\"ps-1 text-nowrap text-muted ms-auto\">\r\n      <i className=\"bi bi-clock me-1\"></i>\r\n      {timeAgo(Date.now() - answerTimeStamp)}\r\n    </small>\r\n    <div className=\"flex-row\">\r\n      {profileLink(\r\n        <div className=\"d-flex align-items-center\">\r\n          <Widget src=\"mob.near/widget/ProfileImage\" props={{ accountId }} />\r\n          <div>\r\n            <span className=\"fw-bold\">{profile.name}</span>\r\n            <span className=\"text-secondary\">@{accountId}</span>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n    <p className=\"m-3\">{comment}</p>\r\n  </div>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/f2bc8abdb8ba64fe5aac9689ded9491ff0e6fdcd7a5c680b7cf364142d1789fb/widget/answer_poll-comment-container"}