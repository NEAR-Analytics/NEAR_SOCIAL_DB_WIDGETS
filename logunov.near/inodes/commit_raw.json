{"tx_hash": "AKkU9u1NiPpEe8zMEo9Zfj56ZtCfxGRYwzbaVLHELd9g", "action_id_social": "7p4Dx9RjwpnMc8v3DvVUnWNwnNgDtSaWvifCSmWUZPqK-0-widget", "block_id": 80732338, "block_timestamp": "2022-12-15 21:37:33.420", "signer_id": "logunov.near", "widget_name": "inodes", "source_code": "const accountId = context.accountId;\n\nif (!accountId) {\n  return \"Please sign in with NEAR wallet\";\n}\n\nconst data = Social.get(`${accountId}/scribbles/inode/0/type`, \"final\");\n\n// File:\n// {\n//     type: 0,\n//     data: \"...\"\n// }\n\n// Folder:\n// {\n//     type: 1,\n//     entries: {}\n// }\n\nif (!data) {\n  // Ask to initialize storage\n  return (\n    <div>\n      <CommitButton\n        data={{\n          scribbles: {\n            inode: {\n              [0]: {\n                type: 1,\n                entries: {},\n              },\n            },\n            next_inode: 1,\n          },\n        }}\n      >\n        Initialize storage\n      </CommitButton>\n    </div>\n  );\n}\n\nconst next_inode = parseInt(\n  Social.get(`${accountId}/scribbles/next_inode`, \"final\")\n);\n\nState.init({\n  fs: {\n    root: 0,\n    next_inode: next_inode,\n    new_filename: \"\",\n    new_data: \"\",\n  },\n});\n\nreturn (\n  <div>\n    fs = {JSON.stringify(state.fs)}\n    <div className=\"mb-2\">\n      <h4>Set root</h4>\n      <input\n        type=\"text\"\n        className=\"form-control\"\n        placeholder=\"0\"\n        onChange={(e) =>\n          State.update({\n            fs: { ...state.fs, root: parseInt(e.target.value) },\n          })\n        }\n      />\n    </div>\n    <div className=\"mb-2\">\n      <h4>Add file</h4>\n      <input\n        type=\"text\"\n        className=\"form-control\"\n        placeholder=\"filename\"\n        onChange={(e) =>\n          State.update({\n            new_filename: e.target.value,\n          })\n        }\n      />\n      <input\n        type=\"text\"\n        className=\"form-control\"\n        placeholder=\"data\"\n        onChange={(e) =>\n          State.update({\n            new_data: e.target.value,\n          })\n        }\n      />\n    </div>\n    <CommitButton\n      data={{\n        scribbles: {\n          inode: {\n            [state.fs.root]: {\n              entries: {\n                [state.fs.new_filename]: state.fs.next_inode,\n              },\n            },\n            [state.fs.next_inode]: {\n              type: 0,\n              data: state.fs.new_data,\n            },\n          },\n          next_inode: state.fs.next_inode + 1,\n        },\n      }}\n      onClick={(e) =>\n        State.update({\n          fs: { ...state.fs, next_inode: state.fs.next_inode + 1 },\n        })\n      }\n    >\n      Add file\n    </CommitButton>\n    <div className=\"mb-2\">\n      <h4>Remove widget by index</h4>\n      <input\n        type=\"text\"\n        className=\"form-control\"\n        placeholder=\"0\"\n        onChange={(e) => State.update({ remove_index: e.target.value })}\n      />\n    </div>\n    <CommitButton data={{ graph: { widget: { [state.remove_index]: null } } }}>\n      Remove\n    </CommitButton>\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/logunov.near/widget/inodes"}