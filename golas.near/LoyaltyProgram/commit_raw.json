{"tx_hash": "95K3jNcGJVmk53dvNR3iEUmxLPgYJJ8xK5kuLmN9E7AU", "action_id_social": "9qGeubVe2TbVVHZqbqLJC4mEUuT7Zn567CNbwLVHAm6X-0-widget", "block_id": 85956945, "block_timestamp": "2023-02-24 18:22:22.236", "signer_id": "golas.near", "widget_name": "LoyaltyProgram", "source_code": "const StyledMainContent = styled.div`\n  margin-top: 100px;\n  margin-bottom: 100px;\n\n  h1 {\n    margin: 40px 0 0 0;\n    background: linear-gradient(#a463b0 0%, #5f8afa 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    font-size: 76px;\n    font-weight: 400;\n    margin-left: -5px;\n  }\n  h2 {\n    max-width: 300px;\n    margin: 0;\n    font-weight: 600;\n  }\n  > p {\n    font-size: 18px;\n    margin: 30px 0;\n    max-width: 415px;\n  }\n  @media (max-width: 620px) {\n    margin-top: 70px;\n    margin-bottom: 150px;\n  }\n  > img {\n    pointer-events: none;\n    height: 30px;\n  }\n`;\n\nconst StyledInputForm = styled.div`\n  position: relative;\n  max-width: 520px;\n  input {\n    font-size: 16px;\n    width: 100%;\n    outline: none;\n    border-radius: 100px;\n    border: 0;\n    padding: 12px 25px;\n    box-shadow: 0px 0px 20px 0px #6b6ef940;\n    ::placeholder {\n      color: #555555;\n    }\n    @media (min-width: 751px) {\n      padding-right: 244px;\n    }\n  }\n  button {\n    height: 100%;\n    border: 0;\n    border-radius: 100px;\n    background-color: black;\n    color: white;\n    padding: 12px 25px;\n    transition: background-color 0.2s;\n    font-size: 16px;\n    @media (max-width: 750px) {\n      width: 100%;\n      margin-top: 20px;\n    }\n    @media (min-width: 751px) {\n      position: absolute;\n      right: 0;\n      top: 0;\n    }\n    :hover {\n      background-color: #282828;\n    }\n    svg {\n      margin-left: 5px;\n      path {\n        fill: white;\n      }\n    }\n  }\n  .form-error {\n    position: absolute;\n    bottom: -30px;\n    left: 0;\n    color: #ff3232;\n  }\n`;\n\nconst FORM_ACTION_URL =\n  \"https://pagoda.us14.list-manage.com/subscribe/post?u=9a67f4eac197159cd85f8f6b6&id=33f73232ed&f_id=00a98ee0f0\";\n\nconst EMAIL_REGEX =\n  /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\nState.init({ error: false, form: { email: \"\" } });\n\nconst validation = {\n  email: (value) => value.length > 0 && EMAIL_REGEX.test(value),\n};\n\nconst formValidation = () =>\n  Object.keys(state.form).every((field) =>\n    validation[field](state.form[field])\n  );\n\nconst handleSubmit = () => {\n  console.log(\"VALIDATION\");\n\n  if (!formValidation()) {\n    State.update({ error: true });\n    return;\n  }\n\n  console.log(\"SUBMITING\");\n\n  sendForm(state.form);\n};\n\nconst sendForm = () => {\n  console.log(\"SENDING\");\n  // console.log(\"x\", {\n  //   // mode: \"no-cors\",\n  //   method: \"POST\",\n  //   // redirect: \"follow\",\n  //   headers: {\n  //     \"Content-Type\": \"application/json\",\n  //   },\n  //   // credentials: \"omit\",\n  //   body: JSON.stringify({ \"mce-EMAIL\": state.form.email }),\n  // });\n\n  let formData = new FormData();\n  formData.append(\"EMAIL\", \"marcin+x7@near.org\");\n  formData.append(\"b_9a67f4eac197159cd85f8f6b6_33f73232ed\", \"\");\n  formData.append(\"subscribe\", \"Subscribe\");\n\n  asyncFetch(FORM_ACTION_URL, {\n    // mode: \"no-cors\",\n    // method: \"POST\",\n    // redirect: \"follow\",\n    // // headers: {\n    // //   \"Content-Type\": \"application/json\",\n    // // },\n    // // credentials: \"omit\",\n    // body: JSON.stringify({ EMAIL: state.form.email }),\n\n    mode: \"no-cors\",\n    method: \"POST\",\n    redirect: \"follow\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    // credentials: \"omit\",\n    body: formData,\n  }).then((response) => {\n    console.log(\"X1\");\n    // response.json();\n  });\n\n  // const form = <form></form>;\n  // form.method = \"post\";\n  // form.action = FORM_ACTION_URL;\n\n  // form.submit();\n\n  // const XHR = new XMLHttpRequest();\n  // const FD = new FormData();\n\n  // const urlEncodedDataPairs = [];\n\n  // // Turn the data object into an array of URL-encoded key/value pairs.\n  // for (const [name, value] of Object.entries(data)) {\n  //   urlEncodedDataPairs.push(\n  //     `${encodeURIComponent(name)}=${encodeURIComponent(value)}`\n  //   );\n  // }\n  // const urlEncodedData = urlEncodedDataPairs.join(\"&\").replace(/%20/g, \"+\");\n\n  // XHR.addEventListener(\"load\", (event) => {\n  //   alert(\"Yeah! Data sent and response loaded.\");\n  // });\n\n  // XHR.addEventListener(\"error\", (event) => {\n  //   alert(\"Oops! Something went wrong.\");\n  // });\n\n  // XHR.open(\"POST\", FORM_ACTION_URL);\n\n  // XHR.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n\n  // XHR.send(urlEncodedData);\n};\n\nconst handleEmailInput = ({ target: { id, value } }) =>\n  State.update({ error: false, form: { [id]: value } });\n\nconst {\n  error,\n  form: { email },\n} = state;\n\nreturn (\n  <StyledMainContent>\n    <p>Sign up and join the journey.</p>\n    <StyledInputForm>\n      <input\n        type=\"email\"\n        name=\"email\"\n        id=\"email\"\n        value={email}\n        placeholder=\"Enter email address\"\n        autoCapitalize=\"none\"\n        onChange={handleEmailInput}\n      />\n\n      {/*real people should not fill this in and expect good things - do not remove this or risk form bot signups*/}\n      <div style={{ position: \"absolute\", left: \"-5000px\" }} aria-hidden=\"true\">\n        <input\n          type=\"text\"\n          name=\"b_9a67f4eac197159cd85f8f6b6_379472243f\"\n          tabIndex=\"-1\"\n        />\n      </div>\n\n      <button onClick={handleSubmit}>Register for Early Access</button>\n      {error && (\n        <div className=\"form-error\">Please enter a valid email address</div>\n      )}\n    </StyledInputForm>\n    <p>\n      Learn more at <a href=\"https://near.org/blog\">NEAR.org/blog</a>\n    </p>\n  </StyledMainContent>\n);\n", "metadata": null, "widget_modules_used": null, "widget_url": "https://near.social/#/golas.near/widget/LoyaltyProgram", "branch.draft.": NaN, "branch": NaN}