{"tx_hash": "4mnq7Zr1BD3mJUUHKmaBTLKdevVCcf1sDa8qd4A2fZ9V", "action_id_social": "MfsuDgWChgNz1BYMB19vQLurS1efuuaQ2SsNb4PipzX-0-widget", "block_id": 92993238, "block_timestamp": "2023-05-29T16:27:35.534Z", "signer_id": "sayalot.near", "widget_name": "SayALot_Comment.Compose", "source_code": "const addressForComments = \"sayalot-comments\";\r\nconst addressForArticles = \"sayALotArticle\";\r\nconst authorForWidget = \"sayalot.near\";\r\nif (!context.accountId) {\r\n  return \"\";\r\n}\r\n\r\nconst item = props.item;\r\n\r\nif (!context.accountId) {\r\n  return \"\";\r\n}\r\n\r\nconst composeCommentData = () => {\r\n  const data = {\r\n    [addressForArticles]: {\r\n      [addressForComments]: JSON.stringify(\r\n        Object.assign({ item }, state.content)\r\n      ),\r\n    },\r\n    index: {\r\n      [addressForComments]: JSON.stringify({\r\n        key: item,\r\n        value: {\r\n          type: \"md\",\r\n        },\r\n      }),\r\n    },\r\n  };\r\n\r\n  return data;\r\n};\r\n\r\nState.init({\r\n  onChange: ({ content }) => {\r\n    State.update({ content });\r\n  },\r\n});\r\n\r\nreturn (\r\n  <>\r\n    <Widget\r\n      src=\"mob.near/widget/Common.Compose\"\r\n      props={{\r\n        placeholder: \"Reply\",\r\n        initialText: props.initialText,\r\n        onChange: state.onChange,\r\n        onHelper: ({ extractTagNotifications }) => {\r\n          State.update({ extractTagNotifications });\r\n        },\r\n        composeButton: (onCompose) => (\r\n          <CommitButton\r\n            disabled={!state.content}\r\n            force\r\n            className=\"btn btn-dark rounded-3\"\r\n            data={composeCommentData}\r\n            onCommit={() => {\r\n              onCompose();\r\n              props.onComment && props.onComment(state.content);\r\n            }}\r\n          >\r\n            Comment\r\n          </CommitButton>\r\n        ),\r\n      }}\r\n    />\r\n    {state.content && (\r\n      <div className=\"mt-3\">\r\n        <Widget\r\n          src={`${authorForWidget}/widget/SayALot_Comment`}\r\n          props={{\r\n            item,\r\n            accountId: context.accountId,\r\n            content: state.content,\r\n            blockHeight: \"now\",\r\n          }}\r\n        />\r\n      </div>\r\n    )}\r\n  </>\r\n);\r\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/sayalot.near/widget/SayALot_Comment.Compose", "__row_index": 0}