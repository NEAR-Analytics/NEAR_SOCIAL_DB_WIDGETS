{"tx_hash": "8ySPutK14PZuzapSJCdSckYS7xgUbkBTcpdJsxcCnbUN", "action_id_social": "ARj1XyFAuG9UqdZcGH44ZFzhEXQAvwTQ3zBGX8fLK1Em-0-widget", "block_id": 85019746, "block_timestamp": "2023-02-11 22:29:08.886", "signer_id": "rayfoster.near", "widget_name": "NFTAudio", "source_code": "const profile = Social.getr(`${context.accountId}/profile`);\r\nlet tokenId = props.tokenId;\r\nlet contractId = props.contractId;\r\nconsole.log(tokenId, contractId);\r\nconst nftMetadata = Near.view(contractId, \"nft_metadata\");\r\nconst tokenMetadata = Near.view(contractId, \"nft_token\", {\r\n  token_id: tokenId,\r\n}).metadata;\r\nlet extra = JSON.parse(tokenMetadata.extra);\r\n\r\nconsole.log(nftMetadata);\r\nconsole.log(tokenMetadata);\r\nconsole.log(extra);\r\n\r\nlet dao = `https://daorecords.io:8443/fetch?cid=${extra.music_cid}`;\r\nlet newAudio = new Audio(dao);\r\nlet artUrl = `https://daorecords.io:8443/get/thumbnail?root_id=${props.rootId}&contract=${contractId}`;\r\nlet artRes = fetch(artUrl).body.thumbnail;\r\nlet artData = `data:image/webp;base64,${artRes}`;\r\nlet paused = true;\r\n\r\nfunction updateTime() {\r\n  if (paused) {\r\n  } else {\r\n    console.log(newAudio.currentTime);\r\n    setTimeout(updateTime, 1000);\r\n  }\r\n}\r\n\r\nfunction playAudio() {\r\n  newAudio.play();\r\n  paused = false;\r\n}\r\n\r\nfunction stopAudio() {\r\n  newAudio.pause();\r\n  paused = true;\r\n}\r\n\r\nfunction stop() {\r\n  newAudio.load();\r\n  paused = true;\r\n}\r\n\r\nconst playerArea = styled.div`\r\n  width:500px;\r\n  height:500px;\r\n  background-color:rgba(240,240,240,0.5);\r\n  border-radius:30px;\r\n  padding:30px;\r\n  backdrop-filter: blur(50px);\r\n`;\r\n\r\nconst artist = styled.h2`\r\n  color:#555;\r\n  text-align:center;\r\n`;\r\nconst song = styled.h3`\r\n  color:#666;\r\n  text-align:center;\r\n`;\r\nconst description = styled.p`\r\n  display:block;\r\n  font-size:11px;\r\n  border-radius:10px;\r\n  padding:10px;\r\n  background-color:rgb(219, 219, 219,0.2);;\r\n`;\r\nconst uiButtons = styled.button`\r\n  background-color:#aaa;\r\n  border-radius:20px;\r\n  width:50px;\r\n  height:50px;\r\n  border-width:0px;\r\n  filter: drop-shadow(0px 1px 2px #555);\r\n  margin-left:10px;\r\n  margin-right:10px;\r\n`;\r\nconst uiButtonArea = styled.div`\r\n  margin:auto;\r\n  text-align:center;\r\n`;\r\nconst bgThumb = styled.img`\r\n    position: absolute;\r\n    top: 50px;\r\n    width: 400px;\r\n    left: 59px;\r\n    z-index: -1;\r\n`;\r\nconst fgThumb = styled.img`\r\n  width: 200px;\r\n    margin-left: 120px;\r\n    margin-top: 10px;\r\n    filter: drop-shadow(2px 4px 6px black);\r\n`;\r\n\r\nreturn (\r\n  <div>\r\n    <bgThumb src={artData} />\r\n\r\n    <playerArea>\r\n      <artist>{nftMetadata.symbol}</artist>\r\n\r\n      <song>{tokenMetadata.title}</song>\r\n      <description> {tokenMetadata.description}</description>\r\n\r\n      <uiButtonArea>\r\n        <uiButtons onClick={playAudio}>\r\n          <svg\r\n            width=\"24\"\r\n            height=\"24\"\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            fill-rule=\"evenodd\"\r\n            clip-rule=\"evenodd\"\r\n          >\r\n            <path d=\"M23 12l-22 12v-24l22 12zm-21 10.315l18.912-10.315-18.912-10.315v20.63z\" />\r\n          </svg>\r\n        </uiButtons>\r\n        <uiButtons onClick={stopAudio}>\r\n          <svg\r\n            width=\"24\"\r\n            height=\"24\"\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            fill-rule=\"evenodd\"\r\n            clip-rule=\"evenodd\"\r\n          >\r\n            <path d=\"M10 24h-6v-24h6v24zm10 0h-6v-24h6v24zm-11-23h-4v22h4v-22zm10 0h-4v22h4v-22z\" />\r\n          </svg>\r\n        </uiButtons>\r\n        <uiButtons onClick={stop}>\r\n          <svg\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            width=\"24\"\r\n            height=\"24\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path d=\"M2 2h20v20h-20z\" />\r\n          </svg>\r\n        </uiButtons>\r\n      </uiButtonArea>\r\n      <fgThumb src={artData} />\r\n    </playerArea>\r\n  </div>\r\n);\r\n", "metadata": NaN, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/rayfoster.near/widget/NFTAudio", "metadata.name": "NFT Audio Player"}