{"tx_hash": "HLg3woqZPVCcutatT9hKebwkzMKeAzdiLHkZzE84pKv2", "action_id_social": "GoffAmuL2b2msWxykbArsym6aZfLaAXFYvvH3GZ9bsBC-0-widget", "block_id": 94806011, "block_timestamp": "2023-06-23T00:46:49.611Z", "signer_id": "yairnava.near", "widget_name": "BurritoBattle-Pet-Mint", "source_code": null, "metadata": null, "branch": {"draft": {"": "const virtualPetContract = \"0x863372715e91c46Dd5a2C0d19aCcEFE9910bE6D1\";\n\nconst virtualPetAbi = fetch(\n  \"https://indigo-fluttering-emu-841.mypinata.cloud/ipfs/QmcNGm5jYV5fp4KqUZ3ew7F5kkPP7tnr6xP8vx5hPmEjhA\"\n);\n\nif (!virtualPetAbi.ok) {\n  return \"Loading\";\n}\n\nconst iface = new ethers.utils.Interface(virtualPetAbi.body);\n\nState.init({\n  init: true,\n  mintedBurritos: 0,\n  burritoName: \"\",\n});\n\nif (state.sender === undefined) {\n  const accounts = Ethers.send(\"eth_requestAccounts\", []);\n  if (accounts.length) {\n    State.update({ sender: accounts[0] });\n  }\n}\n\nif (state.sender && state.init) {\n  const contract = new ethers.Contract(\n    virtualPetContract,\n    virtualPetAbi.body,\n    Ethers.provider().getSigner()\n  );\n\n  // Consultar mascotas minadas\n  contract.getMintedTokens().then((res) => {\n    State.update({\n      mintedBurritos: res.toNumber(),\n    });\n  });\n}\n\n// Mint\nconst mint = () => {\n  const contract = new ethers.Contract(\n    virtualPetContract,\n    virtualPetAbi.body,\n    Ethers.provider().getSigner()\n  );\n\n  contract.mintPet(state.burritoName).then((res) => {\n    State.update({\n      init: false,\n      burritoName: \"\",\n    });\n    const lastId = (state.mintedBurritos += 1);\n    console.log(lastId);\n    State.update({\n      mintedBurritos: lastId,\n    });\n    setTimeout(() => {\n      contract.getMintedTokens().then((res) => {\n        State.update({\n          mintedBurritos: res.toNumber(),\n        });\n      });\n    }, \"10000\");\n  });\n};\n\nconst ItemBackground = styled.div`\n        width: 100%;\n        //height: 100vh;\n        display: flex;\n        justify-content: center;\n        //background-image: url('https://pin.ski/3XjZcs8');\n        background-repeat: no-repeat;\n        background-size: cover;\n        margin-bottom: -50px;\n        `;\n\nconst ItemContainer = styled.div`\n        margin-top: 30px;\n        box-sizing: border-box;\n        min-width: 320px;\n        max-width: 560px;\n        width: 100%;\n        padding: 0px 32px;\n        position: relative;\n        `;\n\nconst ItemTitle = styled.h3`\n        text-align: center;\n        color: white;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        margin-bottom: 1rem;\n        `;\n\nconst ItemImage = styled.img`\n            width: 40px;\n            margin-right: 15px;\n        `;\n\nconst ItemSubTitle = styled.div`\n        text-shadow: 1px 1px 2px black, 0 0 1em blue, 0 0 0.2em blue;\n        text-align: center;\n        color: yellow;\n        margin-bottom: 5px;\n        `;\n\nconst ItemHeader = styled.div`\n        background: #64473f;\n        font-weight: 400;\n        font-size: 12px;\n        line-height: 1.6em;\n        border-radius: 20px;\n        margin: 0px;\n        padding: 20px;\n        box-shadow: none;\n        color: rgb(255, 255, 255);\n        `;\n\nconst ItemBody = styled.div`\n        font-weight: 400;\n        font-size: 1em;\n        line-height: 1.6em;\n        border-radius: 0px 0px 20px 20px;\n        margin: -20px 0px 0px;\n        padding: 32px;\n        box-shadow: none;\n        background: #feb75b;\n        color: black;\n        `;\n\nconst ItemMintNumber = styled.label`\n        font-size: 20px;\n        font-weight: 800;\n        color: black;\n        `;\n\nconst ItemMintButton = styled.button`\n        background: #f54866;\n        color: white;\n        font-weight: 700;\n        padding: 15px 20px;\n        border-radius: 1rem;\n        border: none;\n        &:hover {\n            background: rgb(146 0 0);\n        }\n        `;\n\n// FETCH CSS\nconst cssFont = fetch(\n  \"https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800\"\n).body;\nconst css = fetch(\n  \"https://pluminite.mypinata.cloud/ipfs/Qmboz8aoSvVXLeP5pZbRtNKtDD3kX5D9DEnfMn2ZGSJWtP\"\n).body;\n\nif (!cssFont || !css) return \"\";\n\nif (!state.theme) {\n  State.update({\n    theme: styled.div`\n    font-family: Manrope, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;\n    ${cssFont}\n    ${css}\n`,\n  });\n}\nconst Theme = state.theme;\n\n// Render\nreturn (\n  <Theme>\n    <ItemBackground>\n      <ItemContainer>\n        <ItemHeader>\n          <ItemTitle>\n            <ItemImage src=\"https://pin.ski/3phJiSm\"></ItemImage>\n            <label\n              style={{\n                \"text-shadow\":\n                  \"1px 0px 0px black, 0px 1px 0px black, -1px 0px 0px black, 0px -1px 0px black\",\n              }}\n            >\n              Burrito Pets\n            </label>\n          </ItemTitle>\n        </ItemHeader>\n        <ItemBody>\n          <div class=\"container text-center\">\n            <div>\n              <ItemMintNumber>\n                Last Burrito Id: {state.mintedBurritos}\n              </ItemMintNumber>\n            </div>\n            <br />\n            <div>\n              <input\n                placeholder=\"Burrito name\"\n                value={state.burritoName}\n                onChange={(e) => State.update({ burritoName: e.target.value })}\n              />\n            </div>\n\n            <br />\n            {context.accountId ? (\n              <div>\n                <ItemMintButton\n                  onClick={async () => {\n                    mint();\n                  }}\n                >\n                  Mint Burrito\n                </ItemMintButton>\n                <br /> <br /> <br />\n                <div>\n                  <a\n                    href=\"#/yairnava.near/widget/BurritoBattle-Pet-Interact\"\n                    style={{ color: \"black\" }}\n                  >\n                    Go to Play\n                  </a>\n                </div>\n              </div>\n            ) : (\n              <Web3Connect\n                className=\"LidoStakeFormSubmitContainer\"\n                connectLabel=\"Connect with Web3 to View your Virtual Pets\"\n              />\n            )}\n            <br />\n          </div>\n        </ItemBody>\n      </ItemContainer>\n    </ItemBackground>\n  </Theme>\n);\n"}}, "widget_modules_used": null, "widget_url": "https://near.social/#/yairnava.near/widget/BurritoBattle-Pet-Mint", "__row_index": 1}