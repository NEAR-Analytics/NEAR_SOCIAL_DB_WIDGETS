{"tx_hash": "A8LiYr5TEbZY8vL8bJdFXRMLr4RuaUfPZnWQMBf5wjpC", "action_id_social": "6RzGvS4LnKBvaLX8LD3SnAKimxU9j6WETJQdvRzqMusa-0-widget", "block_id": 85376507, "block_timestamp": "2023-02-16 20:35:51.873", "signer_id": "roshaan.near", "widget_name": "queryapi__IndexerFunctionEditor", "source_code": "let initialText = \"\";\nconst indexer_function_name = props.indexer_name;\nconst registry_contract_id =\n  props.registry_contract_id || \"registry.queryapi.near\";\nlet accountId = props.accountId || context.accountId;\nState.init({\n  m: initialText,\n});\n\nif (!accountId) {\n  return \"Please sign in to use this widget.\";\n}\n\nlet queryIndexerCode = () => {\n  return Near.asyncView(registry_contract_id, \"read_indexer_function\", {\n    name: indexer_function_name,\n  });\n};\nqueryIndexerCode().then((data) => {\n  if (!data) return;\n  console.log(data, \"data\");\n  State.update({ m: data });\n});\n\nconst code = `\n<iframe id=\"react-app-iframe\" onload=\"test()\" src=\"http://localhost:3001/query-api-editor\" width=\"1250px\" height=\"500px\"></iframe>\n<script>\nfunction test() {\nlet receiverWindow = document.getElementById(\"react-app-iframe\").contentWindow\nwindow.addEventListener(\"message\", function(event){\n     window.top.postMessage(event.data, \"*\");\n});\n}\n</script>\n`;\n\nreturn (\n  <div>\n    <iframe\n      className=\"w-100\"\n      style={{ height: \"500px\" }}\n      srcDoc={code}\n      message={stae.m}\n      onMessage={(m) => State.update({ m })}\n    />\n    <Widget\n      src={\"roshaan.near/widget/queryapi__RegisterIndexerFunctionButton\"}\n      props={{\n        indexer_name: indexer_function_name,\n        indexer_code: state.m,\n      }}\n    />\n  </div>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/roshaan.near/widget/queryapi__IndexerFunctionEditor"}