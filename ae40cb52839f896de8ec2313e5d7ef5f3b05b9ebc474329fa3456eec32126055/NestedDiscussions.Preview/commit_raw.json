{"tx_hash": "897wXC3LCqbBsyvmpFPy5M4cbDFrqYKWWySCUwPgEbCF", "action_id_social": "6gEhdrZtLuFrZwEkao8fkjWRozupNDuv8MsXsdR5v89s-0-widget", "block_id": 90403687, "block_timestamp": "2023-04-25 14:32:29.386", "signer_id": "ae40cb52839f896de8ec2313e5d7ef5f3b05b9ebc474329fa3456eec32126055", "widget_name": "NestedDiscussions.Preview", "source_code": "const dbAction = props.dbAction;\nconst accountId = props.accountId;\nconst blockHeight = parseInt(props.blockHeight);\n\nconst composeWidget =\n  \"ae40cb52839f896de8ec2313e5d7ef5f3b05b9ebc474329fa3456eec32126055/widget/NestedDiscussions.Compose\";\nconst previewWidget =\n  \"ae40cb52839f896de8ec2313e5d7ef5f3b05b9ebc474329fa3456eec32126055/widget/NestedDiscussions.Preview\";\nconst notificationWidget =\n  props.notificationWidget ||\n  \"ae40cb52839f896de8ec2313e5d7ef5f3b05b9ebc474329fa3456eec32126055/widget/NestedDiscussions\";\n\nvar notificationWidgetParams = props.notificationWidgetParams || {\n  identifier,\n};\nconst highlightComment = props.highlightComment;\n\nreturn JSON.parse(Social.get(`${accountId}/${dbAction}/main`, blockHeight));\nconst { content, commentId } = JSON.parse(\n  Social.get(`${accountId}/${dbAction}/main`, blockHeight)\n);\n\nconst postUrl = `https://near.org/#/${previewWidget}?accountId=${accountId}&blockHeight=${blockHeight}&dbAction=${dbAction}`;\n\nState.init({ hasBeenFlagged: false });\n\n// all children comments will be identified by this object\nconst item = {\n  accountId,\n  blockHeight,\n  dbAction,\n};\n\nconst Post = styled.div`\n  position: relative;\n  ${commentId == highlightComment ? \"border: 1px solid yellow\" : \"\"}\n\n  &::before {\n    content: \"\";\n    display: block;\n    position: absolute;\n    left: 19px;\n    top: 52px;\n    bottom: 12px;\n    width: 2px;\n    background: #eceef0;\n  }\n`;\n\nconst Header = styled.div`\n  margin-bottom: 0;\n  display: inline-flex;\n`;\n\nconst Body = styled.div`\n  padding-left: 52px;\n  padding-bottom: 1px;\n`;\n\nconst Content = styled.div`\n  img {\n    display: block;\n    max-width: 100%;\n    max-height: 80vh;\n    margin: 0 0 12px;\n  }\n`;\n\nconst Text = styled.p`\n  display: block;\n  margin: 0;\n  font-size: 14px;\n  line-height: 20px;\n  font-weight: 400;\n  color: #687076;\n  white-space: nowrap;\n`;\n\nconst Actions = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  margin: -6px -6px 6px;\n`;\n\nconst Comments = styled.div`\n  > div > div:first-child {\n    padding-top: 12px;\n  }\n`;\n\nif (state.hasBeenFlagged) {\n  return (\n    <div className=\"alert alert-secondary\">\n      <i className=\"bi bi-flag\" /> This content has been flagged for moderation\n    </div>\n  );\n}\n\nreturn (\n  <>\n    {commentId} , {highlightComment}\n    <Post>\n      <Header>\n        <Widget\n          src=\"calebjacob.near/widget/AccountProfile\"\n          props={{\n            accountId,\n            hideAccountId: true,\n            inlineContent: (\n              <>\n                <Text as=\"span\">\uff65</Text>\n                <Text>\n                  <Widget\n                    src=\"mob.near/widget/TimeAgo\"\n                    props={{ blockHeight }}\n                  />{\" \"}\n                  ago\n                </Text>\n              </>\n            ),\n          }}\n        />\n      </Header>\n      <Body>\n        <Content>\n          {content.text && (\n            <Widget\n              src=\"calebjacob.near/widget/SocialMarkdown\"\n              props={{ text: content.text }}\n            />\n          )}\n\n          {content.image && (\n            <Widget\n              src=\"mob.near/widget/Image\"\n              props={{\n                image: content.image,\n              }}\n            />\n          )}\n        </Content>\n\n        {blockHeight !== \"now\" && (\n          <Actions>\n            <Widget\n              src=\"near/widget/NestedDiscussions.Preview.LikeButton\"\n              props={{\n                item,\n                previewWidget,\n                notifyAccountId: accountId,\n              }}\n            />\n            <Widget\n              src=\"near/widget/NestedDiscussions.Preview.CommentButton\"\n              props={{\n                dbAction,\n                item,\n                onClick: () => State.update({ showReply: !state.showReply }),\n              }}\n            />\n            <Widget\n              src=\"calebjacob.near/widget/CopyUrlButton\"\n              props={{\n                url: postUrl,\n              }}\n            />\n            <Widget\n              src=\"near/widget/FlagButton\"\n              props={{\n                item: {\n                  type: \"social\",\n                  path: `${accountId}/discuss`,\n                  blockHeight,\n                },\n                onFlag: () => {\n                  State.update({ hasBeenFlagged: true });\n                },\n              }}\n            />\n          </Actions>\n        )}\n\n        {state.showReply && (\n          <div className=\"mb-2\">\n            <Widget\n              src={composeWidget}\n              props={{\n                dbAction,\n                notifyAccountId: accountId,\n                previewWidget,\n                identifier: item,\n                notificationWidget,\n                notificationWidgetParams,\n                onComment: () => State.update({ showReply: false }),\n              }}\n            />\n          </div>\n        )}\n\n        <Comments>\n          <Widget\n            src=\"ae40cb52839f896de8ec2313e5d7ef5f3b05b9ebc474329fa3456eec32126055/widget/NestedDiscussions.Feed\"\n            props={{\n              dbAction,\n              identifier: item,\n              composeWidget,\n              previewWidget,\n              moderatorAccount,\n            }}\n          />\n        </Comments>\n      </Body>\n    </Post>\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/ae40cb52839f896de8ec2313e5d7ef5f3b05b9ebc474329fa3456eec32126055/widget/NestedDiscussions.Preview"}