{"tx_hash": "CMd2j8ji2dVMEHYrhcBib3AS1SgHc9fRNAnKs7keobCp", "action_id_social": "HG9KEKQPYhzixZ2eUeUoeFvxBSHmvR5RsbfW8yFqtciK-0-widget", "block_id": 92221620, "block_timestamp": "2023-05-19T12:50:39.100Z", "signer_id": "udovychenko.near", "widget_name": "LendList", "source_code": "const ownerId = \"udovychenko.near\";\nconst PEMB_ROCK_CONTRACT_ID = \"v1.pembrock.near\";\nconst accountId = props.accountId;\n\nState.init({\n  balance: null,\n  tokens: null,\n  token_price: null,\n  token_metadata: [],\n});\n\nconst getBalance = (tokenId) => {\n  return Near.view(\n    tokenId,\n    \"ft_balance_of\",\n    { account_id: accountId },\n    \"final\",\n    false\n  );\n};\n\nconst getTokenPriceList = () => {\n  return fetch(\"https://indexer.ref.finance/list-token-price\", {\n    method: \"GET\",\n    headers: { \"Content-type\": \"application/json; charset=UTF-8\" },\n  });\n};\n\nconst getTokens = () => {\n  return Near.asyncView(\n    PEMB_ROCK_CONTRACT_ID,\n    \"get_tokens\",\n    { from_index: 0, limit: 100 },\n    \"final\",\n    false\n  );\n};\n\nconst getTokenMetadata = (tokenId) => {\n  return Near.view(tokenId, \"ft_metadata\", {}, \"final\", false);\n};\n\ngetTokens().then((tokenList) => {\n  const tokenMetadata = Object.keys(tokenList).map((tokenId) =>\n    getTokenMetadata(tokenId)\n  );\n\n  const walletBalance = Object.keys(tokenList).map((tokenId) => {\n    return getBalance(tokenId);\n  });\n\n  const tokenPriceList = getTokenPriceList();\n\n  State.update({\n    balance: walletBalance,\n    tokens: tokenList,\n    token_price: JSON.parse(tokenPriceList.body),\n    token_metadata: tokenMetadata,\n  });\n});\n\nconst Container = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  column-gap: 12px;\n  margin-bottom: 10px;\n  padding: 18px 24px;\n  border-radius: 24px;\n  font-weight: 600;\n  background-color: #161617;\n  box-shadow: inset 0 2px 2px #1b1e25;\n  color: #eaecef;\n`;\n\nconst ContainerLeftBlock = styled.div`\n  display: flex;\n  align-items: center;\n  column-gap: 12px;\n`;\n\nconst NameCoint = styled.p`\n  font-style: normal;\n  font-weight: 600;\n  font-size: 14px;\n  line-height: 1.125em;\n`;\n\nconst Button = styled.div`\n  padding: 6px 14px;\n  font-weight: 600;\n  font-size: 14px;\n  color: #eaecef;\n  border: 1px solid #fa6600;\n  border-radius: 12px;\n  background-color: #fa6600;\n  cursor: pointer;\n`;\n\nreturn (\n  <>\n    {state.token_metadata !== [] ? (\n      state.token_metadata.map((token) => {\n        return (\n          <Container>\n            <ContainerLeftBlock>\n              <Widget\n                src={`${ownerId}/widget/Icon`}\n                props={{ size: \"32px\", image: token.icon }}\n              />\n              <NameCoint>{token.symbol}</NameCoint>\n            </ContainerLeftBlock>\n\n            <Button onClick={() => {}}>Deposit</Button>\n          </Container>\n        );\n      })\n    ) : (\n      <div>Loading</div>\n    )}\n  </>\n);\n", "metadata": null, "branch": null, "widget_modules_used": null, "widget_url": "https://near.social/#/udovychenko.near/widget/LendList", "__row_index": 0}